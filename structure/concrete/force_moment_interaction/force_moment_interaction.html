
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>P-M Interaction Diagram &#8212; Hossein Karagah, PhD, PE</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J3171580FP"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J3171580FP');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J3171580FP');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'structure/concrete/force_moment_interaction/force_moment_interaction';</script>
    <link rel="icon" href="../../../_static/headshot.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Rectangular Concrete Shear Wall Neutral Axis" href="../../shear_wall_neutral_axis/rect_shear_wall_neutral_axis.html" />
    <link rel="prev" title="Moment-Curvature: Steel W-Section" href="../../moment_curvature/steel_w_sec_moment_curvature.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">Hossein Karagah, PhD, PE</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/headshot.png" class="logo__image only-light" alt="Hossein Karagah, PhD, PE - Home"/>
    <script>document.write(`<img src="../../../_static/headshot.png" class="logo__image only-dark" alt="Hossein Karagah, PhD, PE - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Structural Engineering</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../p_delta/cant_col_p_delta.html">P-Delta Analysis: Cantilever Column</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moment_curvature/steel_w_sec_moment_curvature.html">Moment-Curvature: Steel W-Section</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">P-M Interaction Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shear_wall_neutral_axis/rect_shear_wall_neutral_axis.html">Rectangular Concrete Shear Wall Neutral Axis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../opensees/opensees_steel_materials.html">OpenSees Uniaxial Steel Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structural_dynamics/modal_analysis_basic.html">Modal Analysis: 3-DOF System</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Earthquake Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../earthquake/asce7_2800_spectrum/asce7_2800_spectrum.html">ASCE 7 vs. 2800 Standard: Comparing Design Spectral Response Acceleration Parameter (Sa)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../earthquake/frequency_content/frequency_content.html">Frequency content of Earthquake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../earthquake/response_spectrum/response_spectrum.html">Earthquake Response Spectrum</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hkaragah/hkaragah.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hkaragah/hkaragah.github.io/issues/new?title=Issue%20on%20page%20%2Fstructure/concrete/force_moment_interaction/force_moment_interaction.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/structure/concrete/force_moment_interaction/force_moment_interaction.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>P-M Interaction Diagram</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-concrete-section">Define Concrete Section</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pure-flexure-point-f">Pure Flexure Point (F):</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-special-points">Compute Special Points</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strength-reduction-factor-phi">Strength Reduction Factor <span class="math notranslate nohighlight">\(\phi\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#etabs-section-designer">ETABS Section Designer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p-m-diagram">P-M Diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comaparison">Comaparison</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div style="text-align: right;">
<a target="_blank" href="https://colab.research.google.com/github/hkaragah/hkaragah.github.io/blob/main/structure/concrete/force_moment_interaction/force_moment_interaction.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>
<div style="font-size: 0.8em; color: #555;">By Hossein Karagah</div>
<div style="font-size: 0.8em; color: #555;">© Copyright 2025 GNU GENERAL PUBLIC LICENSE.</div>
</div><section class="tex2jax_ignore mathjax_ignore" id="p-m-interaction-diagram">
<h1>P-M Interaction Diagram<a class="headerlink" href="#p-m-interaction-diagram" title="Link to this heading">#</a></h1>
<p>The diagram shows how much moment capacity a beam/column can carry while it is under different levels of axial force, and vice versa. The diagram is usually plotted with the axial force on the vertical axis and moment on the horizontal axis. There are some special points on the diagram including:</p>
<hr class="docutils" />
<ul>
<li><p><strong>Point of Pure Compression (<span class="math notranslate nohighlight">\(P_o\)</span>):</strong></p>
  <div style="text-align: center"><img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_04.jpg" width=1000 alt="Stress and strain diagrams at pure compression"></div>
<p>This point corresponds to maximum compressive capacity (<span class="math notranslate nohighlight">\(P_o\)</span>) of the section with no moment capacity. The concrete and steel are both in compression. The concrete attains its ultimate compressive strain (<span class="math notranslate nohighlight">\(\epsilon_{c}=\epsilon_{cu}=0.003\)</span> per ACI 318-25 §22.2.2.1). The maximum compressive capacity for non-prestressed members is calculated per ACI 318-25 §22.4.2.2 as:</p>
<div class="math notranslate nohighlight">
\[P_o=0.85f'_c(A_g-\sum_{i=1}^{n} A_{si})+f_y \sum_{i=1}^{n} A_{si}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f'_c\)</span> is the specified compressive strength of concrete in psi.</p></li>
<li><p><span class="math notranslate nohighlight">\(f_y\)</span> is the specified yield strength of non-prestressed reinforcement in psi, limited to 80,000 psi per ACI 318-25 §22.4.2.1.</p></li>
<li><p><span class="math notranslate nohighlight">\(A_g\)</span> is gross concrete area in <span class="math notranslate nohighlight">\(in^2\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sum_{i=1}^{n} A_{si}\)</span> is the total area of non-prestressed longitudinal reinforcement in <span class="math notranslate nohighlight">\(in^2\)</span> assuming there are n-layers of longitudinal reinforcement in the section arranged as shown in the figure above.</p></li>
</ul>
<p>According to ACI 318-25 Table 22.4.2.1, the maximum axial strength of non-prestressed members with ties conforming to §22.4.2.4 is limited to <span class="math notranslate nohighlight">\(0.80P_o\)</span> to consider the adverse effect of accidental eccentricity up to 10% of the section depth.</p>
<div class="math notranslate nohighlight">
\[P_{n,max} = 0.80P_o\]</div>
</li>
</ul>
<hr class="docutils" />
<ul>
<li><p><strong>Balance Point (B):</strong></p>
<p>where the normal strain in extreme concrete fiber is equal to concrete ultimate strain and normal strain in the extreme tensile rebar is equal to the steel yield strain (<span class="math notranslate nohighlight">\(\epsilon_{c,max}=0.003, \epsilon_{st}=\epsilon_y\)</span>). Both materials are fully utilized — this is the balanced failure point.</p>
  <div style="text-align: center"><img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_02.jpg" width=1000 alt="Stress and strain diagrams at balance point"></div>
<p><br></br>
$<span class="math notranslate nohighlight">\(\begin{align*}
  &amp;\epsilon_{c,max} = \epsilon_{cu} = 0.003\ &amp;\text{(compression)}\\
  &amp;\epsilon_{st} = \epsilon_y\ &amp;\text{(tension)}
  \end{align*}\)</span>$</p>
<p>The depth of the neutral axis, <span class="math notranslate nohighlight">\(c\)</span>, is obtained using the strain diagram as</p>
<div class="math notranslate nohighlight">
\[\frac{\epsilon_{s1}}{\epsilon_{cu}} = \frac{\epsilon_y}{0.003} = \frac{y_1 - (h/2 - c)}{c}\]</div>
<p>And the normal strain in the longitudinal rebars are calculated as</p>
<div class="math notranslate nohighlight">
\[
    \epsilon_{si} = \left[ y_i - \left(\tfrac{h}{2} - c\right)\right] \frac{\epsilon_{cu}}{c}
    \]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\epsilon_{si}\)</span> is the normal strain in the reinforcement located at depth <span class="math notranslate nohighlight">\(y_i\)</span> from the section centroid</p></li>
<li><p><span class="math notranslate nohighlight">\(h\)</span> is the depth of the section.</p></li>
</ul>
<p>The value of the <span class="math notranslate nohighlight">\(\epsilon_{si}\)</span> could be positive or negative depending on its depth <span class="math notranslate nohighlight">\(y_i\)</span>. The normal stress and normal force in the rebars are then calculated as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    f_{si} = 
    \left\{
    \begin{array}{ll}
    E_s  \epsilon_{si} &amp; \epsilon_{si} \le \epsilon_y \\
    f_y &amp; \epsilon_{si} &gt; \epsilon_y
    \end{array}
    \right.
    \end{split}\]</div>
<div class="math notranslate nohighlight">
\[
    F_{si} = A_{si} f_{si}
    \]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the steel material model has strain hardening, the stress-strain equation should be modified accordingly.</p>
</div>
<p>Using the concrete model proposed by ACI 318, the concrete ultimate stress is <span class="math notranslate nohighlight">\(0.85f'_c\)</span> which is uniformly distributed over an equivalent compression area as described in ACI 318-25 §22.2.2.4.1. The depth of this area is <span class="math notranslate nohighlight">\(a=\beta_1 c\)</span>, where <span class="math notranslate nohighlight">\(\beta_1\)</span> is given in ACI 318-25 Table 22.2.2.4.3. Thus the concrete compression force is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    F_c = 0.85 f'_c \left( \beta_1 c b - \sum_{\substack{i=1 \\ f_{si}&lt;0}}^{n} A_{si} \right)
    \end{split}\]</div>
<p>Here the net area of the net area of the compression concrete is the area of the compression concrete minus the sum of the areas of the compression steel. Now the force equilibrium is obtained as</p>
<div class="math notranslate nohighlight">
\[P_b = F_c + \sum_{i=1}^{n} F_{si}\]</div>
<p>The moment equilibrium is written by taking the moment of al the force components about the section centroid.</p>
<div class="math notranslate nohighlight">
\[M_b = F_c \left(\tfrac{h}{2} - \tfrac{\beta_1c}{2}\right) + \sum_{i=1}^{n}F_{si}y_i\]</div>
</li>
</ul>
<hr class="docutils" />
<ul>
<li><p><strong>Pure Flexure Point (F):</strong></p>
<p>where there is zero axial load and the section only carries a bending moment (like a beam).</p>
  <div style="text-align: center"><img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_01.jpg" width=1000 alt="Stress and strain diagrams at pure flexure"></div>
<p>To obtain the depth of the neutral axis, the force equilibrium is written as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \sum F = F_c + \sum_{i=1}^{n}F_{si} = 0\\
    \end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(F_c\)</span> and <span class="math notranslate nohighlight">\(F_{si} are forces in compression concrete and steel reinforcements as defined earlier. The equation is then solved for \)</span>c<span class="math notranslate nohighlight">\(, the depth of the neutral axis. Knowing \)</span>c$, the internal momemtn is then obtained by summing the moment of each force component about the section centroid.</p>
<div class="math notranslate nohighlight">
\[
    M_f = F_c \left(\tfrac{h}{2} - \tfrac{\beta_1c}{2}\right) + \sum_{i=1}^{n}F_{si}y_i
    \]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Standard practice is to calculate the moment about the centroid of the gross (uncracked) concrete section. This is because</p>
<ul class="simple">
<li><p>It gives a consistent, objective origin.</p></li>
<li><p>It makes interaction diagrams comparable across sections and load cases.</p></li>
<li><p>It’s aligned with how moment and axial load are applied externally in design.</p></li>
</ul>
<p>If you compute moments about any other point (e.g., tension steel, compression block), the M-values would shift vertically by <span class="math notranslate nohighlight">\(P \cdot e\)</span>, where <span class="math notranslate nohighlight">\(e\)</span> is the eccentricity between your new reference point and the centroid.</p>
<p>Since the sum of the forces are zero for Pure Flexure Point, calculating the moment of the force components about any points other than the centroid will also result in the same value.</p>
</div>
</li>
</ul>
<hr class="docutils" />
<ul>
<li><p><strong>Tension-Controlled Point (TC):</strong></p>
<p>where the normal strain in the extreme concrete fiber is equal to the concrete ultimate strain (<span class="math notranslate nohighlight">\(\epsilon_{c,max}=0.003\)</span>) while the strain in extreme tensile rebar is <span class="math notranslate nohighlight">\(\epsilon_{st}=\epsilon_y+0.003\)</span>. The is the point of transition from tension control to compression control per ACI 318-25 §21.2.2.</p>
  <div style="text-align: center"><img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_03.jpg" width=1000 alt="Stress and strain diagrams at tension-controlled point"></div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    &amp;\epsilon_{c,max} = \epsilon_{cu} = 0.003\ &amp;\text{(compression)}\\
    &amp;\epsilon_{s1} = \epsilon_y + 0.003\ &amp;\text{(tension)}
    \end{align*}\end{split}\]</div>
<p>The depth of the neutral axis, <span class="math notranslate nohighlight">\(c\)</span>, is calculated using the strain diagram as</p>
<div class="math notranslate nohighlight">
\[\frac{\epsilon_{s1}}{\epsilon_{cu}} = \frac{\epsilon_y+0.003}{0.003} = \frac{y_1 - (h/2 - c)}{c}\]</div>
<p>Knowing <span class="math notranslate nohighlight">\(c\)</span>, the internal force and moment are then calculated as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    &amp;F_{tc} = F_c + \sum_{i=1}^{n}F_{si}\\
    &amp;M_{tc} = F_c \left(\tfrac{h}{2} - \tfrac{\beta_1c}{2}\right) + \sum_{i=1}^{n}F_{si}y_i
    \end{align*}\end{split}\]</div>
</li>
</ul>
<hr class="docutils" />
<ul>
<li><p><strong>Point of Decompression (D):</strong></p>
<p>This is a point where strain in the extreme concrete fiber is equal to the concrete ultimate strain (<span class="math notranslate nohighlight">\(\epsilon_{c,max}=0.003\)</span>) while the strain in exreme tensile steel <span class="math notranslate nohighlight">\(\epsilon_{s1}\)</span> is zero (<span class="math notranslate nohighlight">\(\epsilon_{s1}=0.0\)</span>).</p>
  <div style="text-align: center"><img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_06.jpg" width=1000 alt="Stress and strain diagrams at decompression point"></div>
<p>The depth of the neutral axis, <span class="math notranslate nohighlight">\(c\)</span>, is equal to the effective depth of the tensile rebars, <span class="math notranslate nohighlight">\(d\)</span>. The strains in other layers of reinforcement are calculated using the strain diagram shown in the figure above as:</p>
<div class="math notranslate nohighlight">
\[\frac{\epsilon_{si}}{\epsilon_{cu}} = \frac{y_i}{h/2 + y_1}\]</div>
<p>Knowing the strains, the stress and force in the reinforcement and concrete can be computed as explained above. Finally the internal force and moment are obtained using the equilibrium equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    &amp;F_{d} = F_c + \sum_{i=1}^{n}F_{si}\\
    &amp;M_{d} = F_c \left(\tfrac{h}{2} - \tfrac{\beta_1c}{2}\right) + \sum_{i=1}^{n}F_{si}y_i
    \end{align*}\end{split}\]</div>
</li>
</ul>
<hr class="docutils" />
<ul>
<li><p><strong>Point of Pure Tension (Maximum Tension):</strong></p>
<p>where maximum tensile load is applied to the section. At this point the concrete is assumed to have no strength (cracked), and all the longitudinal rebars attained yield strain (<span class="math notranslate nohighlight">\(\epsilon_{si}=\epsilon_y\)</span>).</p>
  <div style="text-align: center"><img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_05.jpg" width=1000 alt="Stress and strain diagrams at pure tension"></div>
<p>Since the tensile force has no eccentricity, the stress in all steel reinforcements is at yield stress, <span class="math notranslate nohighlight">\(f_y\)</span>. The internal tensile force is calculated as</p>
<div class="math notranslate nohighlight">
\[P_{tn,max} = \sum_{i=1}^{n}F_{si} = \sum_{i=1}^{n}A_{si}f_y\]</div>
</li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;../../..&quot;</span><span class="p">))</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.materials</span><span class="w"> </span><span class="kn">import</span> <span class="n">ACIConcrete</span><span class="p">,</span> <span class="n">BilinearSteel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.steel</span><span class="w"> </span><span class="kn">import</span> <span class="n">LongitudinalRebar</span><span class="p">,</span> <span class="n">TransverseRebar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.shapes</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">assets.modules.concrete</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">concrete</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.axes</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">axes</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patches</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">bbox_artist</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;../../..&quot;</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.materials</span><span class="w"> </span><span class="kn">import</span> <span class="n">ACIConcrete</span><span class="p">,</span> <span class="n">BilinearSteel</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.steel</span><span class="w"> </span><span class="kn">import</span> <span class="n">LongitudinalRebar</span><span class="p">,</span> <span class="n">TransverseRebar</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.shapes</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">import</span><span class="w"> </span><span class="nn">assets.modules.concrete</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">concrete</span>

<span class="n">File</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Hossein</span>\<span class="n">portfolio</span>\<span class="n">hkaragah</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span>\<span class="n">assets</span>\<span class="n">modules</span>\<span class="n">steel</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">12</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.axes</span>
<span class="ne">---&gt; </span><span class="mi">12</span> <span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.shapes</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circle</span><span class="p">,</span> <span class="n">Point</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.materials</span><span class="w"> </span><span class="kn">import</span> <span class="n">BilinearSteel</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="n">File</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Hossein</span>\<span class="n">portfolio</span>\<span class="n">hkaragah</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span>\<span class="n">assets</span>\<span class="n">modules</span>\<span class="n">shapes</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">19</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="ne">---&gt; </span><span class="mi">19</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">lru_cache</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pandas&#39;
</pre></div>
</div>
</div>
</div>
<section id="define-concrete-section">
<h2>Define Concrete Section<a class="headerlink" href="#define-concrete-section" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>20”x20” square section.</p></li>
<li><p>2” concrete cover (see ACI 318-25 §20.5.1.3).</p></li>
<li><p>8#10 longitudinal rebars, 3 on each side (diameter: 1.27”, area: 1.27 in²).</p></li>
<li><p>#4 &#64; 6” o.c. ties (diameter: 0.50”, area: 0.20 in²).</p></li>
<li><p>f’c = 3000 psi for concrete material (see ACI 318-25  §19.2.1.1 and Table 19.3.2.1.))</p></li>
<li><p>ASTM A706 with fy=60 ksi and no strain hardening for rebar material (see ACI 318-25 §20.2.1.3 and Table 20.2.2.4(a).)</p></li>
</ul>
<p>With the above arrangement, the clear spacing between the longitudinal bars will be</p>
<div class="math notranslate nohighlight">
\[s=\frac{20&quot;-2\times2&quot;-2\times0.5&quot;-3\times1.27&quot;}{2}\approx5.6&quot;\]</div>
<p>which satifies the minimum requirements set forth by ACI 318-25 §25.2.3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define axil load</span>
<span class="n">Nu</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># lb</span>

<span class="c1"># Define material properties</span>
<span class="n">C3</span> <span class="o">=</span> <span class="n">ACIConcrete</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>
<span class="n">S60</span> <span class="o">=</span> <span class="n">BilinearSteel</span><span class="p">(</span><span class="s2">&quot;A706&quot;</span><span class="p">,</span> <span class="n">fy</span><span class="o">=</span><span class="mi">60000</span><span class="p">)</span>

<span class="c1"># Define reinforcement properties</span>
<span class="n">R10</span> <span class="o">=</span> <span class="n">LongitudinalRebar</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">S60</span><span class="p">,</span> <span class="n">is_skin_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># top and bottom longitudinal</span>
<span class="n">R10S</span> <span class="o">=</span> <span class="n">LongitudinalRebar</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">S60</span><span class="p">,</span> <span class="n">is_skin_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># side longitudinal</span>
<span class="n">T4</span> <span class="o">=</span> <span class="n">TransverseRebar</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">S60</span><span class="p">,</span> <span class="n">nLegsX</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nLegsY</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">is_looped</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># transverse</span>

<span class="c1"># Define concrete cover</span>
<span class="n">COVER</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># inch</span>

<span class="c1"># Define dimensions of a rectangular section</span>
<span class="n">RECT_20X20</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot steel stress-strain curve</span>
<span class="n">eps_steel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">S60</span><span class="o">.</span><span class="n">eps_u</span><span class="o">-</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">sigma_steel</span> <span class="o">=</span> <span class="n">S60</span><span class="o">.</span><span class="n">stress</span><span class="p">(</span><span class="n">eps_steel</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eps_steel</span><span class="p">,</span> <span class="n">sigma_steel</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Strain (in/in)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Stress (psi)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Stress-Strain Curve for Bilinear Steel (A706, fy=60 ksi)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/6be88337cc68e123f2f092f3108537cace2d7f8882856ab904cfe18045ff1877.png" src="../../../_images/6be88337cc68e123f2f092f3108537cace2d7f8882856ab904cfe18045ff1877.png" />
</div>
</div>
<p>After defining the section geometry and rebar section, I will add the reinforcement to the section and print the list of the rebars in the section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define concrete section with reinforcement</span>
<span class="n">c_sec</span> <span class="o">=</span> <span class="n">concrete</span><span class="o">.</span><span class="n">RectangleReinforcedSection</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">RECT_20X20</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">C3</span><span class="p">,</span> <span class="n">cover</span><span class="o">=</span><span class="n">COVER</span><span class="p">)</span>

<span class="c1"># Add transverse reinforcement</span>
<span class="n">c_sec</span><span class="o">.</span><span class="n">add_trans_bar</span><span class="p">(</span><span class="n">T4</span><span class="p">)</span>

<span class="c1"># Add bottom longitudinal reinforcement</span>
<span class="n">bottomBar</span> <span class="o">=</span> <span class="n">R10</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> 
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">COVER</span> <span class="o">+</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">trans_bar_max_dia</span>  <span class="o">+</span> <span class="n">bottomBar</span><span class="o">.</span><span class="n">dia</span><span class="o">/</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">c_sec</span><span class="o">.</span><span class="n">add_long_bar_row</span><span class="p">(</span><span class="n">R10</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Add top longitudinal reinforcement</span>
<span class="n">topBar</span> <span class="o">=</span> <span class="n">R10</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> 
    <span class="n">y</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">COVER</span> <span class="o">-</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">trans_bar_max_dia</span> <span class="o">-</span> <span class="n">topBar</span><span class="o">.</span><span class="n">dia</span><span class="o">/</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">c_sec</span><span class="o">.</span><span class="n">add_long_bar_row</span><span class="p">(</span><span class="n">topBar</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Add middle longitudinal reinforcement</span>
<span class="n">midBar</span> <span class="o">=</span> <span class="n">R10S</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">y</span>
<span class="p">)</span>
<span class="n">c_sec</span><span class="o">.</span><span class="n">add_long_bar_row</span><span class="p">(</span><span class="n">midBar</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">p3</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Print longitudinal bars</span>
<span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">long_bars</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>#10 long. rebar at Point(x=0.0, y=-6.865), fy=60000
#10 long. rebar at Point(x=6.865, y=-6.865), fy=60000
#10 long. rebar at Point(x=-6.865, y=-6.865), fy=60000
#10 long. rebar at Point(x=0.0, y=6.865), fy=60000
#10 long. rebar at Point(x=6.865, y=6.865), fy=60000
#10 long. rebar at Point(x=-6.865, y=6.865), fy=60000
#10 long. rebar at Point(x=6.865, y=0.0), fy=60000, skin bar
#10 long. rebar at Point(x=-6.865, y=0.0), fy=60000, skin bar
</pre></div>
</div>
</div>
</div>
<p>The rebars seem to be in their correct position. The two last rebars are marked as skin bars since they are placed along the sides of the section as opposed to the bottom or top. This distinction is to facilitate computing the effective tensile (<span class="math notranslate nohighlight">\(d\)</span>) or compression depth (<span class="math notranslate nohighlight">\(d'\)</span>) later. Now, I am going to plot the section to double check everything before proceeding with the analysis.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_circle</span><span class="p">(</span><span class="n">circle</span><span class="p">:</span> <span class="n">Circle</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>        
    <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span>
        <span class="p">(</span><span class="n">circle</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> 
        <span class="n">circle</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">False</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;facecolor&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;facecolor&#39;</span><span class="p">),</span> 
        <span class="n">edgecolor</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">),</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">),</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">),</span> 
        <span class="n">zorder</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zorder&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;centeroid_color&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">circle</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;centeroid_color&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_rectangle</span><span class="p">(</span><span class="n">rect</span><span class="p">:</span><span class="n">Rectangle</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">show_centroid</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">corners</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">corners</span>
    <span class="n">corners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corners</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># Add the first corner again to close the polygon</span>
    <span class="n">corners</span> <span class="o">=</span> <span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">]</span> <span class="c1"># Convert to tuples</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">corners</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ticksize&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">show_centroid</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;facecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
    
    
    

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rectangle</span><span class="p">(</span><span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_centroid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_rectangle</span><span class="p">(</span><span class="n">c_sec</span><span class="o">.</span><span class="n">core</span><span class="p">(),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">long_bars</span><span class="p">:</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_circle</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#0B1D51&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/1d0d41d4bd534da49f2b5d406c5f7e405ec2fcb9563c293228cc1c83aea4498c.png" src="../../../_images/1d0d41d4bd534da49f2b5d406c5f7e405ec2fcb9563c293228cc1c83aea4498c.png" />
</div>
</div>
<hr class="docutils" />
<section id="pure-flexure-point-f">
<h3>Pure Flexure Point (F):<a class="headerlink" href="#pure-flexure-point-f" title="Link to this heading">#</a></h3>
<p>It looks like the section and rebars are defined properly. The pink region in the plot highlights the core area of the section confined by the ties, and as shown, all the longitudinal bars are within that region. Now, it is the time to start the analysis. Let’s first analyze the section for the pure bending where the normal force is zero. To do so, I assume the bending occurs about the <em>X-axis</em> with the direction of the bending moment oriented in the <em>negative X-direction</em>. I use <code class="docutils literal notranslate"><span class="pre">concrete.UniaixalBending</span></code> to perform the analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define bending direction</span>
<span class="n">B_DIR</span> <span class="o">=</span> <span class="s1">&#39;-x&#39;</span>

<span class="c1"># Define beam/column uniaxial bending</span>
<span class="n">beam</span> <span class="o">=</span> <span class="n">concrete</span><span class="o">.</span><span class="n">UniaxialBending</span><span class="p">(</span><span class="n">c_sec</span><span class="p">,</span> <span class="n">bending_direction</span><span class="o">=</span><span class="n">B_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The depth of the neutral axis is calculated through an iterative process until force equilibrium is satisfied. The solver configuration is defined as follows:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">secant</span></code> method is used.</p></li>
<li><p>The minimum and maximum values considered for the neutral axis are <span class="math notranslate nohighlight">\(x_0 \cdot h\)</span> and <span class="math notranslate nohighlight">\(x_1 \cdot h\)</span>, where <span class="math notranslate nohighlight">\(h\)</span> is the total depth of the section.</p></li>
<li><p>The iteration is repeated up to <code class="docutils literal notranslate"><span class="pre">max_iterations</span></code> times or until a solution is found within the specified <code class="docutils literal notranslate"><span class="pre">tolerance</span></code>.</p></li>
<li><p>Finally, <code class="docutils literal notranslate"><span class="pre">n_disc</span></code> defines the number of discretizations of the concrete section.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dEFINE solver configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">concrete</span><span class="o">.</span><span class="n">SolverConfig</span><span class="p">(</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;secant&#39;</span><span class="p">,</span>
    <span class="n">x0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">x1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span>
    <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pure_flexure</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">solve_neutral_depth_equilibrium</span><span class="p">(</span><span class="n">external_force</span><span class="o">=</span><span class="n">Nu</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

<span class="n">neutral_depth</span> <span class="o">=</span> <span class="n">pure_flexure</span><span class="p">[</span><span class="s1">&#39;neutral_depth&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">force</span> <span class="o">=</span> <span class="n">pure_flexure</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">moment</span> <span class="o">=</span><span class="n">pure_flexure</span><span class="p">[</span><span class="s1">&#39;moment&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Depth of neutral axis: </span><span class="si">{</span><span class="n">neutral_depth</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Axial force: </span><span class="si">{</span><span class="n">force</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bending moment about X-axis: </span><span class="si">{</span><span class="n">moment</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kip-ft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Depth of neutral axis: 5.615 in
Axial force: -0 kips
Bending moment about X-axis: 363 kip-ft
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Let’s then calculate the effective depth of the tensile and compressive rebars. For a section with single layer of tensile and compressive rebars, they are calculated as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
&amp;d=h-cover-d_{bv}-\tfrac{1}{2}d_{bt}\\
\\
&amp;d'=cover+d_{bv}+\tfrac{1}{2}d_{bc}
\end{align*}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(d_{bv}\)</span>, <span class="math notranslate nohighlight">\(d_{bc}\)</span>, and <span class="math notranslate nohighlight">\(d_{bt}\)</span> are the diameter of the transverse, compressive, and tensile rebars, respectively. If there are multiple layers of rebars at the top or bottom, first we need to compute the centroid of the tensile and compressive rebar group</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\bar{y}_{st} &amp;= \frac{\sum A_{st,i} \cdot y_{st,i}}{\sum A_{st,i}}\\
\\
\bar{y}_{sc} &amp;= \frac{\sum A_{sc,i} \cdot y_{sc,i}}{\sum A_{sc,i}}
\end{align*}\end{split}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\bar{y}_{st}\)</span> and <span class="math notranslate nohighlight">\(\bar{y}_{sc}\)</span> are the depth of the centroid of the tensile and compressive rebar relative to the section centroid</p></li>
<li><p><span class="math notranslate nohighlight">\(y_{st,i}\)</span> and <span class="math notranslate nohighlight">\(y_{sc,i}\)</span> are the depth of the tensile and compressive reinforcement, excluding the side rebars, relaitve to the section centroid</p></li>
<li><p><span class="math notranslate nohighlight">\(A_{st,i}\)</span> and <span class="math notranslate nohighlight">\(A_{sc,i}\)</span> are the area of tensile and compressive reinforcement, excluding the side rebars</p></li>
</ul>
<p>Note that the bars locaed at each side of the section does not contribute to the centroid calculation. Also, the tensile and compressive rebars are determined based on the depth of the neutral axis. The section centroid is the centroid of the gross cross section.</p>
<p>Having centroid of the tensile and compressive reinforcement, the The tensile and compressive effective depth are calculated as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
&amp;d=h-cover-d_{bv}-\left(h/2 + |\bar{y}_{st}|\right)\\
\\
&amp;d'=cover+d_{bv}+\left(h/2-|\bar{y}_{sc}|\right)
\end{align*}\end{split}\]</div>
<p>For the given section, knowing that the neutral axis depth, the tensile and compressive effective depth is obtained as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the effective depth of the compressive and tensile reinforcement</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensile effective depth: </span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">get_tensile_effective_depth</span><span class="p">(</span><span class="n">neutral_depth</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compressive effective depth: </span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">get_compressive_effective_depth</span><span class="p">(</span><span class="n">neutral_depth</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensile effective depth: 16.865 in
Compressive effective depth: 3.135 in
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Knowing the depth of the neutral axis, the strain, stress, force in the rebars can also be calculated as explained in the earlier section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_s</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_long_bar_depth</span><span class="p">()</span>
<span class="n">eps_s</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_rebar_strain</span><span class="p">(</span><span class="n">neutral_depth</span><span class="p">)</span>
<span class="n">sigma_s</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_rebar_stress</span><span class="p">(</span><span class="n">neutral_depth</span><span class="p">)</span>
<span class="n">f_s</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_rebar_force</span><span class="p">(</span><span class="n">neutral_depth</span><span class="p">)</span>

<span class="n">y_c</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_concrete_strip_depth</span><span class="p">(</span><span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">eps_c</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_concrete_strain</span><span class="p">(</span><span class="n">neutral_depth</span><span class="p">,</span> <span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">sigma_c</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_concrete_stress</span><span class="p">(</span><span class="n">neutral_depth</span><span class="p">,</span> <span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">f_c</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_concrete_force</span><span class="p">(</span><span class="n">neutral_depth</span><span class="p">,</span><span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rebar_pure_flexure</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;y_s_inch&#39;</span><span class="p">:</span> <span class="n">y_s</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s1">&#39;ε_s&#39;</span><span class="p">:</span> <span class="n">eps_s</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s1">&#39;σ_s_psi&#39;</span><span class="p">:</span> <span class="n">sigma_s</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s1">&#39;f_s_lb&#39;</span><span class="p">:</span> <span class="n">f_s</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<span class="p">})</span>

<span class="n">rebar_pure_flexure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y_s_inch</th>
      <th>ε_s</th>
      <th>σ_s_psi</th>
      <th>f_s_lb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-6.865</td>
      <td>0.006011</td>
      <td>60000.000000</td>
      <td>76006.121865</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-6.865</td>
      <td>0.006011</td>
      <td>60000.000000</td>
      <td>76006.121865</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-6.865</td>
      <td>0.006011</td>
      <td>60000.000000</td>
      <td>76006.121865</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.865</td>
      <td>-0.001325</td>
      <td>-38421.520784</td>
      <td>-48671.179849</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.865</td>
      <td>-0.001325</td>
      <td>-38421.520784</td>
      <td>-48671.179849</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.865</td>
      <td>-0.001325</td>
      <td>-38421.520784</td>
      <td>-48671.179849</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.000</td>
      <td>0.002343</td>
      <td>60000.000000</td>
      <td>76006.121865</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.000</td>
      <td>0.002343</td>
      <td>60000.000000</td>
      <td>76006.121865</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Inspecting the stess and strain results for the reinforcement shows that at the balance point, both the bottom and middle layers of rebar (<span class="math notranslate nohighlight">\(y=0.0\)</span> and <span class="math notranslate nohighlight">\(y=-6.865\)</span>) attain yield strength, while the top layer at <span class="math notranslate nohighlight">\(y=6.865\)</span> remains linear.</p>
<p>Next, I will compute the total forces in the steel and concrete and examine the force equilibrium.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute total concrete force</span>
<span class="n">f_ct</span> <span class="o">=</span> <span class="n">f_c</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Compute centroid of concrete forces</span>
<span class="n">y_ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_c</span> <span class="o">*</span> <span class="n">f_c</span><span class="p">)</span> <span class="o">/</span> <span class="n">f_ct</span> <span class="k">if</span> <span class="n">f_ct</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

<span class="c1"># Compute total tensile rebar force</span>
<span class="n">mask_st</span> <span class="o">=</span> <span class="n">f_s</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">f_st</span> <span class="o">=</span> <span class="n">f_s</span><span class="p">[</span><span class="n">mask_st</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Compute centroid of tensile rebar forces</span>
<span class="n">y_st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_s</span><span class="p">[</span><span class="n">mask_st</span><span class="p">]</span> <span class="o">*</span> <span class="n">f_s</span><span class="p">[</span><span class="n">mask_st</span><span class="p">])</span> <span class="o">/</span> <span class="n">f_st</span> <span class="k">if</span> <span class="n">f_st</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

<span class="c1"># Compute total compressive rebar force</span>
<span class="n">mask_sc</span> <span class="o">=</span> <span class="n">f_s</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="n">f_sc</span> <span class="o">=</span> <span class="n">f_s</span><span class="p">[</span><span class="n">mask_sc</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Compute centroid of compressive rebar forces</span>
<span class="n">y_sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_s</span><span class="p">[</span><span class="n">mask_sc</span><span class="p">]</span> <span class="o">*</span> <span class="n">f_s</span><span class="p">[</span><span class="n">mask_sc</span><span class="p">])</span> <span class="o">/</span> <span class="n">f_sc</span> <span class="k">if</span> <span class="n">f_sc</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total concrete force: </span><span class="si">{</span><span class="n">f_ct</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kips at </span><span class="si">{</span><span class="n">y_ct</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total compressive rebar force: </span><span class="si">{</span><span class="n">f_sc</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kips at </span><span class="si">{</span><span class="n">y_sc</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total tensile rebar force: </span><span class="si">{</span><span class="n">f_st</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kips at </span><span class="si">{</span><span class="n">y_st</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>

<span class="c1"># The following should be close to zero to satisfy equilibrium</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total normal force (f_ct + f_sc + f_st): </span><span class="si">{</span><span class="p">(</span><span class="n">f_ct</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_sc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_st</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>

<span class="c1"># Calculate location of resultant concrete compressive force from α=½ß1.c</span>
<span class="c1"># This should match y_ct obtained above</span>
<span class="k">if</span> <span class="n">B_DIR</span> <span class="o">==</span> <span class="s1">&#39;-x&#39;</span><span class="p">:</span>
    <span class="n">c_force_depth</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">beta_1</span> <span class="o">*</span> <span class="n">neutral_depth</span><span class="o">/</span><span class="mi">2</span>
<span class="k">elif</span> <span class="n">B_DIR</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
    <span class="n">c_force_depth</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">y_min</span> <span class="o">+</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">beta_1</span> <span class="o">*</span> <span class="n">neutral_depth</span><span class="o">/</span><span class="mi">2</span>
<span class="k">elif</span> <span class="n">B_DIR</span> <span class="o">==</span> <span class="s1">&#39;-y&#39;</span><span class="p">:</span>
    <span class="n">c_force_depth</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">beta_1</span> <span class="o">*</span> <span class="n">neutral_depth</span><span class="o">/</span><span class="mi">2</span>
<span class="k">elif</span> <span class="n">B_DIR</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
    <span class="n">c_force_depth</span> <span class="o">=</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">x_min</span> <span class="o">+</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">beta_1</span> <span class="o">*</span> <span class="n">neutral_depth</span><span class="o">/</span><span class="mi">2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Bending direction must be &#39;-x&#39;, &#39;x&#39;, &#39;-y&#39;, or &#39;y&#39;.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Depth of concrete resultant compressive force: </span><span class="si">{</span><span class="n">c_force_depth</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>

<span class="c1"># Calculate curvature at ultimate stage (ε_cu = 0.003) using the secant method</span>
<span class="n">curvature</span> <span class="o">=</span> <span class="o">-</span><span class="n">c_sec</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">eps_u</span> <span class="o">/</span> <span class="n">neutral_depth</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Curvature: </span><span class="si">{</span><span class="n">curvature</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> in/in&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total concrete force: -234.10 kips at 7.64 in
Total compressive rebar force: -146.01 kips at 6.87 in
Total tensile rebar force: 380.03 kips at -4.12 in

Total normal force (f_ct + f_sc + f_st): -0.09 kips

Depth of concrete resultant compressive force: 7.61 in

Curvature: 5.34e-04 in/in
</pre></div>
</div>
</div>
</div>
<p>The internal forces are in equilibrium, as expected. To facilitate checking the state of strain, stress, and forces in the section, I will plot them side by side for visual comparison.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_section_strain</span><span class="p">(</span><span class="n">direction</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">eps</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">ax</span><span class="p">:</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#1B56FD&#39;</span><span class="p">,</span> <span class="s1">&#39;#EB5B00&#39;</span><span class="p">])</span>
    <span class="n">lw</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
    
    <span class="n">max_strain</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">eps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">min_strain</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">eps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">abs_max_strain</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">min_strain</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">max_strain</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">]:</span>
        <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">eps</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="o">*</span><span class="n">abs_max_strain</span><span class="p">,</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">abs_max_strain</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Strain (in/in)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;-x&#39;</span><span class="p">]:</span>
        <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">eps</span><span class="p">,</span> <span class="n">y</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="o">*</span><span class="n">abs_max_strain</span><span class="p">,</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">abs_max_strain</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain (in/in)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;bending_direction must be &#39;x&#39;, &#39;-x&#39;, &#39;y&#39;, or &#39;-y&#39;.&quot;</span><span class="p">)</span>
        
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Concrete&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ec&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rebar&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Strain Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax</span>
    
    
<span class="k">def</span><span class="w"> </span><span class="nf">plot_section_stress</span><span class="p">(</span><span class="n">direction</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">sigma</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">ax</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#1B56FD&#39;</span><span class="p">,</span> <span class="s1">&#39;#EB5B00&#39;</span><span class="p">])</span>
    <span class="n">lw</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lw&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigma</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of ax must match length of sigma.&quot;</span><span class="p">)</span>
    
    <span class="c1"># Convert stress from psi to ksi for plotting</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">/</span><span class="mf">1e3</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sigma</span><span class="p">]</span>  <span class="c1"># Convert psi to ksi</span>
    
    <span class="k">if</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">]:</span>
        <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">sigma</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;-x&#39;</span><span class="p">]:</span>
        <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">y</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;bending_direction must be &#39;x&#39;, &#39;-x&#39;, &#39;y&#39;, or &#39;-y&#39;.&quot;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Concrete&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Concrete Stress&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_val</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ec&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rebar&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Rebar Stress&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
        <span class="n">min_stress</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">max_stress</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">abs_max_stress</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">min_stress</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">max_stress</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">]:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="o">*</span><span class="n">abs_max_stress</span><span class="p">,</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">abs_max_stress</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress (ksi)&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;-x&#39;</span><span class="p">]:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="o">*</span><span class="n">abs_max_stress</span><span class="p">,</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">abs_max_stress</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Stress (ksi)&#39;</span><span class="p">)</span>
            
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax</span>
    
    
<span class="k">def</span><span class="w"> </span><span class="nf">plot_section_force</span><span class="p">(</span><span class="n">direction</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">f</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">ax</span><span class="p">:</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#1B56FD&#39;</span><span class="p">,</span> <span class="s1">&#39;#EB5B00&#39;</span><span class="p">,</span><span class="s1">&#39;#EB5B00&#39;</span><span class="p">])</span>

    <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="n">force</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="k">for</span> <span class="n">force</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>  <span class="c1"># Convert force from lb to kips</span>
    <span class="n">f_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">f</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
    
    <span class="n">arrowprops</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;head_width&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;length_includes_head&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">fi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;-y&#39;</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">yi</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">yi</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">yi</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">yi</span>
                
            <span class="k">if</span> <span class="n">yi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">fi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">f_max</span><span class="p">,</span> <span class="o">**</span><span class="n">arrowprops</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">yi</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">fi</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fi</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
                
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="o">*</span><span class="n">f_max</span><span class="p">,</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">f_max</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normal Force (kips)&#39;</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;-x&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">fi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;-x&#39;</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">yi</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">yi</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">yi</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">yi</span>
                
            <span class="k">if</span> <span class="n">yi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">fi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">f_max</span><span class="p">,</span> <span class="o">**</span><span class="n">arrowprops</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">fi</span><span class="p">,</span> <span class="n">yi</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fi</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
                
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="o">*</span><span class="n">f_max</span><span class="p">,</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">f_max</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normal Force (kips)&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Normal Force Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ax.legend(fontsize=8, frameon=False)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_rectangle</span><span class="p">(</span><span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bar_facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">show_centroid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">c_sec</span><span class="o">.</span><span class="n">long_bars</span><span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_circle</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#0B1D51&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_section_strain</span><span class="p">(</span><span class="n">B_DIR</span><span class="p">,</span> <span class="p">[</span><span class="n">y_c</span><span class="p">,</span> <span class="n">y_s</span><span class="p">],</span> <span class="p">[</span><span class="n">eps_c</span><span class="p">,</span> <span class="n">eps_s</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_section_stress</span><span class="p">(</span><span class="n">B_DIR</span><span class="p">,</span> <span class="p">[</span><span class="n">y_c</span><span class="p">,</span> <span class="n">y_s</span><span class="p">],</span> <span class="p">[</span><span class="n">sigma_c</span><span class="p">,</span> <span class="n">sigma_s</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_section_force</span><span class="p">(</span><span class="n">B_DIR</span><span class="p">,</span> <span class="p">[</span><span class="n">y_ct</span><span class="p">,</span> <span class="n">y_sc</span><span class="p">,</span> <span class="n">y_st</span><span class="p">],</span> <span class="p">[</span><span class="n">f_ct</span><span class="p">,</span> <span class="n">f_sc</span><span class="p">,</span> <span class="n">f_st</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>


<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">B_DIR</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">]:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">x_min</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">x_max</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">B_DIR</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;-x&#39;</span><span class="p">]:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">y_min</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">c_sec</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">y_max</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/dfb0f8d772fdeefb658e1f497fd7106d642d4f3786c76d7e567dc367e41d9228.png" src="../../../_images/dfb0f8d772fdeefb658e1f497fd7106d642d4f3786c76d7e567dc367e41d9228.png" />
</div>
</div>
</section>
</section>
<section id="compute-special-points">
<h2>Compute Special Points<a class="headerlink" href="#compute-special-points" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate special points in the interaction diagram</span>
<span class="n">special_points</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pure Compression&#39;</span><span class="p">:</span> <span class="n">concrete</span><span class="o">.</span><span class="n">nominal_compressive_strength</span><span class="p">(</span><span class="n">c_sec</span><span class="p">),</span> <span class="c1"># negative</span>
    <span class="s1">&#39;Max Nominal Compression&#39;</span><span class="p">:</span> <span class="n">concrete</span><span class="o">.</span><span class="n">max_nominal_compressive_strength</span><span class="p">(</span><span class="n">c_sec</span><span class="p">),</span> <span class="c1"># negative</span>
    <span class="s1">&#39;Decompression&#39;</span><span class="p">:</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_decompression_point</span><span class="p">(</span><span class="n">external_force</span><span class="o">=</span><span class="n">Nu</span><span class="p">,</span> <span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Balance&#39;</span><span class="p">:</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_balance_point</span><span class="p">(</span><span class="n">external_force</span><span class="o">=</span><span class="n">Nu</span><span class="p">,</span> <span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Tension-Controlled&#39;</span><span class="p">:</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_tension_controlled_point</span><span class="p">(</span><span class="n">external_force</span><span class="o">=</span><span class="n">Nu</span><span class="p">,</span> <span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Pure Flexure&#39;</span><span class="p">:</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_pure_flexure_point</span><span class="p">(</span><span class="n">Nu</span><span class="p">,</span> <span class="n">config</span><span class="p">),</span>
    <span class="s1">&#39;Pure Tension&#39;</span><span class="p">:</span> <span class="n">concrete</span><span class="o">.</span><span class="n">nominal_tensile_strength</span><span class="p">(</span><span class="n">c_sec</span><span class="p">)</span> <span class="c1"># positive</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constants for unit conversions</span>
<span class="n">LB_TO_KIPS</span> <span class="o">=</span> <span class="mf">1e3</span>
<span class="n">LB_IN_TO_KIP_FT</span> <span class="o">=</span> <span class="mf">12e3</span>
<span class="n">ROUNDING_PRECISION</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;neutral_depth_in&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;p_kips&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;m_kip_ft&#39;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="c1"># Create DataFrame with special points</span>
<span class="n">sp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">special_points</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">sp_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neutral_depth_in&#39;</span><span class="p">,</span> <span class="s1">&#39;p_kips&#39;</span><span class="p">,</span> <span class="s1">&#39;m_kip_ft&#39;</span><span class="p">]</span>

<span class="c1"># Convert values to float and apply unit conversions</span>
<span class="n">sp_df</span> <span class="o">=</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sp_df</span><span class="p">[</span><span class="s1">&#39;p_kips&#39;</span><span class="p">]</span> <span class="o">/=</span> <span class="n">LB_TO_KIPS</span> 
<span class="n">sp_df</span><span class="p">[</span><span class="s1">&#39;m_kip_ft&#39;</span><span class="p">]</span> <span class="o">/=</span> <span class="n">LB_IN_TO_KIP_FT</span>
<span class="n">sp_df</span> <span class="o">=</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ROUNDING_PRECISION</span><span class="p">)</span>

<span class="n">sp_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neutral_depth_in</th>
      <th>p_kips</th>
      <th>m_kip_ft</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pure Compression</th>
      <td>-inf</td>
      <td>-1602.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Max Nominal Compression</th>
      <td>-inf</td>
      <td>-1282.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Decompression</th>
      <td>16.865</td>
      <td>-1033.0</td>
      <td>297.0</td>
    </tr>
    <tr>
      <th>Balance</th>
      <td>9.981</td>
      <td>-421.0</td>
      <td>462.0</td>
    </tr>
    <tr>
      <th>Tension-Controlled</th>
      <td>6.324</td>
      <td>-75.0</td>
      <td>387.0</td>
    </tr>
    <tr>
      <th>Pure Flexure</th>
      <td>5.615</td>
      <td>-0.0</td>
      <td>363.0</td>
    </tr>
    <tr>
      <th>Pure Tension</th>
      <td>inf</td>
      <td>608.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Max</span> <span class="pre">Nominal</span> <span class="pre">Compression</span></code> point is corresponding to 0.8 of <code class="docutils literal notranslate"><span class="pre">Pure</span> <span class="pre">Compression</span></code> per ACI 318-25 §22.4.2.1. Note that at <code class="docutils literal notranslate"><span class="pre">Pure</span> <span class="pre">Tension</span></code>, <code class="docutils literal notranslate"><span class="pre">Pure</span> <span class="pre">compression</span></code>, and  <code class="docutils literal notranslate"><span class="pre">Max</span> <span class="pre">Nominal</span> <span class="pre">Compression</span></code> points, the strain profile never becomes zero. Thus, the <code class="docutils literal notranslate"><span class="pre">neutral_depth_in</span></code> for these points are <code class="docutils literal notranslate"><span class="pre">inf</span></code> or <code class="docutils literal notranslate"><span class="pre">-inf</span></code>.</p>
<hr class="docutils" />
<section id="strength-reduction-factor-phi">
<h3>Strength Reduction Factor <span class="math notranslate nohighlight">\(\phi\)</span><a class="headerlink" href="#strength-reduction-factor-phi" title="Link to this heading">#</a></h3>
<p>The strength reduction factor, <span class="math notranslate nohighlight">\(\phi\)</span>, for combined moment and axial force is computed per ACI 318-25 §21.2.2. It depends on the magnitude of the strain in the extreme tensile rebars and the type of transverse bars (i.e., spiral or tie). Let’s obtain the <span class="math notranslate nohighlight">\(\phi\)</span> values for the special points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phi_sp</span> <span class="o">=</span> <span class="n">concrete</span><span class="o">.</span><span class="n">get_bending_reduction_factor</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">sp_df</span><span class="p">[</span><span class="s1">&#39;neutral_depth_in&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sp_df</span><span class="p">[</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi_sp</span>

<span class="n">sp_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>neutral_depth_in</th>
      <th>p_kips</th>
      <th>m_kip_ft</th>
      <th>phi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pure Compression</th>
      <td>-inf</td>
      <td>-1602.0</td>
      <td>0.0</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>Max Nominal Compression</th>
      <td>-inf</td>
      <td>-1282.0</td>
      <td>0.0</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>Decompression</th>
      <td>16.865</td>
      <td>-1033.0</td>
      <td>297.0</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>Balance</th>
      <td>9.981</td>
      <td>-421.0</td>
      <td>462.0</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>Tension-Controlled</th>
      <td>6.324</td>
      <td>-75.0</td>
      <td>387.0</td>
      <td>0.89</td>
    </tr>
    <tr>
      <th>Pure Flexure</th>
      <td>5.615</td>
      <td>-0.0</td>
      <td>363.0</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>Pure Tension</th>
      <td>inf</td>
      <td>608.0</td>
      <td>0.0</td>
      <td>0.90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Moving from <code class="docutils literal notranslate"><span class="pre">Pure</span> <span class="pre">Compression</span></code> point to <code class="docutils literal notranslate"><span class="pre">Pure</span> <span class="pre">Tension</span></code> point, as the compression force reduces the failure mode becomes more ductile, and per ACI 318-25 §21.2.2 the strength reduction factor increases from 0.65 to 0.90. The <code class="docutils literal notranslate"><span class="pre">Tension-Controlled</span></code> point is where the <span class="math notranslate nohighlight">\(\phi\)</span> starts to reduce. There is a <em>transition zone</em> between the <code class="docutils literal notranslate"><span class="pre">Tension-Controlled</span></code> and <code class="docutils literal notranslate"><span class="pre">Balance</span></code> point where <span class="math notranslate nohighlight">\(\phi\)</span> linearly reduced from 0.90 to 0.65.</p>
</section>
</section>
<hr class="docutils" />
<section id="etabs-section-designer">
<h2>ETABS Section Designer<a class="headerlink" href="#etabs-section-designer" title="Link to this heading">#</a></h2>
<p>To verify my computation I used the ETABS Section Desginer. The steps to define the column section are as follows:</p>
<ol class="arabic simple">
<li><p>Define rebar and concrete material properties by going to <code class="docutils literal notranslate"><span class="pre">Define\Material</span> <span class="pre">Properties...</span></code>. Then click on <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">New</span> <span class="pre">Material...</span></code>, and define the concrete and rebar properties as shown in the following screenshots.</p></li>
</ol>
<div style="text-align: center">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_10.png" height=300 alt="Frame properties">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_11.png" height=300 alt="Section Designer">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_12.png" height=300 alt="Section Designer Property Data">
</div>
<ol class="arabic simple" start="2">
<li><p>Next, define the section by going to <code class="docutils literal notranslate"><span class="pre">Define\Section</span> <span class="pre">Properties\Frame</span> <span class="pre">Sections...</span></code>. In the “Section Properties” window, click on <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">New</span> <span class="pre">Property...</span></code>, and set “Section Shape: Concrete Rectangular” then click on <code class="docutils literal notranslate"><span class="pre">Section</span> <span class="pre">Designer</span></code>under “Special”. A new window will pop up which allows you to define the property data for the section. Use the following setup:</p>
<ul class="simple">
<li><p>Property Name:</p></li>
<li><p>Base Material: 3000Psi</p></li>
<li><p>Design Type: Concrete Column</p></li>
<li><p>Concrete Column Check/Design: reinforcement to be checked</p></li>
</ul>
</li>
</ol>
<p>Then click on <code class="docutils literal notranslate"><span class="pre">Section</span> <span class="pre">Designer...</span></code>.</p>
<div style="text-align: center">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_20.png" height=400 alt="Frame properties">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_21.png" height=400 alt="Frame properties">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_22.png" height=400 alt="Frame properties">
</div>
<p>In the “Section Designer” window, click on the <a class="reference internal" href="../../../_images/force_moment_interaction_icon_01.png"><img alt="Draw rectangle icon" src="../../../_images/force_moment_interaction_icon_01.png" style="height: 30px;" /></a>, and from the menu click on <code class="docutils literal notranslate"><span class="pre">Draw</span> <span class="pre">Rectangle</span></code>. Click on the origin to place the rectangle, then right click on the rectangle and edit the dimensions and add rebars as shown in the screenshot below.</p>
<div style="text-align: center">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_23.png" height=400 alt="Draw rectangle">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_24.png" height=400 alt="Edit section properties">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_25.png" height=400 alt="Edit section properties">
</div>
<p>Once modifications are complete, click the <a class="reference internal" href="../../../_images/force_moment_interaction_icon_02.png"><img alt="Interaction surface icon" src="../../../_images/force_moment_interaction_icon_02.png" style="height: 30px;" /></a> icon to navigate to the “Interaction Surface” window. In this window, you can select the curve type (e.g., Design Code Data or Fiber Model Data), choose the surface from the 3D visualization windows, and examine the 2D plot of the P-M interaction curve. The curve data is also available in a table format, which I will transfer into this notebook for comparison with my results. Since compression forces are considered negative, I must multiply all ETABS axial force results by -1 for consistency.</p>
<div style="text-align: center">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_26.png" height=400 alt="Column section">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_30.png" height=400 alt="Interaction surface: Code data include phi">
<img src="../../../assets/img/structure/concrete/force_moment_interaction/force_moment_interaction_32.png" height=400 alt="Interaction surface: Code data exclude phi and fiber data">
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ETABS results</span>

<span class="c1"># Code data, phi excluded</span>
<span class="n">p_etabs</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1282.954</span><span class="p">,</span> <span class="mf">1282.954</span><span class="p">,</span> <span class="mf">1119.234</span><span class="p">,</span> <span class="mf">925.994</span><span class="p">,</span> <span class="mf">700.395</span><span class="p">,</span> <span class="mf">421.321</span><span class="p">,</span> <span class="mf">253.407</span><span class="p">,</span> <span class="mf">31.243</span><span class="p">,</span> <span class="o">-</span><span class="mf">146.445</span><span class="p">,</span> <span class="o">-</span><span class="mf">483.543</span><span class="p">,</span> <span class="o">-</span><span class="mf">609.6</span><span class="p">])</span>
<span class="n">m_etabs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">181.3703</span><span class="p">,</span> <span class="mf">262.8628</span><span class="p">,</span> <span class="mf">335.456</span><span class="p">,</span> <span class="mf">398.7719</span><span class="p">,</span> <span class="mf">462.9059</span><span class="p">,</span> <span class="mf">430.9659</span><span class="p">,</span> <span class="mf">376.8626</span><span class="p">,</span> <span class="mf">285.7061</span><span class="p">,</span> <span class="mf">88.6048</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Code data, phi included</span>
<span class="n">phi_p_etabs</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">833.92</span><span class="p">,</span> <span class="mf">833.92</span><span class="p">,</span> <span class="mf">727.502</span><span class="p">,</span> <span class="mf">601.896</span><span class="p">,</span> <span class="mf">455.257</span><span class="p">,</span> <span class="mf">273.859</span><span class="p">,</span> <span class="mf">191.475</span><span class="p">,</span> <span class="mf">28.118</span><span class="p">,</span> <span class="o">-</span><span class="mf">131.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">435.189</span><span class="p">,</span> <span class="o">-</span><span class="mf">548.64</span><span class="p">])</span>
<span class="n">phi_m_etabs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">117.8907</span><span class="p">,</span> <span class="mf">170.8608</span><span class="p">,</span> <span class="mf">218.0464</span><span class="p">,</span> <span class="mf">259.2017</span><span class="p">,</span> <span class="mf">300.8888</span><span class="p">,</span> <span class="mf">325.6393</span><span class="p">,</span> <span class="mf">339.1764</span><span class="p">,</span> <span class="mf">257.1355</span><span class="p">,</span> <span class="mf">79.7443</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Fiber data</span>
<span class="n">p_fiber_etabs</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1603.692</span><span class="p">,</span> <span class="mf">1170.638</span><span class="p">,</span> <span class="mf">995.709</span><span class="p">,</span> <span class="mf">883.565</span><span class="p">,</span> <span class="mf">689.574</span><span class="p">,</span> <span class="mf">384.072</span><span class="p">,</span> <span class="mf">298.361</span><span class="p">,</span> <span class="mf">143.413</span><span class="p">,</span> <span class="o">-</span><span class="mf">133.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">570.081</span><span class="p">,</span> <span class="o">-</span><span class="mf">609.6</span><span class="p">])</span>
<span class="n">m_fiber_etabs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">274.7825</span><span class="p">,</span> <span class="mf">347.2369</span><span class="p">,</span> <span class="mf">377.7813</span><span class="p">,</span> <span class="mf">418.539</span><span class="p">,</span> <span class="mf">474.9512</span><span class="p">,</span> <span class="mf">457.6552</span><span class="p">,</span> <span class="mf">422.114</span><span class="p">,</span> <span class="mf">269.3691</span><span class="p">,</span> <span class="mf">22.608</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">etabs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;p_fiber_kips&#39;</span><span class="p">:</span> <span class="n">p_fiber_etabs</span><span class="p">,</span>
    <span class="s1">&#39;p_kips&#39;</span><span class="p">:</span> <span class="n">p_etabs</span><span class="p">,</span>
    <span class="s1">&#39;phi_p_kips&#39;</span><span class="p">:</span> <span class="n">phi_p_etabs</span><span class="p">,</span>
    <span class="s1">&#39;m_fiber_kip_ft&#39;</span><span class="p">:</span> <span class="n">m_fiber_etabs</span><span class="p">,</span>
    <span class="s1">&#39;m_kip_ft&#39;</span><span class="p">:</span> <span class="n">m_etabs</span><span class="p">,</span>
    <span class="s1">&#39;phi_m_kip_ft&#39;</span><span class="p">:</span> <span class="n">phi_m_etabs</span>
<span class="p">})</span>

<span class="n">etabs_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>p_fiber_kips</th>
      <th>p_kips</th>
      <th>phi_p_kips</th>
      <th>m_fiber_kip_ft</th>
      <th>m_kip_ft</th>
      <th>phi_m_kip_ft</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1603.692</td>
      <td>-1282.954</td>
      <td>-833.920</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1170.638</td>
      <td>-1282.954</td>
      <td>-833.920</td>
      <td>274.7825</td>
      <td>181.3703</td>
      <td>117.8907</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-995.709</td>
      <td>-1119.234</td>
      <td>-727.502</td>
      <td>347.2369</td>
      <td>262.8628</td>
      <td>170.8608</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-883.565</td>
      <td>-925.994</td>
      <td>-601.896</td>
      <td>377.7813</td>
      <td>335.4560</td>
      <td>218.0464</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-689.574</td>
      <td>-700.395</td>
      <td>-455.257</td>
      <td>418.5390</td>
      <td>398.7719</td>
      <td>259.2017</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-384.072</td>
      <td>-421.321</td>
      <td>-273.859</td>
      <td>474.9512</td>
      <td>462.9059</td>
      <td>300.8888</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-298.361</td>
      <td>-253.407</td>
      <td>-191.475</td>
      <td>457.6552</td>
      <td>430.9659</td>
      <td>325.6393</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-143.413</td>
      <td>-31.243</td>
      <td>-28.118</td>
      <td>422.1140</td>
      <td>376.8626</td>
      <td>339.1764</td>
    </tr>
    <tr>
      <th>8</th>
      <td>133.500</td>
      <td>146.445</td>
      <td>131.800</td>
      <td>269.3691</td>
      <td>285.7061</td>
      <td>257.1355</td>
    </tr>
    <tr>
      <th>9</th>
      <td>570.081</td>
      <td>483.543</td>
      <td>435.189</td>
      <td>22.6080</td>
      <td>88.6048</td>
      <td>79.7443</td>
    </tr>
    <tr>
      <th>10</th>
      <td>609.600</td>
      <td>609.600</td>
      <td>548.640</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>I will plot the interaction diagram for these results momentarily. But, first let’s generate the data that I need to plot P-M diagram using the algorithm that I developed so far.</p>
</section>
<hr class="docutils" />
<section id="p-m-diagram">
<h2>P-M Diagram<a class="headerlink" href="#p-m-diagram" title="Link to this heading">#</a></h2>
<p>To generate the points required to plot the P-M interaction diagram, in addition to the critical points obtained earlier, I calculate some intermediary points to increase the accuracy of the plot. To accomplish this, I calculate the internal forces (P) and internal moments (M) at a certain neutral axis depth ranging from <code class="docutils literal notranslate"><span class="pre">min_neutral_depth</span></code> to <code class="docutils literal notranslate"><span class="pre">max_neutral_depth</span></code> with the total number of <code class="docutils literal notranslate"><span class="pre">n_points</span></code> pairs of (P, M). The process to calculate the P and M is shown in the diagram below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yn</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">concrete</span><span class="o">.</span><span class="n">generate_force_moment_interaction</span><span class="p">(</span>
    <span class="n">beam</span><span class="p">,</span> 
    <span class="n">min_neutral_depth</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">beam</span><span class="o">.</span><span class="n">section_height</span><span class="p">(),</span>
    <span class="n">max_neutral_depth</span> <span class="o">=</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">beam</span><span class="o">.</span><span class="n">section_height</span><span class="p">(),</span>
    <span class="n">n_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">n_disc</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I also need the <span class="math notranslate nohighlight">\(\phi\)</span>-factor based on the strain in extreme tensile rebars.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the bending reduction factor, phi, for the generated points</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">concrete</span><span class="o">.</span><span class="n">get_bending_reduction_factor</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">yn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>since the code limits the compression strength due to accidental eccentrocity, I need to cut off the diagram after the maximum nominal axial strength, <span class="math notranslate nohighlight">\(P_{n,max}\)</span>. Thus, I obtain the closest value to <span class="math notranslate nohighlight">\(P_{n,max}\)</span> within the generated data and stop the curve at the point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the index where f is closest to P_n_max</span>
<span class="n">p_nmax_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">special_points</span><span class="p">[</span><span class="s1">&#39;Max Nominal Compression&#39;</span><span class="p">][</span><span class="s1">&#39;force&#39;</span><span class="p">]))</span>

<span class="c1"># Splitting the data into two parts: before and after P_n_max, and converting to kips and kip-ft</span>
<span class="n">phi_pre</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[:</span><span class="n">p_nmax_idx</span><span class="p">]</span>
<span class="n">phi_post</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">p_nmax_idx</span><span class="p">:]</span>
<span class="n">p_pre</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:</span><span class="n">p_nmax_idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span> <span class="c1"># convert force from lb to kips</span>
<span class="n">p_post</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">p_nmax_idx</span><span class="p">:]</span><span class="o">/</span><span class="mf">1e3</span> 
<span class="n">m_pre</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:</span><span class="n">p_nmax_idx</span><span class="p">]</span><span class="o">/</span><span class="mf">12e3</span> <span class="c1"># convert moment from lb-in to kip-ft</span>
<span class="n">m_post</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">p_nmax_idx</span><span class="p">:]</span><span class="o">/</span><span class="mf">12e3</span>
</pre></div>
</div>
</div>
</div>
<p>I also, calculate the moment corresponding to <span class="math notranslate nohighlight">\(P_{n,max}\)</span> through the interative process that I mentioned earlier. To do so, I define the external force to be equal to <span class="math notranslate nohighlight">\(P_{n,max}\)</span>, and Iexpect to get the total force to be close to zero after solving the equilibrium equation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;External force at Max Nominal Compression: </span><span class="si">{</span><span class="n">special_points</span><span class="p">[</span><span class="s1">&#39;Max Nominal Compression&#39;</span><span class="p">][</span><span class="s1">&#39;force&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>

<span class="n">max_nominal</span> <span class="o">=</span> <span class="n">beam</span><span class="o">.</span><span class="n">solve_neutral_depth_equilibrium</span><span class="p">(</span><span class="n">external_force</span><span class="o">=</span><span class="n">special_points</span><span class="p">[</span><span class="s1">&#39;Max Nominal Compression&#39;</span><span class="p">][</span><span class="s1">&#39;force&#39;</span><span class="p">],</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Depth of neutral axis at Max Nominal Compression: </span><span class="si">{</span><span class="n">max_nominal</span><span class="p">[</span><span class="s1">&#39;neutral_depth&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total force at Max Nominal Compression: </span><span class="si">{</span><span class="n">max_nominal</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total moment at Max Nominal Compression: </span><span class="si">{</span><span class="n">max_nominal</span><span class="p">[</span><span class="s1">&#39;moment&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kip-ft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>External force at Max Nominal Compression: -1282 kips
Depth of neutral axis at Max Nominal Compression: 20.808 in
Total force at Max Nominal Compression: 1 kips
Total moment at Max Nominal Compression: 182 kip-ft
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="comaparison">
<h2>Comaparison<a class="headerlink" href="#comaparison" title="Link to this heading">#</a></h2>
<p>Now, it’s time to plot the results and compare.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define labels for special points</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">r</span><span class="s1">&#39;$P_</span><span class="si">{o}</span><span class="s1">$&#39;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s1">&#39;$P_{n,max}$&#39;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s1">&#39;$(P_</span><span class="si">{d}</span><span class="s1">, M_</span><span class="si">{d}</span><span class="s1">)$&#39;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s1">&#39;$(P_</span><span class="si">{b}</span><span class="s1">, M_</span><span class="si">{b}</span><span class="s1">)$&#39;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s1">&#39;$(P_</span><span class="si">{tc}</span><span class="s1">, M_</span><span class="si">{tc}</span><span class="s1">)$&#39;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s1">&#39;$(P_</span><span class="si">{f}</span><span class="s1">, M_</span><span class="si">{f}</span><span class="s1">)$&#39;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s1">&#39;$P_{nt,max}$&#39;</span>
<span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># ---Plot unfactored P-M interaction curves---</span>
<span class="c1"># Developed</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="mf">12e3</span><span class="p">,</span> <span class="n">p</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0065F8&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Developed&#39;</span><span class="p">)</span>
<span class="c1"># ETABS</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m_etabs</span><span class="p">,</span> <span class="n">p_etabs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#343434&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ETABS Code&#39;</span><span class="p">)</span>
<span class="c1"># ETABS fiber</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m_fiber_etabs</span><span class="p">,</span> <span class="n">p_fiber_etabs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#343434&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ETABS Fiber&#39;</span><span class="p">)</span>
<span class="c1"># Special points</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sp_df</span><span class="p">[</span><span class="s1">&#39;m_kip_ft&#39;</span><span class="p">],</span> <span class="n">sp_df</span><span class="p">[</span><span class="s1">&#39;p_kips&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EB5B00&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># Draw line from origin to balance point</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Balance&#39;</span><span class="p">,</span> <span class="s1">&#39;m_kip_ft&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Balance&#39;</span><span class="p">,</span> <span class="s1">&#39;p_kips&#39;</span><span class="p">]],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="c1"># ---Plot factored P-M interaction curves---</span>
<span class="c1"># Developed</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phi_pre</span> <span class="o">*</span> <span class="n">m_pre</span><span class="p">,</span> <span class="n">phi_pre</span> <span class="o">*</span> <span class="n">p_pre</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0065F8&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phi_post</span> <span class="o">*</span> <span class="n">m_post</span><span class="p">,</span> <span class="n">phi_post</span> <span class="o">*</span> <span class="n">p_post</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0065F8&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>
<span class="c1"># Draw hiroizontal line at P_nmax</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">phi</span><span class="p">[</span><span class="n">p_nmax_idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="p">[</span><span class="n">p_nmax_idx</span><span class="p">]</span><span class="o">/</span><span class="mf">12e3</span><span class="p">],</span> <span class="p">[</span><span class="n">phi</span><span class="p">[</span><span class="n">p_nmax_idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">p_nmax_idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0065F8&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>
<span class="c1"># ETABS</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phi_m_etabs</span><span class="p">,</span> <span class="n">phi_p_etabs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#343434&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;M (kip.ft)&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;P (kips)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Developed vs. ETABS P-M Interactions&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">x_max</span> <span class="o">=</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mf">12e3</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">x_max</span><span class="p">)</span>
<span class="n">y_max</span> <span class="o">=</span> <span class="mf">1.2</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">/</span><span class="mf">1e3</span>
<span class="n">y_min</span> <span class="o">=</span> <span class="mf">1.2</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mf">1e3</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">y_min</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">y_max</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="c1"># Set the position of the axes spines to cross at the origin</span>
<span class="c1"># ax.spines[&#39;bottom&#39;].set_position(&#39;zero&#39;)</span>
<span class="c1"># ax.spines[&#39;left&#39;].set_position(&#39;zero&#39;)</span>
<span class="c1"># ax.spines[&#39;top&#39;].set_visible(False)</span>
<span class="c1"># ax.spines[&#39;right&#39;].set_visible(False)</span>
<span class="c1"># ax.xaxis.set_ticks_position(&#39;bottom&#39;)</span>
<span class="c1"># ax.xaxis.set_label_position(&#39;bottom&#39;)</span>

<span class="c1"># --- Annotate special points ---</span>
<span class="c1"># Pure Compression</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.02</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> 
<span class="c1"># Max Nominal Compression</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.02</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># Decompression</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.95</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">0.95</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="c1"># Balance</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.95</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="c1"># Tension-Controlled</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.03</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># Pure Flexure</span>
<span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=.5,head_width=0.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">10</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">200</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">)</span>
<span class="c1"># Pure Tension</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1.05</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Calculate and annotate balanced eccentricity</span>
<span class="n">balanced_rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_max</span> <span class="o">/</span> <span class="n">y_max</span><span class="p">)</span>
<span class="n">balanced_ecc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$e_b=</span><span class="si">{</span><span class="n">balanced_ecc</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">\ in$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.4</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">20</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">balanced_rotation</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Annotate phi(P-M)</span>
<span class="n">phi_d</span> <span class="o">=</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">p_d</span> <span class="o">=</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">m_d</span> <span class="o">=</span> <span class="n">sp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=.5,head_width=0.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$\phi(P-M)$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">phi_d</span><span class="o">*</span><span class="n">m_d</span><span class="p">,</span> <span class="n">phi_d</span><span class="o">*</span><span class="n">p_d</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">phi_d</span><span class="o">*</span><span class="n">m_d</span><span class="o">+</span><span class="mi">75</span><span class="p">,</span> <span class="n">phi_d</span><span class="o">*</span><span class="n">p_d</span><span class="o">-</span><span class="mi">75</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center_baseline&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># ax.set_aspect(&#39;equal&#39;, adjustable=&#39;datalim&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/9355046604f28b3086201aadc5314e384d303f12853036bb0e413fe48f2ddd26.png" src="../../../_images/9355046604f28b3086201aadc5314e384d303f12853036bb0e413fe48f2ddd26.png" />
</div>
</div>
<p>Comparing the unfactored curves, the ETABS fiber model is slightly overestimated the compression capacity relative to the code, while on the tension side it is slightly underestimated. The devleoped method is in close agreement with the ETABS code predictions in both factored and unfactored capacities. the factored moment at balance point is slightly overpredicted by the developed method compared to ETABS, hoever, the unfactored values are exactly matches.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./structure\concrete\force_moment_interaction"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../moment_curvature/steel_w_sec_moment_curvature.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Moment-Curvature: Steel W-Section</p>
      </div>
    </a>
    <a class="right-next"
       href="../../shear_wall_neutral_axis/rect_shear_wall_neutral_axis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Rectangular Concrete Shear Wall Neutral Axis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-concrete-section">Define Concrete Section</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pure-flexure-point-f">Pure Flexure Point (F):</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-special-points">Compute Special Points</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strength-reduction-factor-phi">Strength Reduction Factor <span class="math notranslate nohighlight">\(\phi\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#etabs-section-designer">ETABS Section Designer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p-m-diagram">P-M Diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comaparison">Comaparison</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hossein Karagah
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025 GNU GENERAL PUBLIC LICENSE.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>