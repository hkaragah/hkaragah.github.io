
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Setup Notebook &#8212; Hossein Karagah, PhD, PE</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J3171580FP"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J3171580FP');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J3171580FP');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'structure/concrete_shear/prestressed_determinate_beam/prestressed_determinate_beam';</script>
    <link rel="icon" href="../../../_static/headshot.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">Hossein Karagah, PhD, PE</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/headshot.png" class="logo__image only-light" alt="Hossein Karagah, PhD, PE - Home"/>
    <script>document.write(`<img src="../../../_static/headshot.png" class="logo__image only-dark" alt="Hossein Karagah, PhD, PE - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Structural Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../p_delta/cant_col_p_delta.html">P-Delta Analysis: Cantilever Column</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../moment_curvature/steel_w_sec_moment_curvature.html">Moment-Curvature: Steel W-Section</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concrete/force_moment_interaction/force_moment_interaction.html">P-M Interaction Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shear_wall_neutral_axis/rect_shear_wall_neutral_axis.html">Rectangular Concrete Shear Wall Neutral Axis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../opensees/opensees_steel_materials.html">OpenSees Uniaxial Steel Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structural_dynamics/modal_analysis_basic.html">Modal Analysis: 3-DOF System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../opensees/two_story_mrf.html">OpenSees: Three-Story MRF Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Earthquake Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../earthquake/asce7_2800_spectrum/asce7_2800_spectrum.html">ASCE 7 vs. 2800 Standard: Comparing Design Spectral Response Acceleration Parameter (Sa)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../earthquake/frequency_content/frequency_content.html">Frequency content of Earthquake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../earthquake/response_spectrum/response_spectrum.html">Earthquake Response Spectrum</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hkaragah/hkaragah.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hkaragah/hkaragah.github.io/issues/new?title=Issue%20on%20page%20%2Fstructure/concrete_shear/prestressed_determinate_beam/prestressed_determinate_beam.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/structure/concrete_shear/prestressed_determinate_beam/prestressed_determinate_beam.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Setup Notebook</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Setup Notebook</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#define-beams-columns-and-joints">Define Beams, columns, and Joints</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-materials">1. Define Materials</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2. Define Beams, Columns, and joints</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-beam-section-properties">Compute Beam Section Properties</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#define-loads">Define Loads</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prestressing-tendons">Prestressing Tendons</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-prestressing-force">1. Compute Prestressing Force</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-number-of-strands">2. Compute Number of Strands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-drape-in-shorter-span">3.Compute Drape in Shorter Span</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strand-profile">4.Strand Profile</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-actual-prestressing-equivalent-loads">5.Determine Actual Prestressing Equivalent Loads</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-beams">Analyze Beams</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-distribution-factors-carry-over-factors-and-fixed-end-moments">1.Compute Distribution Factors, Carry-Over Factors, and Fixed-End Moments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-end-moments">2.Fixed-End Moments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#service-loads-shears-and-moments">3.Service Loads Shears and Moments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shear-and-moment-diagrams">4. Shear and Moment Diagrams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shear-and-moment-values">5. Shear and Moment Values</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#service-stresses">Service Stresses</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ultimate-stresses">Ultimate Stresses</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-secondary-moments">1. Calculate Secondary Moments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-demand-shear-and-moment">2. Calculate Demand Shear and Moment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-tendons-stress-at-ultimate">3. Calculate Tendons Stress at Ultimate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-non-prestressing-reinforcement">4. Determine Non-prestressing Reinforcement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-nominal-moment-capacity">5. Compute Nominal Moment Capacity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-strains">6. Compute Strains</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-flexural-strength-at-other-sections-in-progress">7. Check Flexural Strength at Other Sections (in progress)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#shear-design">Shear Design</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div style="text-align: right;">
<a target="_blank" href="https://colab.research.google.com/github/hkaragah/hkaragah.github.io/blob/main/structure/moment_curvature/steel_w_sec_moment_curvature.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>
<div style="font-size: 0.8em; color: #555;">By Hossein Karagah</div>
<div style="font-size: 0.8em; color: #555;">© Copyright 2025 GNU GENERAL PUBLIC LICENSE.</div>
</div><section id="setup-notebook">
<h1>Setup Notebook<a class="headerlink" href="#setup-notebook" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;../../..&quot;</span><span class="p">))</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.materials</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.steel</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.shapes</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.analysis</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">assets.modules.concrete</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">concrete</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.axes</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">axes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rectangle</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">bbox_artist</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-beams-columns-and-joints">
<h1>Define Beams, columns, and Joints<a class="headerlink" href="#define-beams-columns-and-joints" title="Link to this heading">#</a></h1>
<section id="define-materials">
<h2>1. Define Materials<a class="headerlink" href="#define-materials" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define materials</span>
<span class="n">con_5000</span> <span class="o">=</span> <span class="n">ACIConcrete</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">is_lightweight</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">150</span> <span class="o">/</span> <span class="mi">12</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">mild_steel</span> <span class="o">=</span> <span class="n">BilinearSteel</span><span class="p">(</span><span class="s2">&quot;A706&quot;</span><span class="p">,</span> <span class="n">fy</span><span class="o">=</span><span class="mi">60000</span><span class="p">)</span>
<span class="n">pt_steel</span> <span class="o">=</span> <span class="n">PrestressingA416Strand</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>2. Define Beams, Columns, and joints<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of spans</span>
<span class="n">n_spans</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Define lower and upper columns</span>
<span class="n">lower_cols</span><span class="p">,</span> <span class="n">upper_cols</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_spans</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">lower_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ConcreteColumn</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">11</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">24</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">24</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">con_5000</span><span class="p">))</span>
    <span class="n">upper_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ConcreteColumn</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">11</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">24</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">24</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">con_5000</span><span class="p">))</span>

<span class="c1"># Define beams</span>
<span class="n">beam_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">62</span><span class="p">,</span> <span class="mi">44</span><span class="p">]</span>
<span class="n">beams</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConcreteTSectionBeam</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">length</span> <span class="ow">in</span> <span class="n">beam_lengths</span><span class="p">:</span>
    <span class="n">beams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ConcreteTSectionBeam</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">36</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">flange_width</span><span class="o">=</span><span class="mi">95</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">flange_thickness</span><span class="o">=</span><span class="mi">5</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">con_5000</span><span class="p">))</span>

<span class="c1"># Define joints</span>
<span class="n">joints</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_spans</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">left_beam</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">right_beam</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n_spans</span> <span class="k">else</span> <span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">joints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Concrete2DJoint</span><span class="p">(</span><span class="n">left_beam</span><span class="p">,</span> <span class="n">right_beam</span><span class="p">,</span> <span class="n">lower_cols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">upper_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Defined Columns:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">lower_cols</span> <span class="o">+</span> <span class="n">upper_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Defined Beams:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">beam</span> <span class="ow">in</span> <span class="n">beams</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">beam</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Defined Joints:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">joint</span> <span class="ow">in</span> <span class="n">joints</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">joint</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Defined Columns:
Column C1 @ J1 [height=11.33&#39;, 24.0&quot; x 24.0&quot;]
Column C3 @ J2 [height=11.33&#39;, 24.0&quot; x 24.0&quot;]
Column C5 @ J3 [height=11.33&#39;, 24.0&quot; x 24.0&quot;]
Column C2 @ J1 [height=11.33&#39;, 24.0&quot; x 24.0&quot;]
Column C4 @ J2 [height=11.33&#39;, 24.0&quot; x 24.0&quot;]
Column C6 @ J3 [height=11.33&#39;, 24.0&quot; x 24.0&quot;]

Defined Beams:
T-Beam B1 @ J1 --&gt; J2 [length=62.00&#39;, web: 15.0&quot; x 36.0&quot;, flange: 95.0&quot; x 5.0&quot;]
T-Beam B2 @ J2 --&gt; J3 [length=44.00&#39;, web: 15.0&quot; x 36.0&quot;, flange: 95.0&quot; x 5.0&quot;]

Defined Joints:
2D Joint J1 @ None← →B1, C1↓ ↑C2
2D Joint J2 @ B1← →B2, C3↓ ↑C4
2D Joint J3 @ B2← →None, C5↓ ↑C6
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="compute-beam-section-properties">
<h1>Compute Beam Section Properties<a class="headerlink" href="#compute-beam-section-properties" title="Link to this heading">#</a></h1>
<p>Both spans have the same section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Beam section properties</span>

<span class="c1"># Beam area</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="mi">12</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># ft^2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A=</span><span class="si">{</span><span class="n">A</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> in^2&quot;</span><span class="p">)</span>

<span class="c1"># Beam moment of inertia</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">moment_inertia</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">12</span><span class="o">**</span><span class="mi">4</span> <span class="c1"># in^4</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;I=</span><span class="si">{</span><span class="n">I</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> in^4&quot;</span><span class="p">)</span>

<span class="c1"># Beam centroid relait veo the top and bottom and top of the beam</span>
<span class="n">yt</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yt</span> <span class="o">*</span> <span class="mi">12</span> <span class="c1"># in</span>
<span class="n">yb</span> <span class="o">=</span>  <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yb</span> <span class="o">*</span> <span class="mi">12</span> <span class="c1"># in</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;yt=</span><span class="si">{</span><span class="n">yt</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;yb=</span><span class="si">{</span><span class="n">yb</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>

<span class="c1"># Beam section modulus</span>
<span class="n">S_t</span> <span class="o">=</span> <span class="n">I</span> <span class="o">/</span> <span class="n">yt</span> <span class="c1"># in^3</span>
<span class="n">S_b</span> <span class="o">=</span> <span class="n">I</span> <span class="o">/</span> <span class="n">yb</span> <span class="c1"># in^3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;St=</span><span class="si">{</span><span class="n">S_t</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> in^3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sb=</span><span class="si">{</span><span class="n">S_b</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> in^3&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A=940 in^2
I=114360 in^4
yt=11.4 in
yb=24.6 in
St=10028 in^3
Sb=4650 in^3
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-loads">
<h1>Define Loads<a class="headerlink" href="#define-loads" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Both spans have the same 15”x36” beam cast monolitically with the slab creating a T-section.</p></li>
<li><p>Beams are repated &#64; 18-ft o.c.</p></li>
<li><p>For the live load assume standard parking loading</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute area loads</span>
<span class="n">concrete_density</span> <span class="o">=</span> <span class="n">con_5000</span><span class="o">.</span><span class="n">density</span> <span class="o">*</span> <span class="p">(</span><span class="mi">12</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="c1"># k/ft^3</span>

<span class="n">slab_thickness</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">12</span> <span class="c1"># ft</span>
<span class="n">slab_load</span> <span class="o">=</span> <span class="n">slab_thickness</span> <span class="o">*</span>  <span class="n">concrete_density</span><span class="c1"># k/ft^2</span>

<span class="n">beam_spacing</span> <span class="o">=</span> <span class="mi">18</span> <span class="c1"># ft</span>
<span class="n">beam_sec</span><span class="p">:</span> <span class="n">ConcreteTSectionBeam</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">beam_load</span> <span class="o">=</span> <span class="p">(</span><span class="n">beam_sec</span><span class="o">.</span><span class="n">depth</span> <span class="o">-</span> <span class="n">slab_thickness</span><span class="p">)</span> <span class="o">*</span> <span class="n">beam_sec</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">concrete_density</span> <span class="o">/</span> <span class="n">beam_spacing</span> <span class="c1"># k/ft^2</span>

<span class="n">superimposed_dead_load</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="c1"># k/ft^2</span>

<span class="n">concrete_load</span> <span class="o">=</span> <span class="n">slab_load</span> <span class="o">+</span> <span class="n">beam_load</span> <span class="c1"># k/ft^2</span>
<span class="n">dead_load</span> <span class="o">=</span> <span class="n">concrete_load</span> <span class="o">+</span> <span class="n">superimposed_dead_load</span> <span class="c1"># k/ft^2</span>
<span class="n">live_load</span> <span class="o">=</span> <span class="mi">40</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="c1"># k/ft^2</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Concrete load: </span><span class="si">{</span><span class="n">concrete_load</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft^2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dead load: </span><span class="si">{</span><span class="n">dead_load</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft^2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Live load: </span><span class="si">{</span><span class="n">live_load</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft^2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Compute beam loads</span>
<span class="n">w_conc</span> <span class="o">=</span> <span class="n">concrete_load</span> <span class="o">*</span> <span class="n">beam_spacing</span> <span class="c1"># k/ft</span>
<span class="n">w_dead</span> <span class="o">=</span> <span class="n">dead_load</span> <span class="o">*</span> <span class="n">beam_spacing</span> <span class="c1"># k/ft</span>
<span class="n">w_live</span> <span class="o">=</span> <span class="n">live_load</span> <span class="o">*</span> <span class="n">beam_spacing</span> <span class="c1"># k/ft</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;w_conc = </span><span class="si">{</span><span class="n">w_conc</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;w_dead = </span><span class="si">{</span><span class="n">w_dead</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;w_live = </span><span class="si">{</span><span class="n">w_live</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Compute factored loads</span>
<span class="n">w_ud</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="n">w_dead</span> <span class="c1"># k/ft</span>
<span class="n">w_ul</span> <span class="o">=</span> <span class="mf">1.6</span> <span class="o">*</span> <span class="n">w_live</span> <span class="c1"># k/ft</span>
<span class="n">w_u</span> <span class="o">=</span> <span class="n">w_ud</span> <span class="o">+</span> <span class="n">w_ul</span> <span class="c1"># k/ft</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;w_ud = </span><span class="si">{</span><span class="n">w_ud</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;w_ul = </span><span class="si">{</span><span class="n">w_ul</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;w_u = </span><span class="si">{</span><span class="n">w_u</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> k/ft</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Concrete load: 0.089 k/ft^2
Dead load: 0.091 k/ft^2
Live load: 0.040 k/ft^2

w_conc = 1.609 k/ft
w_dead = 1.645 k/ft
w_live = 0.720 k/ft

w_ud = 1.974 k/ft
w_ul = 1.152 k/ft
w_u = 3.126 k/ft
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="prestressing-tendons">
<h1>Prestressing Tendons<a class="headerlink" href="#prestressing-tendons" title="Link to this heading">#</a></h1>
<section id="compute-prestressing-force">
<h2>1. Compute Prestressing Force<a class="headerlink" href="#compute-prestressing-force" title="Link to this heading">#</a></h2>
<p>Balacing approximately 70% of concrete load in each span and proviing a minimum of 250 psi average prestressing compression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_comp_stress</span> <span class="o">=</span> <span class="mi">250</span> <span class="o">/</span><span class="mf">1e3</span> <span class="c1"># ksi</span>
<span class="n">balance_factor</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="c1"># Distance between the lowest point of the tendon to the bottom of the beam in span A-B</span>
<span class="n">low_ab</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># in</span>

<span class="c1"># Distance between the highest point of tendon to the top of the beam at mid-support B</span>
<span class="n">high_b</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># in</span>

<span class="c1"># Beam: A-----B-----C</span>
<span class="c1"># Center of gravity of strand profile (c.g.s.) from the top of the beam</span>
<span class="n">cgs_a</span> <span class="o">=</span> <span class="n">yt</span> <span class="c1"># in</span>
<span class="n">cgs_ab</span> <span class="o">=</span> <span class="n">beam_sec</span><span class="o">.</span><span class="n">depth</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">-</span> <span class="n">low_ab</span> <span class="c1"># in</span>
<span class="n">cgs_b</span> <span class="o">=</span> <span class="n">high_b</span> <span class="c1"># in</span>

<span class="c1"># Compute prestressing force to balance 70% of concrete load</span>
<span class="n">l_ab</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="c1"># ft</span>
<span class="n">ecc_ab</span> <span class="o">=</span> <span class="n">cgs_ab</span> <span class="o">-</span> <span class="p">(</span><span class="n">cgs_a</span> <span class="o">+</span> <span class="n">cgs_b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># in</span>
<span class="n">w_eq_ab</span> <span class="o">=</span> <span class="n">balance_factor</span> <span class="o">*</span> <span class="n">w_conc</span>
<span class="n">F_min</span> <span class="o">=</span> <span class="n">min_comp_stress</span> <span class="o">*</span> <span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="mi">12</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># kips</span>
<span class="n">F</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">F_min</span><span class="p">,</span> <span class="p">(</span><span class="n">w_eq_ab</span> <span class="o">*</span> <span class="n">l_ab</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ecc_ab</span> <span class="o">/</span> <span class="mi">12</span><span class="p">))</span> <span class="c1"># kips</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a=</span><span class="si">{</span><span class="n">ecc_ab</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F=</span><span class="si">{</span><span class="n">F</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kips ≥ Fmin=</span><span class="si">{</span><span class="n">F_min</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kips</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a=24.3 in
F=267 kips ≥ Fmin=235 kips
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-number-of-strands">
<h2>2. Compute Number of Strands<a class="headerlink" href="#compute-number-of-strands" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Assume 1/2”-strands with the area of 0.153 in² and <span class="math notranslate nohighlight">\(f_{pu}=270\ ksi\)</span>.</p></li>
<li><p>Assume <span class="math notranslate nohighlight">\(15\ ksi\)</span> prestressing loss.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define prestessing strand properties</span>
<span class="n">strand</span> <span class="o">=</span> <span class="n">Prestressing7WireStrand</span><span class="p">(</span><span class="n">dia</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">pt_steel</span><span class="p">)</span>

<span class="c1"># Mechanical properties of prestressing strand</span>
<span class="n">fpu</span> <span class="o">=</span> <span class="n">strand</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">fpu</span><span class="o">/</span><span class="mf">1e3</span> <span class="c1"># ksi</span>
<span class="n">pt_loss</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1"># ksi, prestressing loss</span>
<span class="n">fpy</span> <span class="o">=</span> <span class="n">strand</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">fpy</span> <span class="c1"># ksi</span>
<span class="n">fse</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">fpu</span> <span class="o">-</span> <span class="n">pt_loss</span> <span class="c1"># ksi</span>

<span class="c1"># Compute number of required strands</span>
<span class="n">n_strands</span> <span class="o">=</span> <span class="n">F</span> <span class="o">/</span> <span class="p">(</span><span class="n">strand</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="n">fse</span><span class="p">)</span>
<span class="n">n_strands</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n_strands</span><span class="p">))</span>
<span class="n">Aps</span> <span class="o">=</span> <span class="n">n_strands</span> <span class="o">*</span> <span class="n">strand</span><span class="o">.</span><span class="n">area</span> <span class="c1"># in^2</span>

<span class="c1"># Acutal prestressing force</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">n_strands</span> <span class="o">*</span> <span class="n">strand</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="n">fse</span> <span class="c1"># kips</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of 1/2</span><span class="se">\&quot;</span><span class="s2">-strands: </span><span class="si">{</span><span class="n">n_strands</span><span class="si">}</span><span class="s2"> (Aps=</span><span class="si">{</span><span class="n">Aps</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> in^2)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Provided prestressing force: F=</span><span class="si">{</span><span class="n">F</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>

<span class="c1"># Define prestressing tendon properties</span>
<span class="n">tendon</span> <span class="o">=</span> <span class="n">PrestressingTendon</span><span class="p">(</span><span class="n">strand</span><span class="p">,</span> <span class="n">n_strands</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of 1/2&quot;-strands: 10 (Aps=1.530 in^2)
Provided prestressing force: F=266.2 kips
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-drape-in-shorter-span">
<h2>3.Compute Drape in Shorter Span<a class="headerlink" href="#compute-drape-in-shorter-span" title="Link to this heading">#</a></h2>
<p>Using the prestressing force and number of strands determined in the previous section, I calculate the drape in the middle of the second span to balance 70% of the concrete load.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Beam: A-----B-----C</span>
<span class="n">l_bc</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="c1"># ft</span>
<span class="n">ecc_bc</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_eq_ab</span> <span class="o">*</span> <span class="n">l_bc</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="n">F</span> <span class="o">*</span> <span class="mi">12</span> <span class="c1"># in</span>
<span class="n">cgs_c</span> <span class="o">=</span> <span class="n">yt</span>  <span class="c1"># in</span>
<span class="n">cgs_bc</span> <span class="o">=</span> <span class="n">ecc_bc</span> <span class="o">+</span> <span class="p">(</span><span class="n">cgs_b</span> <span class="o">+</span> <span class="n">cgs_c</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># in</span>

<span class="c1"># Distance between the lowest point of the tendon to the bottom of the beam in span B-C</span>
<span class="n">low_bc</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">depth</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">-</span> <span class="n">cgs_bc</span> <span class="c1"># in</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distance from lowest point of tendon to bottom of beam BC: </span><span class="si">{</span><span class="n">low_bc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distance from lowest point of tendon to bottom of beam BC: 16.0 in
</pre></div>
</div>
</div>
</div>
</section>
<section id="strand-profile">
<h2>4.Strand Profile<a class="headerlink" href="#strand-profile" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define end points of the tendon profile</span>
<span class="n">p_a</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># at c.g.c.</span>
<span class="n">p_b</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yt</span><span class="o">*</span><span class="mi">12</span> <span class="o">-</span> <span class="n">high_b</span><span class="p">)</span>
<span class="n">p_c</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># at c.g.c.</span>

<span class="c1"># Define minimum ordinate of the tendon given the drape</span>
<span class="n">y_ext_ab</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yb</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">-</span> <span class="n">low_ab</span><span class="p">)</span> <span class="c1"># in</span>
<span class="n">y_ext_bc</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yb</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">-</span> <span class="n">low_bc</span><span class="p">)</span> <span class="c1"># in</span>

<span class="c1"># Compute the parabolic profile of the tendon in span A-B and B-C</span>
<span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">parabola_from_points</span><span class="p">(</span><span class="n">p_a</span><span class="p">,</span> <span class="n">p_b</span><span class="p">,</span> <span class="n">y_ext_ab</span><span class="p">)</span>
<span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">parabola_from_points</span><span class="p">(</span><span class="n">p_b</span><span class="p">,</span> <span class="n">p_c</span><span class="p">,</span> <span class="n">y_ext_bc</span><span class="p">)</span>

<span class="c1"># Compute extreme point&#39;s abscissa and ordinate using calculated parabola coefficients</span>
<span class="n">x_ext_ab</span> <span class="o">=</span> <span class="o">-</span><span class="n">b1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a1</span><span class="p">)</span> <span class="c1"># ft, in span A-B</span>
<span class="n">y_ext_ab_calc</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">x_ext_ab</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x_ext_ab</span> <span class="o">+</span> <span class="n">c1</span>

<span class="n">x_ext_bc</span> <span class="o">=</span> <span class="o">-</span><span class="n">b2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a2</span><span class="p">)</span> <span class="c1"># ft, in span B-C</span>
<span class="n">y_ext_bc_calc</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">x_ext_bc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">x_ext_bc</span> <span class="o">+</span> <span class="n">c2</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strand profile (A-B): y = </span><span class="si">{</span><span class="n">a1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">x^2 + </span><span class="si">{</span><span class="n">b1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">x + </span><span class="si">{</span><span class="n">c1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (extreme at x=</span><span class="si">{</span><span class="n">x_ext_ab</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ft, y=</span><span class="si">{</span><span class="n">y_ext_ab_calc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> in)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strand profile (B-C): y = </span><span class="si">{</span><span class="n">a2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">x^2 + </span><span class="si">{</span><span class="n">b2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">x + </span><span class="si">{</span><span class="n">c2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (extreme at x=</span><span class="si">{</span><span class="n">x_ext_bc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ft, y=</span><span class="si">{</span><span class="n">y_ext_bc_calc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> in)&quot;</span><span class="p">)</span>

<span class="c1"># Generate (x, y) points for plotting the tendon profile</span>
<span class="n">x_vals_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">p_a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p_b</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">p_a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p_b</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_vals_ab</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">x_vals_ab</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x_vals_ab</span> <span class="o">+</span> <span class="n">c1</span>

<span class="n">x_vals_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">p_b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p_c</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">p_b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p_c</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_vals_bc</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">x_vals_bc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">x_vals_bc</span> <span class="o">+</span> <span class="n">c2</span>

<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_vals_ab</span><span class="p">,</span> <span class="n">x_vals_bc</span><span class="p">])</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_vals_ab</span><span class="p">,</span> <span class="n">y_vals_bc</span><span class="p">])</span>

<span class="c1"># Plot the tendon profile</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Parabolic Strand Profile&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">p_a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p_b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p_c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">x_ext_ab</span><span class="p">,</span> <span class="n">x_ext_bc</span><span class="p">],</span>
           <span class="p">[</span><span class="n">p_a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p_b</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p_c</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">y_ext_ab_calc</span><span class="p">,</span> <span class="n">y_ext_bc_calc</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">p_a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">p_b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p_a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;c.g.c.&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="c1"># --- Rectangle spanning the two-beam length and section depth ---</span>
<span class="n">total_len</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">length</span>
<span class="n">y_min</span> <span class="o">=</span> <span class="o">-</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yb</span> <span class="o">*</span> <span class="mi">12</span> <span class="c1"># in</span>
<span class="n">y_max</span> <span class="o">=</span>  <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yt</span> <span class="o">*</span> <span class="mi">12</span> <span class="c1"># in</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y_min</span><span class="p">),</span> <span class="n">total_len</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flange_thickness</span><span class="o">*</span><span class="mi">12</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">total_len</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,)</span>
<span class="c1"># ---------------------------------------------------------------</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_min</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Horizontal Distance (ft)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Vertical Drape (in)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Profile of Prestressing Tendon&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Strand profile (A-B): y = 0.0251x^2 + -1.4390x + -0.0000 (extreme at x=28.6 ft, y=-20.6 in)
Strand profile (B-C): y = 0.0248x^2 + -4.3347x + 180.8258 (extreme at x=87.4 ft, y=-8.6 in)
</pre></div>
</div>
<img alt="../../../_images/ade84c26051a02e72ef8bd658a18b5e812d0dd5eaac306cc6f4d581a3278bd90.png" src="../../../_images/ade84c26051a02e72ef8bd658a18b5e812d0dd5eaac306cc6f4d581a3278bd90.png" />
</div>
</div>
</section>
<section id="determine-actual-prestressing-equivalent-loads">
<h2>5.Determine Actual Prestressing Equivalent Loads<a class="headerlink" href="#determine-actual-prestressing-equivalent-loads" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_eq_ab</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="p">(</span><span class="n">ecc_ab</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">l_ab</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># k/ft, upward negative</span>
<span class="n">w_eq_bc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="p">(</span><span class="n">ecc_bc</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">l_bc</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># k/ft, upward negative</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Span&#39;</span><span class="si">:</span><span class="s2">&lt;7</span><span class="si">}{</span><span class="s1">&#39;w_eq (klf)&#39;</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}{</span><span class="s1">&#39;a (in)&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}{</span><span class="s1">&#39;mid-span drape (in)&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">7</span><span class="si">:</span><span class="s2">&lt;7</span><span class="si">}{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">15</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">15</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">15</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;AB&#39;</span><span class="si">:</span><span class="s2">&lt;7</span><span class="si">}{</span><span class="n">w_eq_ab</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">w_eq_ab</span><span class="o">/</span><span class="n">w_conc</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}{</span><span class="s1">&#39;%)&#39;</span><span class="si">:</span><span class="s2">&lt;5</span><span class="si">}{</span><span class="n">ecc_ab</span><span class="si">:</span><span class="s2">&lt;10.3f</span><span class="si">}{</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">depth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cgs_ab</span><span class="si">:</span><span class="s2">&lt;15.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;BC&#39;</span><span class="si">:</span><span class="s2">&lt;7</span><span class="si">}{</span><span class="n">w_eq_bc</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">w_eq_bc</span><span class="o">/</span><span class="n">w_conc</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}{</span><span class="s1">&#39;%)&#39;</span><span class="si">:</span><span class="s2">&lt;5</span><span class="si">}{</span><span class="n">ecc_bc</span><span class="si">:</span><span class="s2">&lt;10.3f</span><span class="si">}{</span><span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">depth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cgs_bc</span><span class="si">:</span><span class="s2">&lt;15.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Span   w_eq (klf)      a (in)    mid-span drape (in)
----------------------------------------------------
AB     -1.122 (69.7%)   24.298    4.000          
BC     -1.127 (70.0%)   12.289    16.009         
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="analyze-beams">
<h1>Analyze Beams<a class="headerlink" href="#analyze-beams" title="Link to this heading">#</a></h1>
<section id="compute-distribution-factors-carry-over-factors-and-fixed-end-moments">
<h2>1.Compute Distribution Factors, Carry-Over Factors, and Fixed-End Moments<a class="headerlink" href="#compute-distribution-factors-carry-over-factors-and-fixed-end-moments" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Build DataFrame with joint + element association</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Joint ID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">j</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">joints</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">j</span><span class="o">.</span><span class="n">_elements</span><span class="p">],</span>
    <span class="s2">&quot;Element ID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">joints</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">j</span><span class="o">.</span><span class="n">_elements</span><span class="p">],</span>
    <span class="s2">&quot;Stiffness&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">j</span><span class="o">.</span><span class="n">stiffness_factors</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">joints</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">j</span><span class="o">.</span><span class="n">_elements</span><span class="p">],</span>
    <span class="s2">&quot;Distribution&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">j</span><span class="o">.</span><span class="n">distribution_factors</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">joints</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">j</span><span class="o">.</span><span class="n">_elements</span><span class="p">],</span>
    <span class="s2">&quot;Carry-Over&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">j</span><span class="o">.</span><span class="n">carry_over_factors</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">joints</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">j</span><span class="o">.</span><span class="n">_elements</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Group by Joint ID</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Joint ID&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">joint_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Joint </span><span class="si">{</span><span class="n">joint_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>


<span class="c1"># grouped_df = grouped.apply(lambda g: g).drop(&quot;Joint ID&quot;, axis=1)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Joint J1
  Joint ID Element ID      Stiffness  Distribution  Carry-Over
0       J1         B1  224239.964792      0.189091    0.524187
1       J1         C2  480820.475546      0.405454    0.477149
2       J1         C1  480820.475546      0.405454    0.477149

Joint J2
  Joint ID Element ID      Stiffness  Distribution  Carry-Over
3       J2         B1  224239.964792      0.148207    0.524187
4       J2         B2  327139.638317      0.216216    0.534073
5       J2         C4  480820.475546      0.317788    0.477149
6       J2         C3  480820.475546      0.317788    0.477149

Joint J3
  Joint ID Element ID      Stiffness  Distribution  Carry-Over
7       J3         B2  327139.638317      0.253837    0.534073
8       J3         C6  480820.475546      0.373082    0.477149
9       J3         C5  480820.475546      0.373082    0.477149
</pre></div>
</div>
</div>
</div>
</section>
<section id="fixed-end-moments">
<h2>2.Fixed-End Moments<a class="headerlink" href="#fixed-end-moments" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute fixed-end moments for each beam under dead, live, and equivalent prestressing loads</span>
<span class="n">loads</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Dead&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">w_dead</span><span class="p">,</span> <span class="n">w_dead</span><span class="p">],</span>
    <span class="s2">&quot;Live&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">w_live</span><span class="p">,</span> <span class="n">w_live</span><span class="p">],</span>
    <span class="s2">&quot;Equivalent&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">w_eq_ab</span><span class="p">,</span> <span class="n">w_eq_bc</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">FEM</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beam</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">beams</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">load_name</span><span class="p">,</span> <span class="n">load_value</span> <span class="ow">in</span> <span class="n">loads</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">M_A</span><span class="p">,</span> <span class="n">M_B</span> <span class="o">=</span> <span class="n">get_fixed_end_moment_uniform_load</span><span class="p">(</span>
            <span class="n">uniform_load</span><span class="o">=</span><span class="n">load_value</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">length</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
            <span class="n">left_rigid_length</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">start_rigid_length</span><span class="p">,</span>
            <span class="n">right_rigid_length</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">end_rigid_length</span>
        <span class="p">)</span>
        <span class="n">FEM</span><span class="p">[(</span><span class="n">beam</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">load_name</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">M_A</span><span class="p">,</span> <span class="n">M_B</span><span class="p">)</span>
        
<span class="n">fem_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="n">FEM</span><span class="p">,</span> 
    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> 
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FEM_left (k-ft)&#39;</span><span class="p">,</span> <span class="s1">&#39;FEM_right (k-ft)&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">fem_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FEM_left (k-ft)</th>
      <th>FEM_right (k-ft)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(B1, Dead)</th>
      <td>543.796438</td>
      <td>-543.796438</td>
    </tr>
    <tr>
      <th>(B1, Live)</th>
      <td>237.960000</td>
      <td>-237.960000</td>
    </tr>
    <tr>
      <th>(B1, Equivalent)</th>
      <td>-370.770994</td>
      <td>370.770994</td>
    </tr>
    <tr>
      <th>(B2, Dead)</th>
      <td>277.245688</td>
      <td>-277.245688</td>
    </tr>
    <tr>
      <th>(B2, Live)</th>
      <td>121.320000</td>
      <td>-121.320000</td>
    </tr>
    <tr>
      <th>(B2, Equivalent)</th>
      <td>-189.825781</td>
      <td>189.825781</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="service-loads-shears-and-moments">
<h2>3.Service Loads Shears and Moments<a class="headerlink" href="#service-loads-shears-and-moments" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define uniform loads for each load case, units in k/ft, downward positive</span>
<span class="n">uniform_loads</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Dead&quot;</span><span class="p">:{</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="n">w_dead</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="n">w_dead</span><span class="p">},</span>
    <span class="s2">&quot;Live&quot;</span><span class="p">:{</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="n">w_live</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="n">w_live</span><span class="p">},</span>
    <span class="s2">&quot;Equivalent&quot;</span><span class="p">:{</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="n">w_eq_ab</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="n">w_eq_bc</span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Beam end moments obtained from moment distribution analysis</span>
<span class="c1"># Units in k-ft, ccw positive, (M_left, M_right)</span>
<span class="n">end_moments</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Dead&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">459.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">556.9</span><span class="p">),</span> <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">372.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">182.0</span><span class="p">)},</span>
    <span class="s2">&quot;Live&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">201.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">243.7</span><span class="p">),</span> <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">163.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">79.7</span><span class="p">)},</span>
    <span class="s2">&quot;Equivalent&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">313.1</span><span class="p">,</span> <span class="mf">380.0</span><span class="p">),</span> <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">255.1</span><span class="p">,</span> <span class="mf">125.0</span><span class="p">)}</span>
<span class="p">}</span>

<span class="n">N_POINTS</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">n_beams</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)</span>
<span class="n">load_cases</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">uniform_loads</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="c1"># Collect per-beam arrays in lists first</span>
<span class="n">X_rows</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_beams</span>
<span class="n">V</span> <span class="o">=</span> <span class="p">{</span><span class="n">lc</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_beams</span> <span class="k">for</span> <span class="n">lc</span> <span class="ow">in</span> <span class="n">load_cases</span><span class="p">}</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">{</span><span class="n">lc</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_beams</span> <span class="k">for</span> <span class="n">lc</span> <span class="ow">in</span> <span class="n">load_cases</span><span class="p">}</span>

<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">beam</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">beams</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">load_cases</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">generate_shear_moment_diagrams</span><span class="p">(</span>
            <span class="n">beam</span><span class="p">,</span>
            <span class="n">uniform_loads</span><span class="p">[</span><span class="n">lc</span><span class="p">][</span><span class="n">beam</span><span class="o">.</span><span class="n">id</span><span class="p">],</span>
            <span class="n">end_moments</span><span class="p">[</span><span class="n">lc</span><span class="p">][</span><span class="n">beam</span><span class="o">.</span><span class="n">id</span><span class="p">],</span>
            <span class="n">n_points</span><span class="o">=</span><span class="n">N_POINTS</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">V</span><span class="p">[</span><span class="n">lc</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="n">M</span><span class="p">[</span><span class="n">lc</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>               <span class="c1"># x is the same across load cases for this beam</span>
            <span class="n">X_rows</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

<span class="c1"># Stack into (n_beams, N_POINTS)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">X_rows</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">lc</span> <span class="ow">in</span> <span class="n">load_cases</span><span class="p">:</span>
    <span class="n">V</span><span class="p">[</span><span class="n">lc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">lc</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">M</span><span class="p">[</span><span class="n">lc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">lc</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_moment_shear_diagrams</span><span class="p">(</span><span class="n">beams</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConcreteRectangleBeam</span><span class="p">,</span> <span class="n">ConcreteTSectionBeam</span><span class="p">]],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]],</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">figsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
    
    <span class="c1"># Find the index of zero shear (inflection point) for each beam</span>
    <span class="n">inf_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
        <span class="n">y_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beam</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">beams</span><span class="p">):</span>
            
            <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift</span><span class="p">,</span> <span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ymax</span><span class="o">=</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">beams</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            
            <span class="c1"># Annotate the start values</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift</span><span class="p">,</span> <span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            
            <span class="c1"># Annotate the end values</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift</span><span class="p">,</span> <span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            
            <span class="c1"># Annotate inflection point (max/min moment)</span>
            <span class="k">if</span> <span class="n">inf_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Moment diagram</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">inf_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">inf_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">shift</span><span class="p">,</span> <span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">inf_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">inf_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">shift</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">y_val</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">inf_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            
            <span class="n">shift</span> <span class="o">+=</span> <span class="n">beam</span><span class="o">.</span><span class="n">length</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Moment diagram</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance along beam (ft)&#39;</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="shear-and-moment-diagrams">
<h2>4. Shear and Moment Diagrams<a class="headerlink" href="#shear-and-moment-diagrams" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">load_case</span> <span class="ow">in</span> <span class="n">uniform_loads</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">plot_moment_shear_diagrams</span><span class="p">(</span>
        <span class="n">beams</span><span class="p">,</span> 
        <span class="n">X</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Shear (kips)&#39;</span><span class="p">:</span> <span class="n">V</span><span class="p">[</span><span class="n">load_case</span><span class="p">],</span> <span class="s1">&#39;Moment (k-ft)&#39;</span><span class="p">:</span> <span class="n">M</span><span class="p">[</span><span class="n">load_case</span><span class="p">]},</span> 
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> 
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Shear and Moment Diagram Under </span><span class="si">{</span><span class="n">load_case</span><span class="si">}</span><span class="s2"> Load&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0a5282a7353e6a03086c9bbe7eee0aecfd75e995ab267dde1790383ee419f503.png" src="../../../_images/0a5282a7353e6a03086c9bbe7eee0aecfd75e995ab267dde1790383ee419f503.png" />
<img alt="../../../_images/67d2243b64cc1e36ae890e892a8ed284ebd1c245c38873b011cb0e72a81941bd.png" src="../../../_images/67d2243b64cc1e36ae890e892a8ed284ebd1c245c38873b011cb0e72a81941bd.png" />
<img alt="../../../_images/507cf0c021135b3f2b89de9a986bd1ddf2e4638fb42f72e57447eed3546bd428.png" src="../../../_images/507cf0c021135b3f2b89de9a986bd1ddf2e4638fb42f72e57447eed3546bd428.png" />
</div>
</div>
</section>
<section id="shear-and-moment-values">
<h2>5. Shear and Moment Values<a class="headerlink" href="#shear-and-moment-values" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenate results for all beams</span>
<span class="n">dist_segments</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">shear</span><span class="p">,</span> <span class="n">moment</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">load_case</span> <span class="ow">in</span> <span class="n">uniform_loads</span><span class="p">:</span>
    <span class="c1"># stack along beam axis first, then flatten</span>
    <span class="n">shear</span><span class="p">[</span><span class="n">load_case</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">load_case</span><span class="p">])</span>
    <span class="n">moment</span><span class="p">[</span><span class="n">load_case</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">load_case</span><span class="p">])</span>

<span class="c1"># build distance array with offsets</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beam</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">beams</span><span class="p">):</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">beam_lengths</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span>
    <span class="n">dist_segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">dist_segments</span><span class="p">)</span>


<span class="c1"># Create a dataframe to store x_coord, shear and moment for each load case</span>
<span class="n">shear_moment_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;X (ft)&quot;</span><span class="p">:</span> <span class="n">dist</span><span class="p">,</span>
    <span class="s2">&quot;V_d (kips)&quot;</span><span class="p">:</span> <span class="n">shear</span><span class="p">[</span><span class="s2">&quot;Dead&quot;</span><span class="p">],</span>
    <span class="s2">&quot;M_d (k.ft)&quot;</span><span class="p">:</span> <span class="n">moment</span><span class="p">[</span><span class="s2">&quot;Dead&quot;</span><span class="p">],</span>
    <span class="s2">&quot;V_l (kips)&quot;</span><span class="p">:</span> <span class="n">shear</span><span class="p">[</span><span class="s2">&quot;Live&quot;</span><span class="p">],</span>
    <span class="s2">&quot;M_l (k.ft)&quot;</span><span class="p">:</span> <span class="n">moment</span><span class="p">[</span><span class="s2">&quot;Live&quot;</span><span class="p">],</span>
    <span class="s2">&quot;V_eql (kips)&quot;</span><span class="p">:</span> <span class="n">shear</span><span class="p">[</span><span class="s2">&quot;Equivalent&quot;</span><span class="p">],</span>
    <span class="s2">&quot;M_eql (k.ft)&quot;</span><span class="p">:</span> <span class="n">moment</span><span class="p">[</span><span class="s2">&quot;Equivalent&quot;</span><span class="p">]</span>
<span class="p">})</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;X (ft)&quot;</span><span class="p">)</span>

<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;V_s (kips)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;V_d (kips)&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;V_l (kips)&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;V_eql (kips)&quot;</span><span class="p">]</span>
<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M_s (k.ft)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M_d (k.ft)&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M_l (k.ft)&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M_eql (k.ft)&quot;</span><span class="p">]</span>

<span class="c1"># Set the dataframe to show all rows</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">shear_moment_df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>V_d (kips)</th>
      <th>M_d (k.ft)</th>
      <th>V_l (kips)</th>
      <th>M_l (k.ft)</th>
      <th>V_eql (kips)</th>
      <th>M_eql (k.ft)</th>
      <th>V_s (kips)</th>
      <th>M_s (k.ft)</th>
    </tr>
    <tr>
      <th>X (ft)</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.000000</th>
      <td>49.4</td>
      <td>-459.2</td>
      <td>21.6</td>
      <td>-201.0</td>
      <td>-33.7</td>
      <td>313.1</td>
      <td>37.4</td>
      <td>-347.1</td>
    </tr>
    <tr>
      <th>1.000000</th>
      <td>47.8</td>
      <td>-410.6</td>
      <td>20.9</td>
      <td>-179.7</td>
      <td>-32.6</td>
      <td>280.0</td>
      <td>36.1</td>
      <td>-310.4</td>
    </tr>
    <tr>
      <th>2.500000</th>
      <td>45.3</td>
      <td>-340.8</td>
      <td>19.8</td>
      <td>-149.2</td>
      <td>-30.9</td>
      <td>232.4</td>
      <td>34.3</td>
      <td>-257.6</td>
    </tr>
    <tr>
      <th>8.200000</th>
      <td>35.9</td>
      <td>-109.2</td>
      <td>15.7</td>
      <td>-47.8</td>
      <td>-24.5</td>
      <td>74.5</td>
      <td>27.2</td>
      <td>-82.5</td>
    </tr>
    <tr>
      <th>13.900000</th>
      <td>26.6</td>
      <td>68.9</td>
      <td>11.6</td>
      <td>30.1</td>
      <td>-18.1</td>
      <td>-46.9</td>
      <td>20.1</td>
      <td>52.1</td>
    </tr>
    <tr>
      <th>19.600000</th>
      <td>17.2</td>
      <td>193.6</td>
      <td>7.5</td>
      <td>84.7</td>
      <td>-11.7</td>
      <td>-131.9</td>
      <td>13.0</td>
      <td>146.4</td>
    </tr>
    <tr>
      <th>25.300000</th>
      <td>7.8</td>
      <td>264.8</td>
      <td>3.4</td>
      <td>115.8</td>
      <td>-5.3</td>
      <td>-180.4</td>
      <td>5.9</td>
      <td>200.2</td>
    </tr>
    <tr>
      <th>30.042281</th>
      <td>0.0</td>
      <td>283.3</td>
      <td>0.0</td>
      <td>123.9</td>
      <td>0.0</td>
      <td>-193.0</td>
      <td>0.0</td>
      <td>214.2</td>
    </tr>
    <tr>
      <th>36.700000</th>
      <td>-11.0</td>
      <td>246.8</td>
      <td>-4.8</td>
      <td>108.0</td>
      <td>7.5</td>
      <td>-168.1</td>
      <td>-8.3</td>
      <td>186.7</td>
    </tr>
    <tr>
      <th>42.400000</th>
      <td>-20.3</td>
      <td>157.7</td>
      <td>-8.9</td>
      <td>69.0</td>
      <td>13.9</td>
      <td>-107.3</td>
      <td>-15.4</td>
      <td>119.3</td>
    </tr>
    <tr>
      <th>48.100000</th>
      <td>-29.7</td>
      <td>15.0</td>
      <td>-13.0</td>
      <td>6.6</td>
      <td>20.3</td>
      <td>-10.0</td>
      <td>-22.4</td>
      <td>11.6</td>
    </tr>
    <tr>
      <th>53.800000</th>
      <td>-39.1</td>
      <td>-181.0</td>
      <td>-17.1</td>
      <td>-79.2</td>
      <td>26.7</td>
      <td>123.7</td>
      <td>-29.5</td>
      <td>-136.6</td>
    </tr>
    <tr>
      <th>59.500000</th>
      <td>-48.5</td>
      <td>-430.6</td>
      <td>-21.2</td>
      <td>-188.4</td>
      <td>33.1</td>
      <td>293.9</td>
      <td>-36.6</td>
      <td>-325.1</td>
    </tr>
    <tr>
      <th>61.000000</th>
      <td>-50.9</td>
      <td>-505.1</td>
      <td>-22.3</td>
      <td>-221.1</td>
      <td>34.7</td>
      <td>344.7</td>
      <td>-38.5</td>
      <td>-381.5</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>-52.6</td>
      <td>-556.9</td>
      <td>-23.0</td>
      <td>-243.7</td>
      <td>35.9</td>
      <td>380.0</td>
      <td>-39.7</td>
      <td>-420.6</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>40.5</td>
      <td>-372.7</td>
      <td>17.7</td>
      <td>-163.1</td>
      <td>-27.7</td>
      <td>255.1</td>
      <td>30.5</td>
      <td>-280.7</td>
    </tr>
    <tr>
      <th>63.000000</th>
      <td>38.9</td>
      <td>-333.0</td>
      <td>17.0</td>
      <td>-145.7</td>
      <td>-26.6</td>
      <td>227.9</td>
      <td>29.3</td>
      <td>-250.8</td>
    </tr>
    <tr>
      <th>64.500000</th>
      <td>36.4</td>
      <td>-276.5</td>
      <td>15.9</td>
      <td>-121.0</td>
      <td>-24.9</td>
      <td>189.3</td>
      <td>27.4</td>
      <td>-208.3</td>
    </tr>
    <tr>
      <th>68.400000</th>
      <td>30.0</td>
      <td>-147.0</td>
      <td>13.1</td>
      <td>-64.3</td>
      <td>-20.5</td>
      <td>100.6</td>
      <td>22.6</td>
      <td>-110.7</td>
    </tr>
    <tr>
      <th>72.300000</th>
      <td>23.6</td>
      <td>-42.5</td>
      <td>10.3</td>
      <td>-18.6</td>
      <td>-16.1</td>
      <td>29.1</td>
      <td>17.8</td>
      <td>-32.0</td>
    </tr>
    <tr>
      <th>76.200000</th>
      <td>17.2</td>
      <td>37.0</td>
      <td>7.5</td>
      <td>16.2</td>
      <td>-11.7</td>
      <td>-25.2</td>
      <td>12.9</td>
      <td>27.9</td>
    </tr>
    <tr>
      <th>80.100000</th>
      <td>10.8</td>
      <td>91.4</td>
      <td>4.7</td>
      <td>40.0</td>
      <td>-7.4</td>
      <td>-62.5</td>
      <td>8.1</td>
      <td>68.9</td>
    </tr>
    <tr>
      <th>84.000000</th>
      <td>4.3</td>
      <td>120.8</td>
      <td>1.9</td>
      <td>52.8</td>
      <td>-3.0</td>
      <td>-82.6</td>
      <td>3.3</td>
      <td>91.1</td>
    </tr>
    <tr>
      <th>86.634105</th>
      <td>0.0</td>
      <td>126.5</td>
      <td>0.0</td>
      <td>55.3</td>
      <td>0.0</td>
      <td>-86.5</td>
      <td>0.0</td>
      <td>95.4</td>
    </tr>
    <tr>
      <th>91.800000</th>
      <td>-8.5</td>
      <td>104.6</td>
      <td>-3.7</td>
      <td>45.7</td>
      <td>5.8</td>
      <td>-71.4</td>
      <td>-6.4</td>
      <td>78.9</td>
    </tr>
    <tr>
      <th>95.700000</th>
      <td>-14.9</td>
      <td>58.9</td>
      <td>-6.5</td>
      <td>25.7</td>
      <td>10.2</td>
      <td>-40.1</td>
      <td>-11.2</td>
      <td>44.6</td>
    </tr>
    <tr>
      <th>99.600000</th>
      <td>-21.3</td>
      <td>-11.8</td>
      <td>-9.3</td>
      <td>-5.2</td>
      <td>14.6</td>
      <td>8.4</td>
      <td>-16.1</td>
      <td>-8.6</td>
    </tr>
    <tr>
      <th>103.500000</th>
      <td>-27.8</td>
      <td>-107.5</td>
      <td>-12.1</td>
      <td>-47.1</td>
      <td>19.0</td>
      <td>74.0</td>
      <td>-20.9</td>
      <td>-80.6</td>
    </tr>
    <tr>
      <th>105.000000</th>
      <td>-30.2</td>
      <td>-151.0</td>
      <td>-13.2</td>
      <td>-66.1</td>
      <td>20.7</td>
      <td>103.7</td>
      <td>-22.7</td>
      <td>-113.3</td>
    </tr>
    <tr>
      <th>106.000000</th>
      <td>-31.9</td>
      <td>-182.0</td>
      <td>-13.9</td>
      <td>-79.7</td>
      <td>21.8</td>
      <td>125.0</td>
      <td>-24.0</td>
      <td>-136.7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="service-stresses">
<h1>Service Stresses<a class="headerlink" href="#service-stresses" title="Link to this heading">#</a></h1>
<p>The stresses at service load shall be less than the following allowable stresses determined by ACI 318:</p>
<ul class="simple">
<li><p>Allowable tensile stress at service (Class U): <span class="math notranslate nohighlight">\(f_t \le 7.5 \sqrt{f'_c}\)</span> [ACI 318-25, table 24.5.2.1]</p></li>
<li><p>Allowable compressive stress at service: <span class="math notranslate nohighlight">\(0.60 f'_c\)</span> [ACI 318-25, table 24.5.4.1]</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Allowable tensile stress at service per ACI 318-25 table 24.5.2.1 (uncracked, class U)</span>
<span class="n">f_ta</span> <span class="o">=</span> <span class="mf">7.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">con_5000</span><span class="o">.</span><span class="n">fc</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span> <span class="c1"># ksi</span>

<span class="c1"># Allowable compressive stress at service per ACI 318-25 table 24.5.4.1</span>
<span class="n">f_ca</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.6</span> <span class="o">*</span> <span class="n">con_5000</span><span class="o">.</span><span class="n">fc</span> <span class="o">/</span> <span class="mi">1000</span> <span class="c1"># ksi</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Allowable tensile stress at service, f_ta = </span><span class="si">{</span><span class="n">f_ta</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ksi&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Allowable compressive stress at service, f_ca = </span><span class="si">{</span><span class="n">f_ca</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ksi</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">service_shear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">service_moment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="k">for</span> <span class="n">load_case</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Dead&quot;</span><span class="p">,</span> <span class="s2">&quot;Live&quot;</span><span class="p">,</span> <span class="s2">&quot;Equivalent&quot;</span><span class="p">]:</span>
    <span class="n">service_shear</span> <span class="o">+=</span> <span class="n">V</span><span class="p">[</span><span class="n">load_case</span><span class="p">]</span>
    <span class="n">service_moment</span> <span class="o">+=</span> <span class="n">M</span><span class="p">[</span><span class="n">load_case</span><span class="p">]</span>

<span class="n">service_stress_top</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">service_stress_bot</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="n">row_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_beams</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">selected_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n_beams</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beam</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">beams</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">: A=</span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">area</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ft2, St=</span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">section_modulus</span><span class="p">()[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ft3, Sb=</span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">section_modulus</span><span class="p">()[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ft3&quot;</span><span class="p">)</span>
    
    <span class="n">selected_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">service_shear</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="n">service_stress_top</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">service_moment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">beam</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">section_modulus</span><span class="p">()[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">F</span> <span class="o">/</span> <span class="n">beam</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># convert ksf to ksi</span>
    <span class="n">service_stress_bot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">service_moment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">beam</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">section_modulus</span><span class="p">()[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">F</span> <span class="o">/</span> <span class="n">beam</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># convert ksf to ksi</span>

<span class="n">M_s</span> <span class="o">=</span> <span class="n">service_moment</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">selected_idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">sigma_st</span> <span class="o">=</span> <span class="n">service_stress_top</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">selected_idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">sigma_sb</span> <span class="o">=</span> <span class="n">service_stress_bot</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">selected_idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Service moment (k-ft):</span><span class="se">\t\t</span><span class="si">{</span><span class="n">M_s</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service stress at top (ksi):</span><span class="se">\t</span><span class="si">{</span><span class="n">sigma_st</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service stress at bottom (ksi):</span><span class="se">\t</span><span class="si">{</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Allowable tensile stress at service, f_ta = 0.530 ksi
Allowable compressive stress at service, f_ca = -3.000 ksi

B1: A=6.528 ft2, St=5.803 ft3, Sb=2.691 ft3
B2: A=6.528 ft2, St=5.803 ft3, Sb=2.691 ft3

Service moment (k-ft):		[-310.4  214.2 -381.5 -250.8   95.4 -113.3]
Service stress at top (ksi):	[ 0.088 -0.54   0.173  0.017 -0.397 -0.148]
Service stress at bottom (ksi):	[-1.084  0.27  -1.268 -0.93  -0.037 -0.576]
</pre></div>
</div>
</div>
</div>
<p>All the tensile and compressive stresses at service (Dead + Live + Equivalent) loads are less that the allowable stresses.</p>
<hr class="docutils" />
</section>
<section id="ultimate-stresses">
<h1>Ultimate Stresses<a class="headerlink" href="#ultimate-stresses" title="Link to this heading">#</a></h1>
<section id="calculate-secondary-moments">
<h2>1. Calculate Secondary Moments<a class="headerlink" href="#calculate-secondary-moments" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eccentricities at supports</span>
<span class="n">ecc_a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ecc_b</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yt</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">12</span> <span class="c1"># ft</span>
<span class="n">ecc_c</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Primary moments at supports</span>
<span class="n">M_pa</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">ecc_a</span> <span class="c1"># k-ft</span>
<span class="n">M_pb</span> <span class="o">=</span> <span class="o">-</span><span class="n">F</span> <span class="o">*</span> <span class="n">ecc_b</span> <span class="c1"># k-ft</span>
<span class="n">M_pc</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">ecc_c</span> <span class="c1"># k-ft</span>

<span class="c1"># Equivalent moments at supports</span>
<span class="n">M_eql_a</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="s2">&quot;Equivalent&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">M_eql_b_left</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="s2">&quot;Equivalent&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">M_eql_b_right</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="s2">&quot;Equivalent&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">M_eql_c</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="s2">&quot;Equivalent&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Secondary moments at supports</span>
<span class="n">M_2a</span> <span class="o">=</span> <span class="n">M_pa</span> <span class="o">+</span> <span class="n">M_eql_a</span>
<span class="n">M_2b_left</span> <span class="o">=</span> <span class="n">M_pb</span> <span class="o">+</span> <span class="n">M_eql_b_left</span>
<span class="n">M_2b_right</span> <span class="o">=</span> <span class="n">M_pb</span> <span class="o">+</span> <span class="n">M_eql_b_right</span>
<span class="n">M_2c</span> <span class="o">=</span> <span class="n">M_pc</span> <span class="o">+</span> <span class="n">M_eql_c</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M_2a=</span><span class="si">{</span><span class="n">M_2a</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M_2b=</span><span class="si">{</span><span class="n">M_2b_left</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft (left)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M_2b=</span><span class="si">{</span><span class="n">M_2b_right</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft (right)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M_2c=</span><span class="si">{</span><span class="n">M_2c</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M_2a=313.1 k-ft
M_2b=215.7 k-ft (left)
M_2b=90.8 k-ft (right)
M_2c=125.0 k-ft
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate shear and moment values</span>
<span class="n">secondary_moments</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">M_2a</span><span class="p">,</span> <span class="n">M_2b_left</span><span class="p">),</span>
    <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">M_2b_right</span><span class="p">,</span> <span class="n">M_2c</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">V2</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_beams</span>
<span class="n">M2</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_beams</span>

<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">beam</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">beams</span><span class="p">):</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">generate_shear_moment_diagrams</span><span class="p">(</span>
        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
        <span class="n">uniform_load</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">support_moments</span><span class="o">=</span><span class="n">secondary_moments</span><span class="p">[</span><span class="n">beam</span><span class="o">.</span><span class="n">id</span><span class="p">],</span>
        <span class="n">n_points</span><span class="o">=</span><span class="n">N_POINTS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">V2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">M2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
    
<span class="c1"># Stack into (n_beams, N_POINTS)</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">V2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># kips, insignificant</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># k-ft, significant</span>

<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;V2 (kips)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">V2</span><span class="p">)</span>
<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M2 (k-ft)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Diagram under secondary loads</span>
<span class="n">plot_moment_shear_diagrams</span><span class="p">(</span>
    <span class="n">beams</span><span class="p">,</span> 
    <span class="n">X</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Shear (kips)&#39;</span><span class="p">:</span> <span class="n">V2</span><span class="p">,</span> <span class="s1">&#39;Moment (k-ft)&#39;</span><span class="p">:</span> <span class="n">M2</span><span class="p">},</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Shear and Moment Diagram Under Secondary Moments&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e390e0afe5ca297fa17aee227b9e97b234e6acefe69bb5ad8c12c071fb21f9b9.png" src="../../../_images/e390e0afe5ca297fa17aee227b9e97b234e6acefe69bb5ad8c12c071fb21f9b9.png" />
</div>
</div>
</section>
<section id="calculate-demand-shear-and-moment">
<h2>2. Calculate Demand Shear and Moment<a class="headerlink" href="#calculate-demand-shear-and-moment" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M2 (k.ft)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V2</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M2 (k.ft)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">M2</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># Calculate ultimate shear and moment</span>
<span class="n">V_u</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="n">V</span><span class="p">[</span><span class="s2">&quot;Dead&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.6</span> <span class="o">*</span> <span class="n">V</span><span class="p">[</span><span class="s2">&quot;Live&quot;</span><span class="p">]</span> <span class="c1"># kips</span>
<span class="n">M_u</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s2">&quot;Dead&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.6</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s2">&quot;Live&quot;</span><span class="p">]</span> <span class="c1"># k-ft</span>

<span class="c1"># Calculate demand shear and moment per ACI 318-25 section 5.3.14</span>
<span class="n">V_dmd</span> <span class="o">=</span> <span class="n">V_u</span> <span class="o">+</span> <span class="n">V2</span> <span class="c1"># kips</span>
<span class="n">M_dmd</span> <span class="o">=</span> <span class="n">M_u</span> <span class="o">+</span> <span class="n">M2</span> <span class="c1"># k-ft</span>

<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;V_u (kips)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_u</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M_u (k-ft)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">M_u</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;V_dmd (kips)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_dmd</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">shear_moment_df</span><span class="p">[</span><span class="s2">&quot;M_dmd (k-ft)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">M_dmd</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">shear_moment_df</span><span class="p">[[</span><span class="s2">&quot;V_u (kips)&quot;</span><span class="p">,</span> <span class="s2">&quot;M_u (k-ft)&quot;</span><span class="p">,</span> <span class="s2">&quot;V_dmd (kips)&quot;</span><span class="p">,</span> <span class="s2">&quot;M_dmd (k-ft)&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>V_u (kips)</th>
      <th>M_u (k-ft)</th>
      <th>V_dmd (kips)</th>
      <th>M_dmd (k-ft)</th>
    </tr>
    <tr>
      <th>X (ft)</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.000000</th>
      <td>93.9</td>
      <td>-872.6</td>
      <td>92.4</td>
      <td>-559.5</td>
    </tr>
    <tr>
      <th>1.000000</th>
      <td>90.8</td>
      <td>-780.3</td>
      <td>89.2</td>
      <td>-468.7</td>
    </tr>
    <tr>
      <th>2.500000</th>
      <td>86.1</td>
      <td>-647.6</td>
      <td>84.5</td>
      <td>-338.4</td>
    </tr>
    <tr>
      <th>8.200000</th>
      <td>68.3</td>
      <td>-207.5</td>
      <td>66.7</td>
      <td>92.7</td>
    </tr>
    <tr>
      <th>13.900000</th>
      <td>50.5</td>
      <td>130.9</td>
      <td>48.9</td>
      <td>422.2</td>
    </tr>
    <tr>
      <th>19.600000</th>
      <td>32.6</td>
      <td>367.8</td>
      <td>31.1</td>
      <td>650.1</td>
    </tr>
    <tr>
      <th>25.300000</th>
      <td>14.8</td>
      <td>503.1</td>
      <td>13.3</td>
      <td>776.5</td>
    </tr>
    <tr>
      <th>30.042281</th>
      <td>0.0</td>
      <td>538.3</td>
      <td>-1.6</td>
      <td>802.7</td>
    </tr>
    <tr>
      <th>36.700000</th>
      <td>-20.8</td>
      <td>469.0</td>
      <td>-22.4</td>
      <td>724.5</td>
    </tr>
    <tr>
      <th>42.400000</th>
      <td>-38.6</td>
      <td>299.6</td>
      <td>-40.2</td>
      <td>546.1</td>
    </tr>
    <tr>
      <th>48.100000</th>
      <td>-56.5</td>
      <td>28.6</td>
      <td>-58.0</td>
      <td>266.1</td>
    </tr>
    <tr>
      <th>53.800000</th>
      <td>-74.3</td>
      <td>-344.0</td>
      <td>-75.8</td>
      <td>-115.4</td>
    </tr>
    <tr>
      <th>59.500000</th>
      <td>-92.1</td>
      <td>-818.2</td>
      <td>-93.7</td>
      <td>-598.5</td>
    </tr>
    <tr>
      <th>61.000000</th>
      <td>-96.8</td>
      <td>-959.9</td>
      <td>-98.4</td>
      <td>-742.5</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>-99.9</td>
      <td>-1058.2</td>
      <td>-101.5</td>
      <td>-842.5</td>
    </tr>
    <tr>
      <th>62.000000</th>
      <td>77.0</td>
      <td>-708.2</td>
      <td>77.8</td>
      <td>-617.4</td>
    </tr>
    <tr>
      <th>63.000000</th>
      <td>73.9</td>
      <td>-632.7</td>
      <td>74.7</td>
      <td>-541.1</td>
    </tr>
    <tr>
      <th>64.500000</th>
      <td>69.2</td>
      <td>-525.4</td>
      <td>70.0</td>
      <td>-432.7</td>
    </tr>
    <tr>
      <th>68.400000</th>
      <td>57.0</td>
      <td>-279.3</td>
      <td>57.8</td>
      <td>-183.5</td>
    </tr>
    <tr>
      <th>72.300000</th>
      <td>44.8</td>
      <td>-80.8</td>
      <td>45.6</td>
      <td>18.1</td>
    </tr>
    <tr>
      <th>76.200000</th>
      <td>32.6</td>
      <td>70.2</td>
      <td>33.4</td>
      <td>172.1</td>
    </tr>
    <tr>
      <th>80.100000</th>
      <td>20.4</td>
      <td>173.7</td>
      <td>21.2</td>
      <td>278.5</td>
    </tr>
    <tr>
      <th>84.000000</th>
      <td>8.2</td>
      <td>229.5</td>
      <td>9.0</td>
      <td>337.5</td>
    </tr>
    <tr>
      <th>86.634105</th>
      <td>0.0</td>
      <td>240.4</td>
      <td>0.8</td>
      <td>351.3</td>
    </tr>
    <tr>
      <th>91.800000</th>
      <td>-16.2</td>
      <td>198.7</td>
      <td>-15.4</td>
      <td>312.6</td>
    </tr>
    <tr>
      <th>95.700000</th>
      <td>-28.3</td>
      <td>111.9</td>
      <td>-27.6</td>
      <td>228.9</td>
    </tr>
    <tr>
      <th>99.600000</th>
      <td>-40.5</td>
      <td>-22.4</td>
      <td>-39.8</td>
      <td>97.6</td>
    </tr>
    <tr>
      <th>103.500000</th>
      <td>-52.7</td>
      <td>-204.3</td>
      <td>-52.0</td>
      <td>-81.3</td>
    </tr>
    <tr>
      <th>105.000000</th>
      <td>-57.4</td>
      <td>-286.9</td>
      <td>-56.6</td>
      <td>-162.7</td>
    </tr>
    <tr>
      <th>106.000000</th>
      <td>-60.5</td>
      <td>-345.9</td>
      <td>-59.8</td>
      <td>-220.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># diagram under demand loads</span>
<span class="n">plot_moment_shear_diagrams</span><span class="p">(</span>
    <span class="n">beams</span><span class="p">,</span> 
    <span class="n">X</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Shear (kips)&#39;</span><span class="p">:</span> <span class="n">V_dmd</span><span class="p">,</span> <span class="s1">&#39;Moment (k-ft)&#39;</span><span class="p">:</span> <span class="n">M_dmd</span><span class="p">},</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Shear and Moment Diagram Under Demand Loads&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/46691663554164c36ddcc9e42cdba22df170f9983a5023eab0baa55f4212fa11.png" src="../../../_images/46691663554164c36ddcc9e42cdba22df170f9983a5023eab0baa55f4212fa11.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beam</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">beams</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M_demand of </span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">length</span><span class="si">}</span><span class="s2">-ft beam:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Left column face:</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="n">M_dmd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">selected_idx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Mid-span:</span><span class="se">\t\t</span><span class="s2"> </span><span class="si">{</span><span class="n">M_dmd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">selected_idx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Right column face:</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="n">M_dmd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">selected_idx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M_demand of 62-ft beam:
	Left column face:	 -468.7 k-ft
	Mid-span:		 802.7 k-ft
	Right column face:	 -742.5 k-ft

M_demand of 44-ft beam:
	Left column face:	 -541.1 k-ft
	Mid-span:		 351.3 k-ft
	Right column face:	 -162.7 k-ft
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="calculate-tendons-stress-at-ultimate">
<h2>3. Calculate Tendons Stress at Ultimate<a class="headerlink" href="#calculate-tendons-stress-at-ultimate" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The tendon stress at ultimate is calculated per ACI 318-25, section 20.3.2.4.1.</p></li>
<li><p>The following calculation is performed for the left side of support B (mid-support).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Right column face of 66-ft beam</span>

<span class="n">Aps</span> <span class="o">=</span> <span class="n">tendon</span><span class="o">.</span><span class="n">Aps</span> <span class="c1"># in^2</span>

<span class="c1"># Effective depth of tendon</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">depth</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">-</span> <span class="mi">4</span> <span class="c1"># in</span>

<span class="c1"># prestressing reinforcement ratio</span>
<span class="n">rho_p</span> <span class="o">=</span> <span class="n">Aps</span> <span class="o">/</span> <span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">dp</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_prestressed_tendon_ultimate_stress</span><span class="p">(</span>
    <span class="n">beam</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ConcreteRectangleBeam</span><span class="p">,</span> <span class="n">ConcreteTSectionBeam</span><span class="p">],</span> 
    <span class="n">tendon</span><span class="p">:</span> <span class="n">PrestressingTendon</span><span class="p">,</span> 
    <span class="n">concrete</span><span class="p">:</span> <span class="n">ACIConcrete</span><span class="p">,</span> 
    <span class="n">rho_p</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute tendon stress at ultimate limit state per ACI 318-25 section 20.3.2.4.1.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        beam: Beam object.</span>
<span class="sd">        tendon: PrestressingTendon object.</span>
<span class="sd">        concrete: ACIConcrete object.</span>
<span class="sd">        rho_p: Prestressing reinforcement ratio.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        f_ps: Prestressing tendon stress at ultimate limit state (ksi).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">beam</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="n">beam</span><span class="o">.</span><span class="n">depth</span> <span class="o">&lt;=</span> <span class="mi">35</span><span class="p">:</span>
        <span class="n">f_ps1</span> <span class="o">=</span> <span class="n">tendon</span><span class="o">.</span><span class="n">fse</span> <span class="o">+</span> <span class="mf">10e3</span> <span class="o">+</span> <span class="n">concrete</span><span class="o">.</span><span class="n">fc</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">rho_p</span><span class="p">)</span>  <span class="c1"># psi</span>
        <span class="n">f_ps2</span> <span class="o">=</span> <span class="n">tendon</span><span class="o">.</span><span class="n">fse</span> <span class="o">+</span> <span class="mf">60e3</span>  <span class="c1"># psi</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f_ps1</span> <span class="o">=</span> <span class="n">tendon</span><span class="o">.</span><span class="n">fse</span> <span class="o">+</span> <span class="mf">10e3</span> <span class="o">+</span> <span class="n">concrete</span><span class="o">.</span><span class="n">fc</span> <span class="o">/</span> <span class="p">(</span><span class="mi">300</span> <span class="o">*</span> <span class="n">rho_p</span><span class="p">)</span>  <span class="c1"># psi</span>
        <span class="n">f_ps2</span> <span class="o">=</span> <span class="n">tendon</span><span class="o">.</span><span class="n">fse</span> <span class="o">+</span> <span class="mf">30e3</span>  <span class="c1"># psi</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">f_ps1</span><span class="p">,</span> <span class="n">f_ps2</span><span class="p">),</span> <span class="n">tendon</span><span class="o">.</span><span class="n">fpy</span><span class="p">)</span> <span class="c1"># psi</span>

<span class="n">fps</span> <span class="o">=</span> <span class="n">get_prestressed_tendon_ultimate_stress</span><span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tendon</span><span class="p">,</span> <span class="n">con_5000</span><span class="p">,</span> <span class="n">rho_p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Beam </span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rho_o: </span><span class="si">{</span><span class="n">rho_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fps: </span><span class="si">{</span><span class="n">fps</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> psi&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Beam B2:
rho_o: 0.0032
fps: 199686.3 psi
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="determine-non-prestressing-reinforcement">
<h2>4. Determine Non-prestressing Reinforcement<a class="headerlink" href="#determine-non-prestressing-reinforcement" title="Link to this heading">#</a></h2>
<p>Minimum non-prestressing reinforcement for beams, <span class="math notranslate nohighlight">\(A_{s,min}\)</span>, is determined per ACI 318-25, section 9.6.2.3</p>
<div class="math notranslate nohighlight">
\[A_{s,min} = 0.004 A_{ct}\]</div>
<p>where &amp;A_{ct}&amp; is defined as the area of part of the cross section between the flexural tension face and centroid of the gross section. In this case since the moment is negative, <span class="math notranslate nohighlight">\(A_{ct}\)</span> includes the beam flange plus a portion of the web.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate A_ct</span>
<span class="n">flange_area</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flange_width</span> <span class="o">*</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flange_thickness</span> <span class="o">*</span> <span class="mi">12</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># in^2</span>
<span class="n">web_partial_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yt</span> <span class="o">-</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flange_thickness</span><span class="p">)</span> <span class="o">*</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">12</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># in^2</span>
<span class="n">A_ct</span> <span class="o">=</span> <span class="n">flange_area</span> <span class="o">+</span> <span class="n">web_partial_area</span> <span class="c1"># in^2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A_ct=</span><span class="si">{</span><span class="n">A_ct</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> in^2&quot;</span><span class="p">)</span>

<span class="c1"># Calculate A_s_min per ACI 318-25 section 9.6.2.3</span>
<span class="n">A_s_min</span> <span class="o">=</span> <span class="mf">0.004</span> <span class="o">*</span> <span class="n">A_ct</span> <span class="c1"># in^2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A_s_min=</span><span class="si">{</span><span class="n">A_s_min</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> in^2&quot;</span><span class="p">)</span>

<span class="c1"># Assume 3#8 tensile reinforcement</span>
<span class="n">D8</span> <span class="o">=</span> <span class="n">LongitudinalRebar</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">mild_steel</span><span class="p">)</span> <span class="c1"># bar #8</span>
<span class="n">As</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">D8</span><span class="o">.</span><span class="n">area</span> <span class="c1"># in^2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Provided tensile reinforcement: 3#8 (As=</span><span class="si">{</span><span class="n">As</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> in^2 &gt; A_s_min)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_ct=571.1 in^2
A_s_min=2.28 in^2
Provided tensile reinforcement: 3#8 (As=2.36 in^2 &gt; A_s_min)
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="compute-nominal-moment-capacity">
<h2>5. Compute Nominal Moment Capacity<a class="headerlink" href="#compute-nominal-moment-capacity" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute forces in concrete and steel at ultimate state</span>

<span class="c1"># Tensile force in non-prestressing steel assuming it yields (eps_ts &gt; eps_y)</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="n">As</span> <span class="o">*</span> <span class="n">D8</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">fy</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="c1"># kips</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ts = </span><span class="si">{</span><span class="n">Ts</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>

<span class="c1"># Tensile force in prestressing steel</span>
<span class="n">Tps</span> <span class="o">=</span> <span class="n">Aps</span> <span class="o">*</span> <span class="n">fps</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="c1"># kips</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tps = </span><span class="si">{</span><span class="n">Tps</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>

<span class="c1"># compute concrete compressive force using equilibrium</span>
<span class="n">Cc</span> <span class="o">=</span> <span class="n">Ts</span> <span class="o">+</span> <span class="n">Tps</span> <span class="c1"># kips</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cc = </span><span class="si">{</span><span class="n">Cc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>

<span class="c1"># Compute depth of the neutral axis from the compression face</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">Cc</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.85</span> <span class="o">*</span> <span class="n">con_5000</span><span class="o">.</span><span class="n">fc</span> <span class="o">*</span> <span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">12</span><span class="p">))</span> <span class="c1"># in</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">con_5000</span><span class="o">.</span><span class="n">beta_1</span> <span class="c1"># in</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a = </span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;c = </span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>


<span class="n">COVER</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="c1"># in, rebar cover</span>
<span class="n">D3</span> <span class="o">=</span> <span class="n">TransverseRebar</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="n">mild_steel</span><span class="p">,</span> <span class="n">nLegsX</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nLegsY</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># stirrup #3</span>

<span class="c1"># Effective depth of the nonprestressing tensile reinforcement</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">depth</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">-</span> <span class="n">COVER</span> <span class="o">-</span> <span class="n">D3</span><span class="o">.</span><span class="n">dia</span> <span class="o">-</span> <span class="n">D8</span><span class="o">.</span><span class="n">dia</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># in</span>

<span class="c1"># Compute nominal moment capacity assumin eps_ts &gt; 0.005</span>
<span class="n">M_n</span> <span class="o">=</span> <span class="n">Ts</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">Tps</span> <span class="o">*</span> <span class="p">(</span><span class="n">dp</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span> <span class="c1"># k-ft</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;phi*M_n = </span><span class="si">{</span><span class="n">phi</span><span class="o">*</span><span class="n">M_n</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;M_demand = </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">M_dmd</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> k-ft &lt; phi*M_n, OK&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ts = 141.4 kips
Tps = 305.5 kips
Cc = 446.9 kips
a = 7.010 in
c = 8.763 in
phi*M_n = 972.3 k-ft
M_demand = 742.5 k-ft &lt; phi*M_n, OK
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="compute-strains">
<h2>6. Compute Strains<a class="headerlink" href="#compute-strains" title="Link to this heading">#</a></h2>
<p>To versity the assumptions regarding the yielding of tensile steel, I need to compute the strains of tensile reinforcement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concrete ultimate strain</span>
<span class="n">eps_cu</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">con_5000</span><span class="o">.</span><span class="n">eps_u</span><span class="p">)</span> <span class="c1"># 0.003</span>

<span class="c1"># Strain of tensile reinforcement at nominal flexural strength</span>
<span class="n">eps_ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="n">eps_cu</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;eps_ts = </span><span class="si">{</span><span class="n">eps_ts</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> &gt; 0.005 &gt; eps_y, OK&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eps_ts = 0.0085 &gt; 0.005 &gt; eps_y, OK
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="check-flexural-strength-at-other-sections-in-progress">
<h2>7. Check Flexural Strength at Other Sections (in progress)<a class="headerlink" href="#check-flexural-strength-at-other-sections-in-progress" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l_ab</span> <span class="o">=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="c1"># ft</span>
<span class="n">l_mask</span> <span class="o">=</span> <span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">l_ab</span>

<span class="c1"># Compute c.g.s. of tendon from c.g.c.</span>
<span class="n">cgs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">cgs</span><span class="p">[</span><span class="n">l_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span><span class="p">],</span> <span class="n">dist</span><span class="p">[</span><span class="n">l_mask</span><span class="p">])</span>
<span class="n">cgs</span><span class="p">[</span><span class="o">~</span><span class="n">l_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">([</span><span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span><span class="p">],</span> <span class="n">dist</span><span class="p">[</span><span class="o">~</span><span class="n">l_mask</span><span class="p">])</span>

<span class="c1"># Compute effective depth of tendon from compression face, dp (inches)</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">M_dmd</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
        <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yt</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">-</span> <span class="n">cgs</span><span class="p">,</span>
        <span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yt</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">-</span> <span class="n">cgs</span>
    <span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
        <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yb</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">cgs</span><span class="p">,</span>
        <span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sec</span><span class="o">.</span><span class="n">yb</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">cgs</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Compute prestressing reinforcement ratio, rho_p</span>
<span class="n">rho_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">M_dmd</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
        <span class="n">Aps</span> <span class="o">/</span> <span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flange_width</span> <span class="o">*</span> <span class="n">dp</span> <span class="o">*</span> <span class="mi">12</span><span class="p">),</span>
        <span class="n">Aps</span> <span class="o">/</span> <span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flange_width</span> <span class="o">*</span> <span class="n">dp</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
    <span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
        <span class="n">Aps</span> <span class="o">/</span> <span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">dp</span> <span class="o">*</span> <span class="mi">12</span><span class="p">),</span>
        <span class="n">Aps</span> <span class="o">/</span> <span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">dp</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Compute ultimate prestressing tendon stress, f_ps</span>
<span class="n">fps</span> <span class="o">=</span> <span class="n">get_prestressed_tendon_ultimate_stress</span><span class="p">(</span><span class="n">beams</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tendon</span><span class="p">,</span> <span class="n">con_5000</span><span class="p">,</span> <span class="n">rho_p</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="c1"># ksi</span>

<span class="c1"># TODO:</span>
<span class="c1"># Compute A_s_min = 0.004 * A_ct</span>
<span class="c1"># Compute Ts, Tps, Cc assmuing eps_ts &gt; eps_y</span>
<span class="c1"># Compute a, c</span>
<span class="c1"># Compute eps_ts to check the above assumption</span>
<span class="c1"># Compute M_n assuming eps_ts &gt; 0.005</span>
<span class="c1"># Compute phi*M_n and compare with M_demand</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flexural_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;X (ft)&quot;</span><span class="p">:</span> <span class="n">dist</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="s2">&quot;M_dmd (k-ft)&quot;</span><span class="p">:</span> <span class="n">M_dmd</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;CGS (in)&quot;</span><span class="p">:</span> <span class="n">cgs</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="s2">&quot;dp (in)&quot;</span><span class="p">:</span> <span class="n">dp</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="s2">&quot;rho_p&quot;</span><span class="p">:</span> <span class="n">rho_p</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
    <span class="s2">&quot;fps (ksi)&quot;</span><span class="p">:</span> <span class="n">fps</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">})</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;X (ft)&quot;</span><span class="p">)</span>

<span class="n">flexural_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>M_dmd (k-ft)</th>
      <th>CGS (in)</th>
      <th>dp (in)</th>
      <th>rho_p</th>
      <th>fps (ksi)</th>
    </tr>
    <tr>
      <th>X (ft)</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.000</th>
      <td>-559.5</td>
      <td>-0.00</td>
      <td>24.60</td>
      <td>0.0041</td>
      <td>196.1</td>
    </tr>
    <tr>
      <th>1.000</th>
      <td>-468.7</td>
      <td>-1.41</td>
      <td>23.18</td>
      <td>0.0044</td>
      <td>195.4</td>
    </tr>
    <tr>
      <th>2.500</th>
      <td>-338.4</td>
      <td>-3.44</td>
      <td>21.16</td>
      <td>0.0048</td>
      <td>194.4</td>
    </tr>
    <tr>
      <th>8.200</th>
      <td>92.7</td>
      <td>-10.11</td>
      <td>21.51</td>
      <td>0.0007</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>13.900</th>
      <td>422.2</td>
      <td>-15.15</td>
      <td>26.55</td>
      <td>0.0006</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>19.600</th>
      <td>650.1</td>
      <td>-18.55</td>
      <td>29.95</td>
      <td>0.0005</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>25.300</th>
      <td>776.5</td>
      <td>-20.32</td>
      <td>31.72</td>
      <td>0.0005</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>30.042</th>
      <td>802.7</td>
      <td>-20.55</td>
      <td>31.95</td>
      <td>0.0005</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>36.700</th>
      <td>724.5</td>
      <td>-18.96</td>
      <td>30.36</td>
      <td>0.0005</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>42.400</th>
      <td>546.1</td>
      <td>-15.83</td>
      <td>27.23</td>
      <td>0.0006</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>48.100</th>
      <td>266.1</td>
      <td>-11.06</td>
      <td>22.47</td>
      <td>0.0007</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>53.800</th>
      <td>-115.4</td>
      <td>-4.66</td>
      <td>19.93</td>
      <td>0.0051</td>
      <td>193.8</td>
    </tr>
    <tr>
      <th>59.500</th>
      <td>-598.5</td>
      <td>3.37</td>
      <td>27.96</td>
      <td>0.0036</td>
      <td>197.7</td>
    </tr>
    <tr>
      <th>61.000</th>
      <td>-742.5</td>
      <td>5.75</td>
      <td>30.35</td>
      <td>0.0034</td>
      <td>198.9</td>
    </tr>
    <tr>
      <th>62.000</th>
      <td>-842.5</td>
      <td>7.40</td>
      <td>32.00</td>
      <td>0.0032</td>
      <td>199.7</td>
    </tr>
    <tr>
      <th>62.000</th>
      <td>-617.4</td>
      <td>7.40</td>
      <td>32.00</td>
      <td>0.0032</td>
      <td>199.7</td>
    </tr>
    <tr>
      <th>63.000</th>
      <td>-541.1</td>
      <td>6.17</td>
      <td>30.77</td>
      <td>0.0033</td>
      <td>199.1</td>
    </tr>
    <tr>
      <th>64.500</th>
      <td>-432.7</td>
      <td>4.41</td>
      <td>29.01</td>
      <td>0.0035</td>
      <td>198.2</td>
    </tr>
    <tr>
      <th>68.400</th>
      <td>-183.5</td>
      <td>0.36</td>
      <td>24.96</td>
      <td>0.0041</td>
      <td>196.2</td>
    </tr>
    <tr>
      <th>72.300</th>
      <td>18.1</td>
      <td>-2.94</td>
      <td>14.34</td>
      <td>0.0011</td>
      <td>228.5</td>
    </tr>
    <tr>
      <th>76.200</th>
      <td>172.1</td>
      <td>-5.48</td>
      <td>16.88</td>
      <td>0.0010</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>80.100</th>
      <td>278.5</td>
      <td>-7.27</td>
      <td>18.67</td>
      <td>0.0009</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>84.000</th>
      <td>337.5</td>
      <td>-8.30</td>
      <td>19.71</td>
      <td>0.0008</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>86.634</th>
      <td>351.3</td>
      <td>-8.57</td>
      <td>19.98</td>
      <td>0.0008</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>91.800</th>
      <td>312.6</td>
      <td>-8.10</td>
      <td>19.51</td>
      <td>0.0008</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>95.700</th>
      <td>228.9</td>
      <td>-6.88</td>
      <td>18.28</td>
      <td>0.0009</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>99.600</th>
      <td>97.6</td>
      <td>-4.89</td>
      <td>16.30</td>
      <td>0.0010</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>103.500</th>
      <td>-81.3</td>
      <td>-2.15</td>
      <td>22.44</td>
      <td>0.0045</td>
      <td>195.0</td>
    </tr>
    <tr>
      <th>105.000</th>
      <td>-162.7</td>
      <td>-0.90</td>
      <td>23.70</td>
      <td>0.0043</td>
      <td>195.6</td>
    </tr>
    <tr>
      <th>106.000</th>
      <td>-220.9</td>
      <td>-0.00</td>
      <td>24.60</td>
      <td>0.0041</td>
      <td>196.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="shear-design">
<h1>Shear Design<a class="headerlink" href="#shear-design" title="Link to this heading">#</a></h1>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./structure\concrete_shear\prestressed_determinate_beam"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Setup Notebook</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#define-beams-columns-and-joints">Define Beams, columns, and Joints</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-materials">1. Define Materials</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2. Define Beams, Columns, and joints</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-beam-section-properties">Compute Beam Section Properties</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#define-loads">Define Loads</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prestressing-tendons">Prestressing Tendons</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-prestressing-force">1. Compute Prestressing Force</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-number-of-strands">2. Compute Number of Strands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-drape-in-shorter-span">3.Compute Drape in Shorter Span</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strand-profile">4.Strand Profile</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-actual-prestressing-equivalent-loads">5.Determine Actual Prestressing Equivalent Loads</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-beams">Analyze Beams</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-distribution-factors-carry-over-factors-and-fixed-end-moments">1.Compute Distribution Factors, Carry-Over Factors, and Fixed-End Moments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-end-moments">2.Fixed-End Moments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#service-loads-shears-and-moments">3.Service Loads Shears and Moments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shear-and-moment-diagrams">4. Shear and Moment Diagrams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shear-and-moment-values">5. Shear and Moment Values</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#service-stresses">Service Stresses</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ultimate-stresses">Ultimate Stresses</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-secondary-moments">1. Calculate Secondary Moments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-demand-shear-and-moment">2. Calculate Demand Shear and Moment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-tendons-stress-at-ultimate">3. Calculate Tendons Stress at Ultimate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-non-prestressing-reinforcement">4. Determine Non-prestressing Reinforcement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-nominal-moment-capacity">5. Compute Nominal Moment Capacity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-strains">6. Compute Strains</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-flexural-strength-at-other-sections-in-progress">7. Check Flexural Strength at Other Sections (in progress)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#shear-design">Shear Design</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hossein Karagah
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025 GNU GENERAL PUBLIC LICENSE.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>