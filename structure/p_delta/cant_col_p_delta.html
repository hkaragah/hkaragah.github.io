
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>P-Delta Analysis: Cantilever Column &#8212; Hossein Karagah, PhD, PE</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'structure/p_delta/cant_col_p_delta';</script>
    <link rel="icon" href="../../_static/headshot.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ASCE 7 vs. 2800 Standard: Comparing Design Spectral Response Acceleration Parameter (Sa)" href="../../earthquake/asce7_2800_spectrum/asce7_2800_spectrum.html" />
    <link rel="prev" title="Welcome" href="../../intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">Hossein Karagah, PhD, PE</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/headshot.png" class="logo__image only-light" alt="Hossein Karagah, PhD, PE - Home"/>
    <script>document.write(`<img src="../../_static/headshot.png" class="logo__image only-dark" alt="Hossein Karagah, PhD, PE - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Structural Engineering</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">P-Delta Analysis: Cantilever Column</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Earthquake Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../earthquake/asce7_2800_spectrum/asce7_2800_spectrum.html">ASCE 7 vs. 2800 Standard: Comparing Design Spectral Response Acceleration Parameter (Sa)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hkaragah/hkaragah.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hkaragah/hkaragah.github.io/issues/new?title=Issue%20on%20page%20%2Fstructure/p_delta/cant_col_p_delta.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/structure/p_delta/cant_col_p_delta.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>P-Delta Analysis: Cantilever Column</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deflected-shape-due-to-lateral-load-and-p-delta-effect">Deflected Shape Due to Lateral Load and P-Delta Effect</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-ode">Solve ODE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deformation-and-moment-diagrams">Deformation and Moment Diagrams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opensees-model">OpenSees Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sap2000-analysis">SAP2000 Analysis</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div style="text-align: right;">
<a target="_blank" href="https://colab.research.google.com/github/hkaragah/hkaragah.github.io/blob/main/structure/cant_col_p_delta.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>
</div><section class="tex2jax_ignore mathjax_ignore" id="p-delta-analysis-cantilever-column">
<h1>P-Delta Analysis: Cantilever Column<a class="headerlink" href="#p-delta-analysis-cantilever-column" title="Link to this heading">#</a></h1>
<p>In a P–Δ analysis of a cantilever column, the additional moments produced by the lateral deflection under the compressive load should be accounted for. This, in turn, further increases the deflection—a phenomenon that must be solved iteratively.</p>
<a class="reference internal image-reference" href="../../_images/cant_col_p_delta_rendered_image.png"><img alt="Define load pattern" src="../../_images/cant_col_p_delta_rendered_image.png" style="width: 200px;" />
</a>
<p>Here, the P-Delta analysis is performed on a steel cantilever column (the AISC 360-22 benchmark problem case 2) by developing and solving the closed-form equation. The equation is then solved using an iterative approach. The result is then compared with the those obtained by using <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> solver as well as structural analysis software.</p>
<p>Below is a step‐by‐step outline of the iterative process of analyzing for P-Delta:
<br></br></p>
<ol class="arabic simple">
<li><p><strong>Initial Analysis (Ignoring <span class="math notranslate nohighlight">\(P\Delta\)</span> Effects)</strong></p></li>
</ol>
<p>Assume Small Deflections:
Start by calculating the lateral deflection, <span class="math notranslate nohighlight">\(\Delta^{(0)}\)</span>, due solely to the applied lateral load, <span class="math notranslate nohighlight">\(H\)</span>. In this initial “linear” step, any secondary effects from the axial load <span class="math notranslate nohighlight">\(P\)</span> is ignored. For a cantilever column, the basic deflection (from bending alone) can be estimated using:</p>
<div class="math notranslate nohighlight">
\[\Delta^{(0)}=\frac{HL^3}{3EI}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(L\)</span> is the height of the column,</p></li>
<li><p><span class="math notranslate nohighlight">\(E\)</span> is the elastic modulus, and</p></li>
<li><p><span class="math notranslate nohighlight">\(I\)</span> is the moment of inertia about the bending axis.
<br></br></p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Determine Secondary Moment</strong></p></li>
</ol>
<p>Once the initial deflection is obtained, the additional moment caused by the axial load acting through the lateral deflection is computed as:</p>
<div class="math notranslate nohighlight">
\[M_{P\Delta}=P\Delta^{(0)}\]</div>
<p>where <span class="math notranslate nohighlight">\(P\)</span> is the axial compressive force acting the free-end of the column. This moment is “secondary” because it arises from the displacement itself and effectively increases the moment acting on the structure.
<br></br></p>
<ol class="arabic simple" start="3">
<li><p><strong>Update Deflected Shape</strong></p></li>
</ol>
<p>The <span class="math notranslate nohighlight">\(M_{P\Delta}\)</span> is incorporated into the equilibrium equations to obtain a new estimate for the deflection. The structure’s stiffness is effectively reduced due to this additional moment. In many formulations, the differential equation governing the deflection of the column is modified to include the effect of <span class="math notranslate nohighlight">\(P\)</span>, leading to a “geometric stiffness” term.
For example, the <em>Euler-Bernoulli beam theory</em> may be used to write the differential equation as:</p>
<div class="math notranslate nohighlight">
\[EI\frac{d^2v(x)}{dx^2}=-M(x)\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(v(x)\)</span> represents the lateral displacement along the column, and</p></li>
<li><p><span class="math notranslate nohighlight">\(M(x)\)</span> represents the internal moment which is a function of <span class="math notranslate nohighlight">\(M_{P\Delta}\)</span>.</p></li>
</ul>
<p><br></br></p>
<ol class="arabic simple" start="4">
<li><p><strong>Interative Process</strong></p></li>
</ol>
<p>Since the free-end deflection <span class="math notranslate nohighlight">\(\Delta\)</span> affects the moment <span class="math notranslate nohighlight">\(P\Delta\)</span> and vice versa, the following steps are performed iteratively:</p>
<ol class="arabic simple">
<li><p>Compute <span class="math notranslate nohighlight">\(\Delta\)</span>: Start with the initial deflection, <span class="math notranslate nohighlight">\(\Delta^{(0)}\)</span>, from the linear analysis.</p></li>
<li><p>Calculate the secondary moment: <span class="math notranslate nohighlight">\(M_{P\Delta}=P\Delta\)</span>.</p></li>
<li><p>Solve the updated deflection equation: Re-compute <span class="math notranslate nohighlight">\(\Delta\)</span> using the modified equilibrium that includes <span class="math notranslate nohighlight">\(M_{P\Delta}\)</span>.</p></li>
<li><p>Check Convergence: Compare the new deflection with the previous iteration. If the difference is below a predefined tolerance, the process converges. Otherwise, update <span class="math notranslate nohighlight">\(\Delta\)</span> and repeat.</p></li>
</ol>
<p>This process ensures that the nonlinear interaction between the axial load and the lateral displacement is properly captured.</p>
<a class="reference internal image-reference" href="../../_images/aisc_stability_analysis-p_delta_diagram.png"><img alt="Define load pattern" src="../../_images/aisc_stability_analysis-p_delta_diagram.png" style="width: 600px;" />
</a>
<hr class="docutils" />
<section id="deflected-shape-due-to-lateral-load-and-p-delta-effect">
<h2>Deflected Shape Due to Lateral Load and P-Delta Effect<a class="headerlink" href="#deflected-shape-due-to-lateral-load-and-p-delta-effect" title="Link to this heading">#</a></h2>
<p>The deflected shape of a cantilever column under axial gravity loads and a lateral notional load is computed through an iterative process. Assume at <span class="math notranslate nohighlight">\(k\)</span>-th iteration, the lateral deformation at free-end of the column is <span class="math notranslate nohighlight">\(\Delta^{(k)}\)</span> and the total moment at the column base is <span class="math notranslate nohighlight">\(M^{(k)}\)</span>. The governing equation is then defined in the form of the following ODE:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
EI\frac{d^2v}{dx^2}=-M^{(k)}(x)\\
\\
M^{(k)}(x)=-H(L-x)-P(\Delta^{(k)}-v)\\
\end{cases}
\end{split}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(M^{(k)}(x)\)</span> is the internal moment after <span class="math notranslate nohighlight">\(k\)</span>-th iterations</p></li>
<li><p><span class="math notranslate nohighlight">\(v\)</span> is the deflected shape which is a function of <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span> is the axial compressive load</p></li>
<li><p><span class="math notranslate nohighlight">\(H\)</span> is the lateral load</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span> is the height of the column</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta^{(k)}\)</span> is the lateral deformation at the column’s free end after <span class="math notranslate nohighlight">\(k\)</span>-th iterations</p></li>
<li><p><span class="math notranslate nohighlight">\(E\)</span> is the elastic modulus of the column’s material</p></li>
<li><p><span class="math notranslate nohighlight">\(I\)</span> is the moment of inertia of the column about the axis of bending</p></li>
</ul>
<p>The ODE is re-written as:</p>
<div class="math notranslate nohighlight">
\[EI\frac{d^2v}{dx^2}=H(L-x)+P(\Delta^{(k)}-v)\]</div>
<div class="math notranslate nohighlight">
\[\frac{d^2v}{dx^2}+\frac{P}{EI}v=\frac{H}{EI}(L-x)+\frac{P}{EI}\Delta^{(k)}\]</div>
<div class="math notranslate nohighlight">
\[\frac{d^2v}{dx^2}+\lambda^2v=f(x)\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda^2 = \frac{P}{EI}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f(x)=\frac{HL+P\Delta^{(k)}}{EI}-\frac{H}{EI}x\)</span></p></li>
</ul>
<p><br></br></p>
<p><strong>Step 1: Solve Homogeneous Equation</strong></p>
<p>The homogeneous part of the equation is:</p>
<div class="math notranslate nohighlight">
\[\frac{d^2v}{dx^2}+\lambda^2v=0\]</div>
<p>The characteristic equation is:</p>
<div class="math notranslate nohighlight">
\[r^2+\lambda^2=0 \rightarrow r=\pm i\lambda\]</div>
<p>Thus, the general solution to the homogeneous equation is:</p>
<div class="math notranslate nohighlight">
\[v_h(x)=C_1\cos(\lambda x)+C_2\sin(\lambda x)\]</div>
<p><br></br></p>
<p><strong>Step 2: Solve Particular Solution</strong></p>
<p>The nonhomogeneous term is:</p>
<div class="math notranslate nohighlight">
\[f(x)=\frac{HL+P\Delta^{(k)}}{EI}-\frac{H}{EI}x\]</div>
<p>Since this is a linear function of <span class="math notranslate nohighlight">\(x\)</span>, we assume a particular solution of the form:</p>
<div class="math notranslate nohighlight">
\[v_p=A+Bx\]</div>
<p>Substituting into the ODE:</p>
<div class="math notranslate nohighlight">
\[EI\cdot0+\lambda^2(A+Bx)=\frac{HL+P\Delta^{(k)}}{EI}-\frac{H}{EI}x\]</div>
<p>Equating coefficients,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
\lambda^2A=\frac{HL+P\Delta^{(k)}}{EI} &amp;\rightarrow A=\frac{HL+P\Delta^{(k)}}{P}\\
\\
\lambda^2Bx=-\frac{H}{EI}x &amp;\rightarrow B=-\frac{H}{P}\\
\end{cases}
\end{split}\]</div>
<p>Thus, the particular solution is:</p>
<div class="math notranslate nohighlight">
\[v_p=\frac{HL+P\Delta^{(k)}}{P}-\frac{H}{P}x\]</div>
<p><br></br></p>
<p><strong>Step 3: General Solution</strong></p>
<p>The general solution is:</p>
<div class="math notranslate nohighlight">
\[v(x)=C_1\cos(\lambda x)+C_2\sin(\lambda x)+\frac{HL+P\Delta^{(k)}}{P}-\frac{H}{P}x\]</div>
<p><br></br></p>
<p><strong>Step 4: Apply Boundary Conditions</strong></p>
<ul class="simple">
<li><p>Condition 1: <span class="math notranslate nohighlight">\(v\bigg|_{x=0}=0\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[C_1\cos(0)+C_2\sin(0)+\frac{HL+P\Delta^{(k)}}{P}-\frac{H}{P}(0)=0\]</div>
<div class="math notranslate nohighlight">
\[C_1+\frac{HL+P\Delta^{(k)}}{P}=0\]</div>
<div class="math notranslate nohighlight">
\[C_1=-\frac{HL+P\Delta^{(k)}}{P}\]</div>
<ul class="simple">
<li><p>Condition 2: <span class="math notranslate nohighlight">\(\frac{dv}{dx}\bigg|_{x=0}=0\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{dv}{dx}=-C_1\lambda\sin(\lambda x)+C_2\lambda\cos(\lambda x)-\frac{H}{P}\]</div>
<div class="math notranslate nohighlight">
\[-C_1\lambda\sin(0)+C_2\lambda\cos(0)-\frac{H}{P}=0\]</div>
<div class="math notranslate nohighlight">
\[C_2\lambda-\frac{H}{P}=0\]</div>
<div class="math notranslate nohighlight">
\[C_2=\frac{H}{P\lambda}\]</div>
<p><br></br></p>
<p><strong>Step 5: Solution</strong></p>
<p>The final solution is obtained by adding the homogeneous and particular parts:</p>
<div class="math notranslate nohighlight">
\[v(x)=-\frac{HL+P\Delta^{(k)}}{P}\cos(\lambda x)+\frac{H}{P\lambda}\sin(\lambda x)+\frac{HL+P\Delta^{(k)}}{P}-\frac{H}{P}x\]</div>
<p>the deflection at the free-end (<span class="math notranslate nohighlight">\(x=L\)</span>) is</p>
<div class="math notranslate nohighlight">
\[v(L)=-\frac{HL+P\Delta^{(k)}}{P}\cos(\lambda L)+\frac{H}{P\lambda}\sin(\lambda L)+\Delta^{(k)}\]</div>
<p>The critical buckling load for the column is</p>
<div class="math notranslate nohighlight">
\[P_{cr}=\frac{\pi^2EI}{(2L)^2}\]</div>
<p>So the ratio of the applied axial load, <span class="math notranslate nohighlight">\(P\)</span>, to the critical buckling load is defined as</p>
<div class="math notranslate nohighlight">
\[\frac{P}{P_{cr}}=\frac{P}{\frac{\pi^2EI}{(2L)^2}}=\frac{4PL^2}{\pi^2EI}=\frac{4}{\pi^2}\lambda^2 L^2\]</div>
<p>Re-arranging the above equation result in</p>
<div class="math notranslate nohighlight">
\[\theta=\lambda L=\frac{\pi}{2}\sqrt{\frac{P}{P_{cr}}}\]</div>
<p>Now, the free-end deflection can be defined in terms of <span class="math notranslate nohighlight">\(\theta\)</span></p>
<div class="math notranslate nohighlight">
\[v(L)=-\frac{HL+P\Delta^{(k)}}{P}\cos(\theta)+\frac{H}{P\lambda}\sin(\theta)+\Delta^{(k)}\]</div>
<p><br></br></p>
<p><strong>Step 6: Additional Boundary Condition</strong></p>
<p>There is an additional boundary condition:</p>
<div class="math notranslate nohighlight">
\[M(x)\bigg|_{x=L}=0\]</div>
<p>At the end of the iterative process this boundary condition may be satified if the columns is stable and the process converges to a solution.
<br></br></p>
<p><strong>Step 7: Convergency</strong></p>
<p>To find the convergency consition, let’s simplify the equation obtained for the deflection by substituting the <span class="math notranslate nohighlight">\(\cos\)</span> and <span class="math notranslate nohighlight">\(\sin\)</span> terms for the first two terms of their tylor expansions:</p>
<div class="math notranslate nohighlight">
\[\cos(\lambda x)=1-\frac{(\lambda x)^2}{2!}+ ...\]</div>
<div class="math notranslate nohighlight">
\[\sin(\lambda x)=\lambda x-\frac{(\lambda x)^3}{3!}+ ...\]</div>
<p>After the substitution, the deflection at <span class="math notranslate nohighlight">\(x=H\)</span> (free-end) after <span class="math notranslate nohighlight">\(k+1\)</span> iterations is approximated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\Delta^{(k+1)}=v(L)&amp;\approx-\left(\frac{HL}{P}+\Delta^{(k)}\right)\left(1-\frac{\lambda^2 L^2}{2}\right)+\frac{L}{P\lambda}\left(\lambda L-\frac{\lambda^3 L^3}{6}\right)+\Delta^{(k)}\\
\\
&amp;\approx-\frac{HL}{P}-\Delta^{(k)}+\frac{HL}{P}\frac{\lambda^2 L^2}{2}+\Delta^{(k)}\frac{\lambda^2 L^2}{2}+\frac{H}{P}L-\frac{H}{P}\frac{\lambda^2 L^3}{6}+\Delta^{(k)}\\
\\
&amp;\approx\frac{HL}{P}\frac{\lambda^2 L^2}{2}+\Delta^{(k)}\frac{\lambda^2 L^2}{2}-\frac{H}{P}\frac{\lambda^2 L^3}{6}\\
\\
&amp;\approx\frac{HL}{P}\frac{(P/EI) L^2}{2}+\Delta^{(k)}\frac{(P/EI) L^2}{2}-\frac{H}{P}\frac{(P/EI) L^3}{6}\\
\\
&amp;\approx\frac{H}{3EI}L^3+\frac{P\Delta^{(k)}}{2EI}L^2\\
\end{align*}
\end{split}\]</div>
<p>Let’s use the above approximation to compute the free-end lateral deformation for the first few iterations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\Delta^{(0)}&amp;=0\\
\\
\Delta^{(1)}&amp;=\frac{H}{3EI}L^3 + 0\\
\\
\Delta^{(2)}&amp;=\frac{H}{3EI}L^3 + \frac{P\Delta^{(1)}}{2EI}L^2 = \Delta^{(1)} + \frac{P\Delta^{(1)}}{2EI}L^2 = \Delta^{(1)}\left(1+\frac{PL^2}{2EI}\right)\\
\\
\Delta^{(3)}&amp;=\frac{H}{3EI}L^3 + \frac{P\Delta^{(2)}}{2EI}L^2 = \Delta^{(1)} + \frac{P\Delta^{(1)}\left(1+\frac{PL^2}{2EI}\right)}{2EI}L^2 = \Delta^{(1)}\left[1+\frac{PL^2}{2EI}+\left(\frac{PL^2}{2EI}\right)^2\right]\\
\\
...\\
\Delta^{(k+1)}&amp;=\frac{H}{3EI}L^3 + \frac{P\Delta^{(k)}}{2EI}L^2 = \Delta^{(1)}\left[1+\frac{PL^2}{2EI}+\left(\frac{PL^2}{2EI}\right)^2 + ... + \left(\frac{PL^2}{2EI}\right)^k\right]=\Delta^{(1)}\sum_{i=0}^{k}\left(\frac{PL^2}{2EI}\right)^k\\
\end{align*}
\end{split}\]</div>
<p>which is a geometric series. If <span class="math notranslate nohighlight">\(|\frac{PL^2}{2EI}|&lt;1\)</span>, the terms of the series approaches zero, and the sequence of partial sums, <span class="math notranslate nohighlight">\(S_n\)</span> converges to <span class="math notranslate nohighlight">\(\frac{\Delta^{(1)}}{1-\frac{PL^2}{2EI}}\)</span>.</p>
<p>Let’s define some utility functions first to compute the deflection, moment, the critical buckling load.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_bvp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">first_order_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">E</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># shape: (1, n)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fh</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">I</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">L</span> <span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
    
    
<span class="k">def</span><span class="w"> </span><span class="nf">second_order_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">Fa</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">D</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">E</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;closed&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">closed_form_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">,</span> <span class="n">Fa</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;ode&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ode_form_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">,</span> <span class="n">Fa</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method must be &#39;closed&#39; or &#39;ode&#39;&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">closed_form_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">Fa</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">delta_k</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">E</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># shape: (1, n)</span>
    <span class="n">lambda_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Fa</span> <span class="o">/</span> <span class="p">(</span><span class="n">E</span> <span class="o">*</span> <span class="n">I</span><span class="p">))</span>
    <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fh</span> <span class="o">*</span> <span class="n">L</span> <span class="o">+</span> <span class="n">Fa</span> <span class="o">*</span> <span class="n">delta_k</span><span class="p">)</span> <span class="o">/</span> <span class="n">Fa</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">Fh</span> <span class="o">/</span> <span class="n">Fa</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lambda_</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span> <span class="o">/</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lambda_</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">-</span> <span class="n">B</span> <span class="o">*</span> <span class="n">x</span> <span class="c1"># shape: (1, n)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>


<span class="k">def</span><span class="w"> </span><span class="nf">ode_form_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">Fa</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">E</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">delta_k</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>   
    <span class="k">def</span><span class="w"> </span><span class="nf">ode</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;System of first-order ODEs. y[0] = v, y[1] = dv/dx&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">Fh</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Fa</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_k</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">/</span> <span class="p">(</span><span class="n">E</span> <span class="o">*</span> <span class="n">I</span><span class="p">)])</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">bc</span><span class="p">(</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Boundary conditions: v(0) = 0, dv/dx(0) = 0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">y_guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>  <span class="c1"># Initial guess</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_bvp</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_guess</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sol</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;BVP solver did not converge.&quot;</span><span class="p">)</span>   
    
    <span class="k">return</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># x values and v(x)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">first_order_moment</span><span class="p">(</span><span class="n">Fh</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># shape: (1, n)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="o">-</span><span class="n">Fh</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">M</span>


<span class="k">def</span><span class="w"> </span><span class="nf">second_order_moment</span><span class="p">(</span><span class="n">Fh</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">Fa</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">delta_k</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">E</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">second_order_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">,</span> <span class="n">Fa</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">delta_k</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="o">-</span><span class="n">Fh</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">Fa</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_k</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># shape: (1, n)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">M</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_2nd_order_def</span><span class="p">(</span><span class="n">Fh</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">Fa</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">E</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">maxIter</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="n">defs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># initial deformation is zero</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">first_order_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
    <span class="n">defs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span> <span class="c1"># Add the first order deflection to the list</span>
    
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxIter</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">second_order_deflection</span><span class="p">(</span><span class="n">Fh</span><span class="p">,</span> <span class="n">Fa</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">defs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
        <span class="n">defs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span> <span class="c1"># Add the deformation at free end to the deformation list</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">defs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">defs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">defs</span><span class="p">)</span>
        
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Failed to converge&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">euler_buckling</span><span class="p">(</span><span class="n">L</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">E</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">I</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">K</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">I</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let’s define the input parameters. For the P-Delta analysis, the AISC 360-22 benchmark problem case 2 (AISC 360-22: Figure C-C2.3) is considered. The structure is a cantilever W14x48 with a concentrated lateral and axial loads at the free-end.</p>
<ul class="simple">
<li><p>Section: W14X48</p></li>
<li><p>Height: 12 ft</p></li>
<li><p>Axial compression: 200 kips</p></li>
<li><p>Lateral force: 1 kip (bending about the strong axis)</p></li>
<li><p>Boundary condition: fixed at the bottom and free at the top</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># AISC 360-22: Figure C-C2.3 (Benchmark Problem Case 2)</span>
<span class="c1"># Cantilever column with P-Delta effects</span>


<span class="n">nSEG</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># number of segments for the column</span>
<span class="n">K</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1"># effective length factor for cantilever column</span>

<span class="c1"># W14X48</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">14.1</span> <span class="c1"># in^2, section area</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">13.8</span> <span class="c1"># in, depth of section</span>
<span class="n">tw</span> <span class="o">=</span> <span class="mf">0.340</span> <span class="c1"># in, web thickness</span>
<span class="n">Aw</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">tw</span> <span class="c1"># in^2, web area</span>
<span class="n">alphaY</span> <span class="o">=</span> <span class="n">Aw</span> <span class="o">/</span> <span class="n">A</span> <span class="c1"># shear shape factor along y-axis</span>
<span class="n">bf</span> <span class="o">=</span> <span class="mf">8.03</span> <span class="c1"># in, flange width</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mf">0.595</span> <span class="c1"># in, flange thickness</span>
<span class="n">Af</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">bf</span> <span class="o">*</span> <span class="n">tf</span> <span class="c1"># in^2, flange area</span>
<span class="n">alphaZ</span> <span class="o">=</span> <span class="n">Af</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.2</span> <span class="o">*</span> <span class="n">A</span><span class="p">)</span> <span class="c1"># shear shape factor along z-axis</span>
<span class="n">Avz</span> <span class="o">=</span> <span class="n">A</span> <span class="c1"># in^2, shear area (assumed equal to section area)</span>
<span class="n">Avy</span> <span class="o">=</span> <span class="n">A</span>
<span class="n">Iz</span> <span class="o">=</span> <span class="mf">484.</span> <span class="c1"># in^4, moment of inertia about strong axis</span>
<span class="n">Iy</span> <span class="o">=</span> <span class="mf">51.4</span> <span class="c1"># in^4, moment of inertia about weak axis</span>
<span class="n">L</span> <span class="o">=</span> <span class="mf">28.</span> <span class="o">*</span> <span class="mi">12</span> <span class="c1"># in, column height</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">29000.</span> <span class="c1"># ksi, steel modulus of elasticity</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># Poisson&#39;s ratio</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">E</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nu</span><span class="p">))</span> <span class="c1"># ksi, shear modulus of elasticity</span>
<span class="n">J</span> <span class="o">=</span> <span class="mf">1.45</span> <span class="c1"># in^4, torsional constant</span>

<span class="c1"># Applied Loads</span>
<span class="n">Pu</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1"># kips, axial compression</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pu (axial load)= </span><span class="si">{</span><span class="n">Pu</span><span class="si">}</span><span class="s1"> kips&#39;</span><span class="p">)</span>

<span class="n">Ni</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># kips, lateral load</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ni (lateral/notional load)= </span><span class="si">{</span><span class="n">Ni</span><span class="si">}</span><span class="s1"> kips&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pu (axial load)= 200 kips
Ni (lateral/notional load)= 1 kips
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>The critical buckling load, first and second-order deformations and moments are as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Critical buckling load</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PuL²/(2EI): </span><span class="si">{</span><span class="n">Pu</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> &lt; 1.0 (P-Delta should converge)&#39;</span><span class="p">)</span>
<span class="n">Pcr</span> <span class="o">=</span> <span class="n">euler_buckling</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pcr (critical load)= </span><span class="si">{</span><span class="n">Pcr</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> kips (P/Pcr = </span><span class="si">{</span><span class="n">Pu</span><span class="o">/</span><span class="n">Pcr</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># First-order deformation</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">first_order_deflection</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nSEG</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">First-order lateral deformation at free end= </span><span class="si">{</span><span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x1</span><span class="p">)]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> in (</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x1</span><span class="p">)]</span><span class="o">/</span><span class="n">L</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">% drift)&#39;</span><span class="p">)</span>

<span class="c1"># Second-order deformation</span>
<span class="n">defs</span> <span class="o">=</span> <span class="n">compute_2nd_order_def</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">Pu</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;closed&quot;</span><span class="p">)</span>
<span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">second_order_deflection</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">Pu</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">defs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">E</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;closed&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nSEG</span><span class="p">)</span>
<span class="n">drift_ratio</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x2</span><span class="p">)]</span> <span class="o">/</span> <span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x1</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Second-order lateral deformation at free end= </span><span class="si">{</span><span class="n">y2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x2</span><span class="p">)]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> in (</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">y2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x2</span><span class="p">)]</span><span class="o">/</span><span class="n">L</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">% drift)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2nd-to-1st order drift ratio= </span><span class="si">{</span><span class="n">drift_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Base Moments</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">M1</span> <span class="o">=</span> <span class="n">first_order_moment</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nSEG</span><span class="p">)</span>
<span class="n">x2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">second_order_moment</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">Pu</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">defs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">E</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;closed&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nSEG</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">First-order moment at free end= </span><span class="si">{</span><span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">x1</span><span class="p">)]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> kip-in&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Second-order moment at free end= </span><span class="si">{</span><span class="n">M2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">x2</span><span class="p">)]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> kip-in&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PuL²/(2EI): 0.8 &lt; 1.0 (P-Delta should converge)
Pcr (critical load)= 306.8 kips (P/Pcr = 0.65)

First-order lateral deformation at free end= 0.9009 in (0.27% drift)
Second-order lateral deformation at free end= 2.5649 in (0.76% drift)
2nd-to-1st order drift ratio= 2.85

First-order moment at free end= -336.0 kip-in
Second-order moment at free end= -849.0 kip-in
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Let’s compute the lateral stiffness of the column with and without the P-Delta effect. The lateral stiffness without P-Delta is</p>
<div class="math notranslate nohighlight">
\[K_{no\ P\Delta}=\frac{N_i}{\Delta^{(1)}}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The lateral stiffness without the P-Delta effect is the same as <span class="math notranslate nohighlight">\(\frac{3EI}{L^3}\)</span>.</p>
</div>
<p>and with P-Delta effect is</p>
<div class="math notranslate nohighlight">
\[K_{P\Delta}=\frac{N_i}{\Delta^{(n)}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k_no_PD</span> <span class="o">=</span> <span class="n">Ni</span><span class="o">/</span><span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x1</span><span class="p">)]</span>
<span class="n">k_PD</span> <span class="o">=</span> <span class="n">Ni</span><span class="o">/</span><span class="n">y2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x2</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lateral Stiffness (no P-Delta): </span><span class="si">{</span><span class="n">k_no_PD</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kip/in&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lateral Stiffness (P-Delta): </span><span class="si">{</span><span class="n">k_PD</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kip/in&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">k_no_PD</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k_PD</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">k_no_PD</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">% reduction in lateral stiffness&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lateral Stiffness (no P-Delta): 1.11 kip/in
Lateral Stiffness (P-Delta): 0.39 kip/in
65% reduction in lateral stiffness
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>The following figure shows how lateral stiffness reduces after each P-Delta iteration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">stiffnesses</span> <span class="o">=</span> <span class="n">Ni</span> <span class="o">/</span> <span class="n">defs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">iterations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stiffnesses</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="p">,</span> <span class="n">stiffnesses</span><span class="p">,</span> <span class="s1">&#39;ko-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lateral Stiffness&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;No P-Delta&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k_no_PD</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">k_no_PD</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">),</span>
             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=.5,head_width=.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Lateral Stiffness (kip/in)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Lateral Stiffness Reduction Due to P-Delta Effects&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/aa423061a56a97d6e8fed0e297c9fe5e22643e62d51c0c9084be6a64bf329fd0.png" src="../../_images/aa423061a56a97d6e8fed0e297c9fe5e22643e62d51c0c9084be6a64bf329fd0.png" />
</div>
</div>
</section>
<section id="solve-ode">
<h2>Solve ODE<a class="headerlink" href="#solve-ode" title="Link to this heading">#</a></h2>
<p>The governing ODE can be solved directly. The <code class="docutils literal notranslate"><span class="pre">solve_bvp</span></code> solver is used below to find the P-Delta deformations directly from the governing ODE. This way the colsed form equation can be verified.</p>
<p>As shown, the resulted deformation after covergence is the same as the closed form method which verifies the colsed form solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">defs_ode</span> <span class="o">=</span> <span class="n">compute_2nd_order_def</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">Pu</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ode&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Second-order deflection at free end (ODE method)= </span><span class="si">{</span><span class="n">defs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> in&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Second-order deflection at free end (ODE method)= 2.5649 in
</pre></div>
</div>
</div>
</div>
</section>
<section id="deformation-and-moment-diagrams">
<h2>Deformation and Moment Diagrams<a class="headerlink" href="#deformation-and-moment-diagrams" title="Link to this heading">#</a></h2>
<p>The following plots show the first and second order deformations (left figure) and moment (right figure). The light grey curves illustrate the iterative lateral deformations and moments after. The iterative deformations satify the boundary conditions because we explicitly enforced them when we formulate the governing ODE. However, the iterative moments do not necessarily satisfy the equilibrium (free-end moment is not zero) until the solution converges.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">x1</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;First Order&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;1st-order&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">y1</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">L</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="o">*</span><span class="n">y1</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mf">1.15</span><span class="o">*</span><span class="n">L</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=.5,head_width=.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">defs</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">defs</span><span class="p">)):</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">second_order_deflection</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">Pu</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">defs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">E</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;closed&quot;</span><span class="p">)</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">defs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x2</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;2nd-order&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">L</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.85</span><span class="o">*</span><span class="n">y2</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mf">1.15</span><span class="o">*</span><span class="n">L</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=.5,head_width=.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$N_i$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">y2</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">L</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$P_u$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.15</span><span class="o">*</span><span class="n">L</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">0.05</span><span class="o">*</span><span class="n">y2</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="o">-</span><span class="mf">0.02</span><span class="o">*</span><span class="n">L</span><span class="p">),</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">y2</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mf">0.02</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Deflection (in)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Column Height (in)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Deflection of Cantilever Column&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1.25</span><span class="o">*</span><span class="n">y2</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">y2</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">L</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">m1</span> <span class="o">=</span> <span class="n">first_order_moment</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x1</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;First Order&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;1st-order&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="o">*</span><span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="o">-</span><span class="mf">0.15</span><span class="o">*</span><span class="n">L</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=.5,head_width=.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">defs</span><span class="p">)):</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">second_order_moment</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">Pu</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">defs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">E</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;closed&quot;</span><span class="p">)</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">defs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x2</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x2</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;2nd-order&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="o">*</span><span class="n">m2</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="o">-</span><span class="mf">0.15</span><span class="o">*</span><span class="n">L</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=.5,head_width=.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.2&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mi">50</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Moment (kip-in)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Bending Moment of Cantilever Column&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/af446a5c7ebd9fa95f0e70ae9002aea40927e6ad1a9e451730660b5dec3d7c5c.png" src="../../_images/af446a5c7ebd9fa95f0e70ae9002aea40927e6ad1a9e451730660b5dec3d7c5c.png" />
</div>
</div>
</section>
<section id="opensees-model">
<h2>OpenSees Model<a class="headerlink" href="#opensees-model" title="Link to this heading">#</a></h2>
<p>The OpenSees model is created using <code class="docutils literal notranslate"><span class="pre">elasticBeamColumn</span></code> type element since no material nonlinearity is assumed (only geometric nonlinearity). The <code class="docutils literal notranslate"><span class="pre">Corotational</span></code>  is used for the transformation, however, <code class="docutils literal notranslate"><span class="pre">PDelta</span></code> transformation would result in alomst the same solution as the drift is less than 10%. Also, the columns is divided into 10 equal segments, and three integration points along with <code class="docutils literal notranslate"><span class="pre">Lobatto</span></code> integration method are provisioned per segment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Corotational</span></code> accounts for axial shortening of the column, while the <code class="docutils literal notranslate"><span class="pre">PDelta</span></code> does not.</p>
</div>
<p>For more information about the OpenSees see the following references:</p>
<ul class="simple">
<li><p><a href="https://openseespydoc.readthedocs.io/en/latest/index.html">OpenSeesPy Documentation</a></p></li>
<li><p><a href="https://portwooddigital.com/2022/11/15/geometric-transformation/">Geometric Transformation, Michael H. Scott</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ops</span><span class="o">.</span><span class="n">printModel</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="n">nodeTags</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ops</span><span class="o">.</span><span class="n">printModel</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="n">nodeTags</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---forceBeamColumn (P-Delta)---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Free end deflection: </span><span class="si">{</span><span class="n">ops</span><span class="o">.</span><span class="n">nodeDisp</span><span class="p">(</span><span class="n">nodeTags</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> in&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Base shear: </span><span class="si">{</span><span class="n">ops</span><span class="o">.</span><span class="n">nodeReaction</span><span class="p">(</span><span class="n">nodeTags</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> kips&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Base moment: </span><span class="si">{</span><span class="n">ops</span><span class="o">.</span><span class="n">nodeReaction</span><span class="p">(</span><span class="n">nodeTags</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> kip-in</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---forceBeamColumn (P-Delta)---
Free end deflection: 2.550 in
Base shear: -1.000 kips
Base moment: 845.835 kip-in
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Node: 0
	Coordinates  : 0 0 
	Disps: 0 0 0 
	 unbalanced Load: 0 0 0 
	 reaction: -1 200 845.835 
	ID : -1 -1 -1 


 Node: 10
	Coordinates  : 0 336 
	Disps: 2.55005 -0.176124 -0.0117226 
	 unbalanced Load: 1 -200 0 
	 reaction: -5.03042e-13 -4.18652e-11 0 
	ID : 27 28 29 
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ticker</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">opsvis</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opsv</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot undeformed model with loading</span>
<span class="n">opsv</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Column Height (in)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">opsv</span><span class="o">.</span><span class="n">plot_load</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Plot deformed model and get scale factor</span>
<span class="n">def_sfac</span> <span class="o">=</span> <span class="n">opsv</span><span class="o">.</span><span class="n">plot_defo</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fmt_undefo</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">fmt_defo</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">xticks</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tick</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">def_sfac</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Deflection (in)&quot;</span><span class="p">)</span>

<span class="c1"># Plot moment diagram</span>
<span class="n">m_sfac</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">opsv</span><span class="o">.</span><span class="n">section_force_diagram_2d</span><span class="p">(</span><span class="n">sf_type</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">sfac</span><span class="o">=</span><span class="n">m_sfac</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">xticks</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tick</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">m_sfac</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Moment (kip-in)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/08b08e4f818b8ad8aa5bd41c9ca8f18a207cae4f1bec0153d3ec885844b4dd9a.png" src="../../_images/08b08e4f818b8ad8aa5bd41c9ca8f18a207cae4f1bec0153d3ec885844b4dd9a.png" />
</div>
</div>
</section>
<section id="sap2000-analysis">
<h2>SAP2000 Analysis<a class="headerlink" href="#sap2000-analysis" title="Link to this heading">#</a></h2>
<ol class="arabic">
<li><p>Define Geometry</p>
<p>The geometry is defined in XZ-plane with the dimensions defined earlier. The base support (node 1) is defined as fixed and the top (node 2) will be free. To be able to obtain an accurate result, the column is meshed into a minimum four segments during the analysis.</p>
<a class="reference internal image-reference" href="../../_images/cant_col_p_delta_01.png"><img alt="Define geometry and mesh size" src="../../_images/cant_col_p_delta_01.png" style="width: 600px;" />
</a>
</li>
<li><p>Define Load Patterns:</p>
<p>The axial load is defined as <code class="docutils literal notranslate"><span class="pre">DL</span></code> and the laterl load is defined as <code class="docutils literal notranslate"><span class="pre">NL</span></code>. Note that the <code class="docutils literal notranslate"><span class="pre">Self</span> <span class="pre">Weight</span> <span class="pre">Multiplier</span></code> for the <code class="docutils literal notranslate"><span class="pre">DL</span></code> is set to zero.</p>
<a class="reference internal image-reference" href="../../_images/cant_col_p_delta_05.png"><img alt="Define load pattern" src="../../_images/cant_col_p_delta_05.png" style="width: 600px;" />
</a>
</li>
<li><p>Define Load Cases:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DL</span></code> load pattern is a static load patter. However, the <code class="docutils literal notranslate"><span class="pre">NL</span></code> load case is defined as a nonlinear load pattern since P-Delta is a nonlinear analysis.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that superimposition cannot be used in a nonlinear analysis, thus all the applicable load patterns must be considered simultaneously in the nonlinear analysis.</p>
</div>
<a class="reference internal image-reference" href="../../_images/cant_col_p_delta_04.png"><img alt="Define load cases" src="../../_images/cant_col_p_delta_04.png" style="width: 600px;" />
</a>
<p>As shown in the figure below, the <code class="docutils literal notranslate"><span class="pre">DL</span></code> and <code class="docutils literal notranslate"><span class="pre">NL</span></code> load patterns are applied together with scale factors of one for the P-Delta analysis.</p>
<a class="reference internal image-reference" href="../../_images/cant_col_p_delta_06.png"><img alt="P-Delta load pattern" src="../../_images/cant_col_p_delta_06.png" style="width: 600px;" />
</a>
</li>
<li><p>Perform Analysis</p>
<p>The following figures show the result of the P-Delta analysis. The values obtained for drift and moments are</p>
<ul class="simple">
<li><p>Second-order free-end deflection = 2.5712 in</p></li>
<li><p>Second-order base moment = 846 kip-in</p></li>
</ul>
<p>Both the free-end deflection and the moment at the base are within 0.5% of the AISC benchmark results.</p>
<a class="reference internal image-reference" href="../../_images/cant_col_p_delta_02.png"><img alt="Drift, Shear, and Moment diagram" src="../../_images/cant_col_p_delta_02.png" style="height: 500px;" />
</a>
</li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./structure\p_delta"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome</p>
      </div>
    </a>
    <a class="right-next"
       href="../../earthquake/asce7_2800_spectrum/asce7_2800_spectrum.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ASCE 7 vs. 2800 Standard: Comparing Design Spectral Response Acceleration Parameter (Sa)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deflected-shape-due-to-lateral-load-and-p-delta-effect">Deflected Shape Due to Lateral Load and P-Delta Effect</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-ode">Solve ODE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deformation-and-moment-diagrams">Deformation and Moment Diagrams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opensees-model">OpenSees Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sap2000-analysis">SAP2000 Analysis</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hossein Karagah
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025 GNU GENERAL PUBLIC LICENSE.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>