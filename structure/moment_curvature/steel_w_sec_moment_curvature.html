
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Moment-Curvature: Steel W-Section &#8212; Hossein Karagah, PhD, PE</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J3171580FP"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J3171580FP');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J3171580FP');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'structure/moment_curvature/steel_w_sec_moment_curvature';</script>
    <link rel="icon" href="../../_static/headshot.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Rectangular Concrete Shear Wall Neutral Axis" href="../shear_wall_neutral_axis/rect_shear_wall_neutral_axis.html" />
    <link rel="prev" title="P-Delta Analysis: Cantilever Column" href="../p_delta/cant_col_p_delta.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">Hossein Karagah, PhD, PE</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/headshot.png" class="logo__image only-light" alt="Hossein Karagah, PhD, PE - Home"/>
    <script>document.write(`<img src="../../_static/headshot.png" class="logo__image only-dark" alt="Hossein Karagah, PhD, PE - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Structural Engineering</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../p_delta/cant_col_p_delta.html">P-Delta Analysis: Cantilever Column</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Moment-Curvature: Steel W-Section</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shear_wall_neutral_axis/rect_shear_wall_neutral_axis.html">Rectangular Concrete Shear Wall Neutral Axis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../opensees/opensees_steel_materials.html">OpenSees Uniaxial Steel Materials</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Earthquake Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../earthquake/asce7_2800_spectrum/asce7_2800_spectrum.html">ASCE 7 vs. 2800 Standard: Comparing Design Spectral Response Acceleration Parameter (Sa)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hkaragah/hkaragah.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hkaragah/hkaragah.github.io/issues/new?title=Issue%20on%20page%20%2Fstructure/moment_curvature/steel_w_sec_moment_curvature.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/structure/moment_curvature/steel_w_sec_moment_curvature.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Moment-Curvature: Steel W-Section</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-steel-material">Define Steel Material</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-section">Define Section</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moment-curvature-calculation">Moment-Curvature Calculation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-of-section-curvature-on-stress-distribution">Effect of Section Curvature on Stress Distribution</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div style="text-align: right;">
<a target="_blank" href="https://colab.research.google.com/github/hkaragah/hkaragah.github.io/blob/main/structure/moment_curvature/steel_w_sec_moment_curvature.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>
</div><section class="tex2jax_ignore mathjax_ignore" id="moment-curvature-steel-w-section">
<h1>Moment-Curvature: Steel W-Section<a class="headerlink" href="#moment-curvature-steel-w-section" title="Link to this heading">#</a></h1>
<p>In this notebook, the objective is to analyze the elasto-plastic behavior of a steel section. More specifically, I want to calculate the bending capacity of a W-section at various curvatures. Let’s begin by importing a few modules into our notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patches</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.axes</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">axes</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;../..&quot;</span><span class="p">))</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.materials</span><span class="w"> </span><span class="kn">import</span> <span class="n">Material</span><span class="p">,</span> <span class="n">BilinearA992Steel</span><span class="p">,</span> <span class="n">BilinearA36Steel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">assets.modules.shapes</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patches</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.axes</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">axes</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pandas&#39;
</pre></div>
</div>
</div>
</div>
<section id="define-steel-material">
<h2>Define Steel Material<a class="headerlink" href="#define-steel-material" title="Link to this heading">#</a></h2>
<p>The steel material used here are elasto-plastic bilinear model with strain hardening. The strain hardening is defined as <span class="math notranslate nohighlight">\(\alpha=0.01\)</span> which helps us to define the post-yield modulus as</p>
<div class="math notranslate nohighlight">
\[E = \alpha E_o = \alpha \times 29000\ ksi\]</div>
<p>The stress-strain curves for ASTM A36 and A992 steels are defined as follows.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_stress_strain_curves</span><span class="p">(</span><span class="n">materials</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">Material</span><span class="p">],</span> <span class="n">figsize</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">materials</span><span class="p">:</span>
        <span class="n">eps_u</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">eps_u</span>
        <span class="n">strain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">eps_u</span><span class="p">,</span> <span class="n">eps_u</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> 
        <span class="n">stress</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">stress</span><span class="p">(</span><span class="n">strain</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">strain</span><span class="p">,</span> <span class="n">stress</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mat</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> [alpha=</span><span class="si">{</span><span class="n">mat</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Strain (ε) [in/in]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Stress (σ) [ksi]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>  
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Stress-Strain Curve&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a992</span> <span class="o">=</span> <span class="n">BilinearA992Steel</span><span class="p">()</span>
<span class="n">a36</span> <span class="o">=</span> <span class="n">BilinearA36Steel</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a992</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a36</span><span class="p">)</span>

<span class="n">plot_stress_strain_curves</span><span class="p">([</span><span class="n">a992</span><span class="p">,</span> <span class="n">a36</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Steel Material: A992, fy: 50000.0 psi, fu: 65000.0 psi, E: 29000000.0 psi, eps_y: 1.72e-03, eps_u: 5.34e-02, alpha: 0.01
Steel Material: A36, fy: 36000.0 psi, fu: 58000.0 psi, E: 29000000.0 psi, eps_y: 1.24e-03, eps_u: 7.71e-02, alpha: 0.01
</pre></div>
</div>
<img alt="../../_images/ce44454f90932569a3449d43fa6002cb8eb50ec72ffc43679f1725b19e736618.png" src="../../_images/ce44454f90932569a3449d43fa6002cb8eb50ec72ffc43679f1725b19e736618.png" />
</div>
</div>
<p>Note that for W-sections, the prefrred material is A992 per AISC 360.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ASTM A992 Steel</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F_y=50\ ksi\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(F_u=65\ ksi\)</span></p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">STRAIN_HARDENING</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">STL</span> <span class="o">=</span> <span class="n">BilinearA992Steel</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">STRAIN_HARDENING</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-section">
<h2>Define Section<a class="headerlink" href="#define-section" title="Link to this heading">#</a></h2>
<p>For the purpose of this example, I will use W14X68 from AISC 360 manual with the following geometric properties is US units.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SEC</span> <span class="o">=</span> <span class="n">AISCShape</span><span class="p">(</span><span class="s1">&#39;W14X68&#39;</span><span class="p">)</span>
<span class="n">sec_df</span> <span class="o">=</span> <span class="n">SEC</span><span class="o">.</span><span class="n">props</span><span class="p">(</span><span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sec_df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;tw&#39;</span><span class="p">,</span> <span class="s1">&#39;bf&#39;</span><span class="p">,</span> <span class="s1">&#39;tf&#39;</span><span class="p">,</span> <span class="s1">&#39;Ix&#39;</span><span class="p">,</span> <span class="s1">&#39;Iy&#39;</span><span class="p">,</span> <span class="s1">&#39;Sx&#39;</span><span class="p">,</span> <span class="s1">&#39;Sy&#39;</span><span class="p">,</span> <span class="s1">&#39;Zx&#39;</span><span class="p">,</span> <span class="s1">&#39;Zy&#39;</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="s1">&#39;ry&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>d</th>
      <th>tw</th>
      <th>bf</th>
      <th>tf</th>
      <th>Ix</th>
      <th>Iy</th>
      <th>Sx</th>
      <th>Sy</th>
      <th>Zx</th>
      <th>Zy</th>
      <th>rx</th>
      <th>ry</th>
    </tr>
    <tr>
      <th>AISC_Manual_Label</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>W14X68</th>
      <td>20.0</td>
      <td>14</td>
      <td>0.415</td>
      <td>10</td>
      <td>0.72</td>
      <td>722.0</td>
      <td>121.0</td>
      <td>103.0</td>
      <td>24.2</td>
      <td>115.0</td>
      <td>36.9</td>
      <td>6.01</td>
      <td>2.46</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="moment-curvature-calculation">
<h2>Moment-Curvature Calculation<a class="headerlink" href="#moment-curvature-calculation" title="Link to this heading">#</a></h2>
<p>To calculate moment curvature, I follow these steps:</p>
<ol class="arabic simple">
<li><p>Assume a value for the curvature.</p></li>
<li><p>Assume the location of the neutral axis where the strain and stress are zero.</p></li>
<li><p>Build the strain diagram assuming Euler-Bernoulli beam theory.</p></li>
<li><p>Calculate the stress diagram using the strain diagram and the material properties (i.e., the stress-strain curve).</p></li>
<li><p>Calculate the internal forces induced by the stress.</p></li>
<li><p>Check whether force equilibrium is satisfied. If not, return to step 2 and try a new location for the neutral axis.</p></li>
<li><p>Calculate the induced internal moment.</p></li>
</ol>
<img alt="Moment-curvature Steps" src="../../_images/moment_curvature_01.png" />
<p>In this example, I assume bending about major principal axis of the W-section. Since W-sections are symmetric about both axis, and the section is under pure bending, the neutral axis passes through the geometric centroid of the section. So there is no need for the trial-error explained above.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Euler-Bernoulli Beam Theory</strong></p>
<ol class="arabic simple">
<li><p>Plane sections remains plane at bending.</p></li>
<li><p>Sections normal to the neutral axis remains normal after bending.</p></li>
</ol>
<p>Other beam theories include <em>Timoshenko beam theory</em>.</p>
</div>
<a class="reference internal image-reference" href="../../_images/moment_curvature_02.jpg"><img alt="Euler-Bernoulli Beam Theory" src="../../_images/moment_curvature_02.jpg" style="width: 800px;" />
</a>
<p>I have prepared <code class="docutils literal notranslate"><span class="pre">get_force</span></code> and <code class="docutils literal notranslate"><span class="pre">get_moment</span></code> functions to facilitate computing the internal force and moment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_force</span><span class="p">(</span><span class="n">curv</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">sec</span><span class="p">:</span><span class="n">AISCShape</span><span class="p">,</span> <span class="n">mat</span><span class="p">:</span><span class="n">Material</span><span class="p">):</span>
    <span class="n">sec_props</span> <span class="o">=</span> <span class="n">sec</span><span class="o">.</span><span class="n">props</span><span class="p">()</span>
    <span class="n">d</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">bf</span> <span class="o">=</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;tw&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;bf&#39;</span><span class="p">]</span>
    
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">delta_y</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="n">curv</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">stress</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">tf</span><span class="p">),</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">bf</span> <span class="o">*</span> <span class="n">delta_y</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">tw</span> <span class="o">*</span> <span class="n">delta_y</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_moment</span><span class="p">(</span><span class="n">curv</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">sec</span><span class="p">:</span><span class="n">AISCShape</span><span class="p">,</span> <span class="n">mat</span><span class="p">:</span><span class="n">Material</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">sec</span><span class="o">.</span><span class="n">props</span><span class="p">()[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
    <span class="n">force</span> <span class="o">=</span> <span class="n">get_force</span><span class="p">(</span><span class="n">curv</span><span class="p">,</span> <span class="n">sec</span><span class="p">,</span> <span class="n">mat</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">force</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, assuming the outer most fiber of the section (the exterior edges of the top and bottom flange) attained the yield strain, let’s compute the curvature and moment. Note that here, I am deviating a little bit from the steps I mentioned earlier. Instead of assuming the curvature and the location of the neutral axis, I assume the maximum value of the normal strain. Here are the results.</p>
<a class="reference internal image-reference" href="../../_images/moment_curvature_03.jpg"><img alt="Moment-Curvature at yield" src="../../_images/moment_curvature_03.jpg" style="width: 800px;" />
</a>
<p>Strain and curvature are</p>
<div class="math notranslate nohighlight">
\[\epsilon_y = \frac{f_y}{E} = \frac{50}{29000} = 1.72 \times 10^{-3}\]</div>
<div class="math notranslate nohighlight">
\[\kappa = \frac{\epsilon_y}{d/2} = \frac{ 1.72 \times 10^{-3}}{14/2} =  2.46 \times 10^{-4}\ 1/in\]</div>
<div class="math notranslate nohighlight">
\[\epsilon_{cs} = \epsilon_{ts} = \frac{d/2 - t_f}{d/2} \cdot \epsilon_y = \frac{14/2 - 0.72}{14/2} \times \epsilon_y = 1.54 \times 10^{-3}\]</div>
<p>Knowing the strain, the normal stress is calculated using stress-strain relationship</p>
<div class="math notranslate nohighlight">
\[f_{cs} = f_{ts} = E \cdot \epsilon_{ts} = 29000 \times (1.54 \times 10^{-3}) = 44.7\ ksi\]</div>
<p>The resultant internal force in the flange and web and their distances from the neutral axis are computed as</p>
<div class="math notranslate nohighlight">
\[C_{sf} = T_{sf} = \frac{F_y + f_{ts}}{2} \cdot b_f \cdot t_f = \frac{50.0 + 44.7}{2} \times 10 \times 0.72 = 340.9\ kips\]</div>
<div class="math notranslate nohighlight">
\[C_{sw} = T_{sw} = \frac{f_{ts}}{2} \cdot \tfrac{1}{2}(d - 2 t_f) \cdot t_w = \frac{44.7}{2} \times \tfrac{1}{2}(14 - 2 \times 0.72) \times 0.415 = 58.2\ kips\]</div>
<div class="math notranslate nohighlight">
\[y_{sf} = (d/2 - t_f) + \frac{f_{ts} \cdot \tfrac{t_f^2}{2} + \tfrac{1}{2}(F_y-f_{ts}) \cdot \tfrac{2t_f^2}{3}}{f_{ts}\cdot t_f + \tfrac{1}{2}(F_y-f_{ts}) \cdot t_f} = (14/2 - 0.72)+\frac{44.7 \times \tfrac{0.72^2}{2} + \tfrac{1}{2}(50.0-44.7) \cdot \tfrac{2 \times 0.72^2}{3}}{44.7 \times 0.72 + \tfrac{1}{2}(50.0-44.7) \times 0.72} = 6.64\ in\]</div>
<div class="math notranslate nohighlight">
\[y_{cw} = \tfrac{2}{3} (d/2 - t_f) = \tfrac{2}{3} (14/2 - 0.72) = 4.19\ in\]</div>
<p>The force equilibrium is already satisfied. Let’s calculate the internal moment</p>
<div class="math notranslate nohighlight">
\[M = 2 \times (T_{sf} \cdot y_{sf} + T_{sw} \cdot y_{cw}) = 2 \times (340.9 \times 6.64 + 58.2 \times 4.19) \times \tfrac{1\ ft}{12\ in} \approx 418\ kip-ft\]</div>
<p>Below, I compued the curvature and moment using the functions developed earlier. The obtained moment from hand calculation is close enough. The difference is attributed to rounding errors in my hand calculations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Strain at the outter most fiber</span>
<span class="n">eps_t</span> <span class="o">=</span> <span class="n">STL</span><span class="o">.</span><span class="n">eps_y</span>

<span class="c1"># Section curvature corresponding to the strain at the outer most fiber</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">SEC</span><span class="o">.</span><span class="n">props</span><span class="p">()[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
<span class="n">curv_y</span> <span class="o">=</span> <span class="n">eps_t</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Curvature at yield (</span><span class="se">\u03BA</span><span class="s2">y): </span><span class="si">{</span><span class="n">curv_y</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> 1/in&quot;</span><span class="p">)</span>

<span class="n">M_y</span> <span class="o">=</span> <span class="n">get_moment</span><span class="p">(</span><span class="n">curv_y</span><span class="p">,</span> <span class="n">SEC</span><span class="p">,</span> <span class="n">STL</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moment at yield: </span><span class="si">{</span><span class="n">M_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> kip-ft&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Curvature at yield (κy): 2.46e-04 1/in
Moment at yield: 424 kip-ft
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">draw_wsec</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">sec</span><span class="p">:</span> <span class="n">AISCShape</span><span class="p">):</span>
    <span class="n">sec_props</span> <span class="o">=</span> <span class="n">sec</span><span class="o">.</span><span class="n">props</span><span class="p">()</span>
    <span class="n">d</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">bf</span> <span class="o">=</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;tw&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;bf&#39;</span><span class="p">]</span>

    <span class="n">bottom_flange</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="n">bf</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span> <span class="n">d</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">bf</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">web</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">tf</span> <span class="o">-</span> <span class="n">d</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">tw</span><span class="p">,</span> <span class="n">d</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tf</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">top_flange</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="n">bf</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span> <span class="o">-</span> <span class="n">tf</span> <span class="o">-</span> <span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">bf</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="p">[</span><span class="n">bottom_flange</span><span class="p">,</span> <span class="n">web</span><span class="p">,</span> <span class="n">top_flange</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">bf</span><span class="p">,</span> <span class="n">bf</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">d</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="c1"># ax.set_aspect(&#39;auto&#39;)</span>
    <span class="k">return</span> <span class="n">ax</span>
    
    
<span class="k">def</span><span class="w"> </span><span class="nf">plot_stress</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">curv</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">sec</span><span class="p">:</span><span class="n">AISCShape</span><span class="p">,</span> <span class="n">mat</span><span class="p">:</span><span class="n">Material</span><span class="p">,</span> <span class="n">figsize</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">sec</span><span class="o">.</span><span class="n">props</span><span class="p">()[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="n">curv</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">stress</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span>
    <span class="n">tension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">compression</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tension</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">compression</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Stress (σ) [ksi]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Distance from neutral axis, y [in]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stress Distribution in </span><span class="si">{</span><span class="n">sec</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="se">\n</span><span class="s2">(</span><span class="se">\u03BA</span><span class="s2"> = </span><span class="si">{</span><span class="n">curv</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> 1/in)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">ax_sec</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">ax_sec</span> <span class="o">=</span> <span class="n">draw_wsec</span><span class="p">(</span><span class="n">ax_sec</span><span class="p">,</span> <span class="n">sec</span><span class="p">)</span>
    <span class="n">ax_sec</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
    
    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ax_sec</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And here is the stress digram. Recall that I assumed the exterior exdges of the top and bottom flange attained yield strain, <span class="math notranslate nohighlight">\(\epsilon_y\)</span>. As a result, the stress at the top and bottom are at <span class="math notranslate nohighlight">\(\sigma_y=50\ ksi\)</span>. Alos note that the neutral axis passes throught the section centroid. Since the stress diagram as well as the section are symmetric, the foce equilibrium is satisfied.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plot_stress</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">curv_y</span><span class="p">,</span> <span class="n">SEC</span><span class="p">,</span> <span class="n">STL</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/68e35964278126468d4ab5edfbb937154bf3aca3c4ad62a30e267751ceaac28a.png" src="../../_images/68e35964278126468d4ab5edfbb937154bf3aca3c4ad62a30e267751ceaac28a.png" />
</div>
</div>
<p>Now that I am able to develpe the stress diagram correctly, I can use that concept to define <code class="docutils literal notranslate"><span class="pre">w_sec_moment_curvature</span></code> function to generate the data points needed to plot the moment-curvature curve. The yield moment capacity, <span class="math notranslate nohighlight">\(M_y\)</span> and plastic moment capacity, <span class="math notranslate nohighlight">\(M_p\)</span> can be obtained as</p>
<div class="math notranslate nohighlight">
\[M_y = S_x F_y = 103 \times (\tfrac{1\ ft}{12\ in}) \times 50 = 429\ kip-ft\]</div>
<div class="math notranslate nohighlight">
\[M_p = Z_x F_y = 115 \times (\tfrac{1\ ft}{12\ in}) \times 50 = 479\ kip-ft\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_x\)</span> and <span class="math notranslate nohighlight">\(Z_x\)</span> are the elastic and plastic section modulus about the strong axis</p></li>
<li><p><span class="math notranslate nohighlight">\(M_y\)</span> is the yield moment capacity assuming the outer most steel fibers are at the onset of yielding</p></li>
<li><p><span class="math notranslate nohighlight">\(M_p\)</span> is the plastic moment capacity assuming the entire section attained the yield stress. Here I used AISC 360-22: Equation F2-1 to calculate the <span class="math notranslate nohighlight">\(M_p\)</span>. The effect of strain hardening is conservatively disregarded, and elastic-perfectly plastic stress-strain model is considered.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">w_sec_moment_curvature</span><span class="p">(</span><span class="n">sec</span><span class="p">:</span><span class="n">AISCShape</span><span class="p">,</span> <span class="n">mat</span><span class="p">:</span><span class="n">Material</span><span class="p">,</span> <span class="n">max_curv</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>   
    <span class="n">sec_props</span> <span class="o">=</span> <span class="n">sec</span><span class="o">.</span><span class="n">props</span><span class="p">()</span> 
    <span class="n">d</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">bf</span> <span class="o">=</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;tw&#39;</span><span class="p">],</span> <span class="n">sec_props</span><span class="p">[</span><span class="s1">&#39;bf&#39;</span><span class="p">]</span>
    
    <span class="n">curv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_curv</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">delta_y</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">curv</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">stress</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
    <span class="n">force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">tf</span><span class="p">),</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">bf</span> <span class="o">*</span> <span class="n">delta_y</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">tw</span> <span class="o">*</span> <span class="n">delta_y</span><span class="p">)</span>
    <span class="n">moment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">force</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># moment about the centroid</span>
  
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;moment&quot;</span><span class="p">:</span> <span class="n">moment</span><span class="p">,</span>
        <span class="s2">&quot;curvature&quot;</span><span class="p">:</span> <span class="n">curv</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> 
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> 
        <span class="s2">&quot;stress&quot;</span><span class="p">:</span> <span class="n">sigma</span><span class="p">,</span> 
        <span class="s2">&quot;force&quot;</span><span class="p">:</span> <span class="n">force</span>
    <span class="p">}</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MAX_CURV</span> <span class="o">=</span> <span class="mf">1.5e-2</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">w_sec_moment_curvature</span><span class="p">(</span><span class="n">SEC</span><span class="p">,</span> <span class="n">STL</span><span class="p">,</span> <span class="n">MAX_CURV</span><span class="p">)</span>

<span class="n">M_max</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span> <span class="c1"># kip-ft, max moment capacity</span>
<span class="n">curv_max</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;curvature&#39;</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> <span class="c1"># 1/in, curvature at max moment capacity</span>

<span class="n">M_y</span> <span class="o">=</span> <span class="n">SEC</span><span class="o">.</span><span class="n">props</span><span class="p">()[</span><span class="s1">&#39;Sx&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">STL</span><span class="o">.</span><span class="n">fy</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span> <span class="c1"># kip-ft, yield moment capacity</span>
<span class="n">M_p</span> <span class="o">=</span> <span class="n">SEC</span><span class="o">.</span><span class="n">props</span><span class="p">()[</span><span class="s1">&#39;Zx&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">STL</span><span class="o">.</span><span class="n">fy</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span> <span class="c1"># kip-ft, plastic moment capacity</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;curvature&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">SEC</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">curv_max</span><span class="p">,</span> <span class="n">M_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Max Moment&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">M_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Yield Moment&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">M_p</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Plastic Moment&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MAX_CURV</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Curvature, </span><span class="se">\u03BA</span><span class="s2"> (1/in)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Moment (kip-ft)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moment-Curvature of </span><span class="si">{</span><span class="n">SEC</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$M_</span><span class="se">{{</span><span class="s2">\mathrm</span><span class="se">{{</span><span class="s2">max</span><span class="se">}}}}</span><span class="s2"> = </span><span class="si">{</span><span class="n">M_max</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">\ \mathrm</span><span class="se">{{</span><span class="s2">kip\!-\!ft</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">curv_max</span><span class="p">,</span> <span class="n">M_max</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="o">*</span><span class="n">curv_max</span><span class="p">,</span> <span class="n">M_max</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$M_</span><span class="se">{{</span><span class="s2">\mathrm</span><span class="se">{{</span><span class="s2">p</span><span class="se">}}}}</span><span class="s2"> = </span><span class="si">{</span><span class="n">M_p</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">\ \mathrm</span><span class="se">{{</span><span class="s2">kip\!-\!ft</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="n">M_p</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="mf">1.01</span><span class="o">*</span><span class="n">M_p</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$M_</span><span class="se">{{</span><span class="s2">\mathrm</span><span class="se">{{</span><span class="s2">y</span><span class="se">}}}}</span><span class="s2"> = </span><span class="si">{</span><span class="n">M_y</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">\ \mathrm</span><span class="se">{{</span><span class="s2">kip\!-\!ft</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="n">M_y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="mf">0.99</span><span class="o">*</span><span class="n">M_y</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=1,head_width=0.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.0&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="o">*</span><span class="n">curv_max</span><span class="p">,</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">M_max</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.95</span><span class="o">*</span><span class="n">curv_max</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">M_max</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Loss of flange strength&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="o">*</span><span class="n">curv_max</span><span class="p">,</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">M_max</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="o">*</span><span class="n">curv_max</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">M_max</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">82</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/8d7ea988b21fb3847fb88ff8859b0258bd04a52727151a030f1b90c7f2497c2e.png" src="../../_images/8d7ea988b21fb3847fb88ff8859b0258bd04a52727151a030f1b90c7f2497c2e.png" />
</div>
</div>
<p>The moment capacity drops significantly after reaching its max due to loosing the contribution of the flanges. The maximum moment capacit is higher than the plastic moment capacity because of the strain hardening. If repeat the calculation using A992 steel without strain hardening (<span class="math notranslate nohighlight">\(\alpha=0.0\)</span>), this would be the outcome.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">STL_0</span> <span class="o">=</span> <span class="n">BilinearA992Steel</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">data_0</span> <span class="o">=</span> <span class="n">w_sec_moment_curvature</span><span class="p">(</span><span class="n">SEC</span><span class="p">,</span> <span class="n">STL_0</span><span class="p">,</span> <span class="n">MAX_CURV</span><span class="p">)</span>
<span class="n">M_max0</span><span class="o">=</span> <span class="n">data_0</span><span class="p">[</span><span class="s1">&#39;moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span> <span class="c1"># kip-ft, max moment capacity</span>
<span class="n">curv_max0</span> <span class="o">=</span> <span class="n">data_0</span><span class="p">[</span><span class="s1">&#39;curvature&#39;</span><span class="p">][</span><span class="n">data_0</span><span class="p">[</span><span class="s1">&#39;moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> <span class="c1"># 1/in, curvature at max moment capacity</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">},</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_0</span><span class="p">[</span><span class="s2">&quot;curvature&quot;</span><span class="p">],</span> <span class="n">data_0</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">SEC</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">curv_max0</span><span class="p">,</span> <span class="n">M_max0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Max Moment&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">M_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Yield Moment&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">M_p</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Plastic Moment&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MAX_CURV</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Curvature, </span><span class="se">\u03BA</span><span class="s2"> (1/in)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Moment (kip-ft)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moment-Curvature of </span><span class="si">{</span><span class="n">SEC</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$M_</span><span class="se">{{</span><span class="s2">\mathrm</span><span class="se">{{</span><span class="s2">max</span><span class="se">}}}}</span><span class="s2"> = </span><span class="si">{</span><span class="n">M_max0</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">\ \mathrm</span><span class="se">{{</span><span class="s2">kip\!-\!ft</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">M_max0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.99</span><span class="o">*</span><span class="n">M_max0</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$M_</span><span class="se">{{</span><span class="s2">\mathrm</span><span class="se">{{</span><span class="s2">p</span><span class="se">}}}}</span><span class="s2"> = </span><span class="si">{</span><span class="n">M_p</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">\ \mathrm</span><span class="se">{{</span><span class="s2">kip\!-\!ft</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="n">M_p</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="mf">0.99</span><span class="o">*</span><span class="n">M_p</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$M_</span><span class="se">{{</span><span class="s2">\mathrm</span><span class="se">{{</span><span class="s2">y</span><span class="se">}}}}</span><span class="s2"> = </span><span class="si">{</span><span class="n">M_y</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">\ \mathrm</span><span class="se">{{</span><span class="s2">kip\!-\!ft</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="n">M_y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="mf">0.99</span><span class="o">*</span><span class="n">M_y</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy,head_length=1,head_width=0.5,tail_width=.2&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$</span><span class="se">{{</span><span class="s2">\mathrm</span><span class="se">{{</span><span class="s2">\kappa</span><span class="se">}}}}</span><span class="s2">=</span><span class="si">{</span><span class="n">curv_max0</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.99</span><span class="o">*</span><span class="n">curv_max0</span><span class="p">,</span> <span class="mf">0.99</span><span class="o">*</span><span class="n">M_max0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="o">*</span><span class="n">curv_max0</span><span class="p">,</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">M_max0</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">arrowprops</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_stress</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">curv_max0</span><span class="p">,</span> <span class="n">SEC</span><span class="p">,</span> <span class="n">STL_0</span><span class="p">)</span>
<span class="n">rounded_box</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">FancyBboxPatch</span><span class="p">(</span>
    <span class="p">(</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># (x, y), width, height</span>
    <span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.1&quot;</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rounded_box</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f4a4110dd46e2f79f7cac5b58eda9630c19a83b92289948b088b873c181d3df8.png" src="../../_images/f4a4110dd46e2f79f7cac5b58eda9630c19a83b92289948b088b873c181d3df8.png" />
</div>
</div>
<p>So close! The maximum calculated moment in the digram is slightly lower than the plastic moment capacity. This is because in our moment-curvature calculation, the strain at the neutral axis is alway zero and so the stress. Consequently, the stress at the neutral axis never attains <span class="math notranslate nohighlight">\(F_y\)</span> in our calculation, but in <span class="math notranslate nohighlight">\(M_p\)</span> calculation does. That is why <span class="math notranslate nohighlight">\(M_{max}\)</span> is slihgtly lower than the <span class="math notranslate nohighlight">\(M_p\)</span>.</p>
</section>
<section id="effect-of-section-curvature-on-stress-distribution">
<h2>Effect of Section Curvature on Stress Distribution<a class="headerlink" href="#effect-of-section-curvature-on-stress-distribution" title="Link to this heading">#</a></h2>
<p>In order to better understand the curvature-stress relationship, let’s first plot the stress distribution across the section at various curvatures (<span class="math notranslate nohighlight">\(\kappa\)</span>). I will create the stress plots for 32 different curvature values between <span class="math notranslate nohighlight">\(\kappa = 0\)</span> and <span class="math notranslate nohighlight">\(\kappa = \)</span> <code class="docutils literal notranslate"><span class="pre">MAX_CURV</span></code> using the original steel material with strain hardening.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">select_curvatures</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">nPoints</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">ratio</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
    <span class="c1"># Find the index in arr closest to the threshold</span>
    <span class="n">idx_closest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">))</span>
    
    <span class="c1"># Compute the number of points before and after the threshold</span>
    <span class="n">pre_nPoints</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nPoints</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
    <span class="n">post_nPoints</span> <span class="o">=</span> <span class="n">nPoints</span> <span class="o">-</span> <span class="n">pre_nPoints</span>

    <span class="c1"># Indices before and after, at given interval</span>
    <span class="n">pre_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx_closest</span><span class="p">,</span> <span class="n">pre_nPoints</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">post_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">idx_closest</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">post_nPoints</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Join the two arrays of indices</span>
    <span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">pre_indices</span><span class="p">,</span> <span class="n">post_indices</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">selected_indices</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_section_stress</span><span class="p">(</span><span class="n">nPoints</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">curv</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">yield_curv</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ratio</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">figsize</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)):</span>
    
    <span class="c1"># Get the indices of the selected curvatures</span>
    <span class="n">selected_indices</span> <span class="o">=</span> <span class="n">select_curvatures</span><span class="p">(</span><span class="n">curv</span><span class="p">,</span> <span class="n">yield_curv</span><span class="p">,</span> <span class="n">nPoints</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span>
    
    <span class="c1"># Calculate number of rows in the plot</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">nPoints</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">selected_indices</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sigma</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\u03BA</span><span class="s2"> = </span><span class="si">{</span><span class="n">curv</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> 1/in&quot;</span><span class="p">)</span>
        <span class="n">tension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">sigma</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">compression</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">sigma</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tension</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">compression</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\u03BA</span><span class="s2"> = </span><span class="si">{</span><span class="n">curv</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> 1/in&quot;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;σ [ksi]&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">ax_sec</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">ax_sec</span> <span class="o">=</span> <span class="n">draw_wsec</span><span class="p">(</span><span class="n">ax_sec</span><span class="p">,</span> <span class="n">SEC</span><span class="p">)</span>
        <span class="n">ax_sec</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="n">ax_sec</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y [in]&quot;</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nPoints</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stress Distribution in </span><span class="si">{</span><span class="n">SEC</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_section_stress</span><span class="p">(</span><span class="n">nPoints</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">curv</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;curvature&quot;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;stress&quot;</span><span class="p">],</span> <span class="n">yield_curv</span><span class="o">=</span><span class="n">curv_y</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3cf1d2e9f0b64319add7de9d8c012d34b3d083ed8500735dcabdef5142e48a43.png" src="../../_images/3cf1d2e9f0b64319add7de9d8c012d34b3d083ed8500735dcabdef5142e48a43.png" />
</div>
</div>
<p>In the above plots, the vertical axis shows the height of section in inch, where zero is the neutral axis of the section. The horizontal axis shows the magnitude of the normal stress in section in ksi.</p>
<p>The curvature value of <span class="math notranslate nohighlight">\(\kappa=2.40 \times 10^{-4}\ \tfrac{1}{in}\)</span> corresponds to onset of yielding in the top and bottom flanges. At <span class="math notranslate nohighlight">\(\kappa=7.33 \times 10^{-3}\ \tfrac{1}{in}\)</span>, alomst the entire section is yielded. Note that due to strain hardening, the normal stress at the tip of the flanges are greater than <span class="math notranslate nohighlight">\(\sigma_y=50 ksi\)</span>. From this point forward, apllying more moment causes the normal stress at the outter most fibers of the top and bottom flanges to drop to zero. This is because the normal strains at these fibers exceeds the ultimate strain, <span class="math notranslate nohighlight">\(\epsilon_u\)</span> of the material. For instance at <span class="math notranslate nohighlight">\(\kappa=7.93 \times 10^{-3}\ \tfrac{1}{in}\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\kappa = \frac{\epsilon}{y_{_{N.A.}}} \rightarrow \epsilon = \kappa \cdot y_{_{N.A.}}\]</div>
<div class="math notranslate nohighlight">
\[\epsilon = 7.93 \times 10^{-3} \times 7.0 = 5.55 \times 10^{-2} &gt; \epsilon_u = 5.34 \times 10^{-2}\]</div>
<p>Moving forward, at <span class="math notranslate nohighlight">\(\kappa=8.51 \times 10^{-3}\ \tfrac{1}{in}\)</span>, the normal stress in the entire top and bottom flanges drops to zero which causes a huge reduction in the moment capacity of the section as illustrated in the moment-curvature diagram.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_combined_moment_curvature_with_stress</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span> <span class="n">sec</span><span class="p">:</span><span class="n">AISCShape</span><span class="p">,</span> <span class="n">curvs</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">insets</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">inset_size</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>

    <span class="n">curvature</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;curvature&quot;</span><span class="p">]</span>
    <span class="n">moment</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">12</span>  <span class="c1"># Convert lbs-in to kip-ft</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;stress&quot;</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curvature</span><span class="p">,</span> <span class="n">moment</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">sec</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Curvature, </span><span class="se">\u03BA</span><span class="s2"> (1/in)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Moment (kip-ft)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moment-Curvature of </span><span class="si">{</span><span class="n">sec</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Axis limits for normalization</span>
    <span class="n">xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">curv</span><span class="p">,</span> <span class="n">inset</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">curvs</span><span class="p">,</span> <span class="n">insets</span><span class="p">):</span>
        <span class="c1"># Find the closest curvature index</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">curvature</span> <span class="o">-</span> <span class="n">curv</span><span class="p">))</span>
        <span class="n">x_curv</span> <span class="o">=</span> <span class="n">curvature</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">y_moment</span> <span class="o">=</span> <span class="n">moment</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_curv</span><span class="p">,</span> <span class="n">y_moment</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        
        <span class="c1"># Annotate the data points with point numbers</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_curv</span><span class="p">,</span> <span class="n">y_moment</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1"># Normalize coordinates to [0, 1] in axes fraction</span>
        <span class="n">x_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_curv</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_moment</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Inset size in axis fraction</span>
        <span class="n">inset_w</span><span class="p">,</span> <span class="n">inset_h</span> <span class="o">=</span> <span class="n">inset_size</span>

        <span class="c1"># Adjust placement to avoid overlapping</span>
        <span class="n">inset_x</span> <span class="o">=</span> <span class="n">x_norm</span> <span class="o">+</span> <span class="n">inset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">inset_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="c1">#- inset_w / 2</span>
        <span class="n">inset_y</span> <span class="o">=</span> <span class="n">y_norm</span> <span class="o">+</span> <span class="n">inset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">inset_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="c1">#0.03  # a little above the point</span>

        <span class="c1"># Avoid going out of bounds</span>
        <span class="n">inset_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">inset_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">inset_w</span><span class="p">)</span>
        <span class="n">inset_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">inset_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">inset_h</span><span class="p">)</span>

        <span class="c1"># Create inset axis</span>
        <span class="n">inset_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="n">inset_x</span><span class="p">,</span> <span class="n">inset_y</span><span class="p">,</span> <span class="n">inset_w</span><span class="p">,</span> <span class="n">inset_h</span><span class="p">])</span>
        <span class="n">inset_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sigma</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">inset_ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">inset_ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">inset_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="c1"># inset_ax.set_facecolor(&quot;white&quot;)</span>
        <span class="n">inset_ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">inset_ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>To better appreciate the relationship among the curvature, stress, and moment, I have created another plot illustrating the stress distribution at key points along the moment-curvature diagram. A few take-aways from this figure are:</p>
<ul class="simple">
<li><p>The onset of yielding in the section corresponds to the transition from linear to nonlinear (point 1 to 2) in the moment-curvature diagram.</p></li>
<li><p>Moving along the curve, from point 2 to 3 and 4, progression of plastification deep into the web causes the increase in the moment capacity.</p></li>
<li><p>Point 4 corresponds to the maximum moment capacity. At this point almost the entire corss section attains the yield stress, and the strain at the tip of the flanges reaches the ultimate strain (<span class="math notranslate nohighlight">\(\epsilon_u\)</span>).</p></li>
<li><p>Moment capacity drops significantly as the curvature increase further from point 4 to 5. This is attributed to loss of flange contribution.</p></li>
<li><p>After point 5, the minimal moment capacity is due to the web contribution only. This is the softening region which corresponds to large curvatures.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">)</span>  <span class="c1"># Inset size relative to main axes</span>
<span class="n">CURVS</span> <span class="o">=</span> <span class="p">[</span><span class="n">curv_y</span><span class="p">,</span> <span class="mf">0.5e-3</span><span class="p">,</span> <span class="mf">4.0e-3</span><span class="p">,</span> <span class="mf">7.6e-3</span><span class="p">,</span> <span class="mf">8.53e-3</span><span class="p">,</span> <span class="n">MAX_CURV</span><span class="p">]</span>
<span class="n">INSETS</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.25</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)]</span>
<span class="n">plot_combined_moment_curvature_with_stress</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">SEC</span><span class="p">,</span> <span class="n">CURVS</span><span class="p">,</span> <span class="n">INSETS</span><span class="p">,</span> <span class="n">inset_size</span><span class="o">=</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b5daea33a889e545cdb025286bce87d3b299b447c9c7b3407475021fcb917d00.png" src="../../_images/b5daea33a889e545cdb025286bce87d3b299b447c9c7b3407475021fcb917d00.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./structure\moment_curvature"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../p_delta/cant_col_p_delta.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">P-Delta Analysis: Cantilever Column</p>
      </div>
    </a>
    <a class="right-next"
       href="../shear_wall_neutral_axis/rect_shear_wall_neutral_axis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Rectangular Concrete Shear Wall Neutral Axis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-steel-material">Define Steel Material</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-section">Define Section</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moment-curvature-calculation">Moment-Curvature Calculation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-of-section-curvature-on-stress-distribution">Effect of Section Curvature on Stress Distribution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hossein Karagah
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025 GNU GENERAL PUBLIC LICENSE.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>